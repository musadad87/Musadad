<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MUSADAD.COM</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen">
    <!-- Header -->
    <header class="bg-white shadow-lg border-b-4 border-blue-600">
        <div class="container mx-auto px-6 py-4">
            <h1 class="text-3xl font-bold text-blue-800 text-center">MUSADAD.COM</h1>
        </div>
    </header>

    <!-- Main Content -->
    <div class="container mx-auto px-6 py-8">
        <div class="grid lg:grid-cols-2 gap-8 mb-8">
            <!-- Kolom Kiri (INPUT) -->
            <div class="bg-white rounded-xl shadow-lg p-6 border-l-4 border-green-500">
                <h2 class="text-xl font-semibold text-gray-800 mb-6 flex items-center">
                    <span class="bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm mr-3">INPUT</span>
                    Data Masukan
                </h2>
                <div class="space-y-4">
                    <button class="w-full bg-green-600 hover:bg-green-700 text-white font-medium py-4 px-6 rounded-lg transition-colors duration-200 shadow-md hover:shadow-lg">
                        üìÑ HARGA KERTAS
                    </button>
                    <button onclick="openHargaProdukForm()" class="w-full bg-green-600 hover:bg-green-700 text-white font-medium py-4 px-6 rounded-lg transition-colors duration-200 shadow-md hover:shadow-lg">
                        üí∞ HARGA PRODUK
                    </button>
                    <button onclick="openItungUangForm()" class="w-full bg-green-600 hover:bg-green-700 text-white font-medium py-4 px-6 rounded-lg transition-colors duration-200 shadow-md hover:shadow-lg">
                        üßÆ ITUNG UANG
                    </button>
                    <button onclick="openBeliForm()" class="w-full bg-green-600 hover:bg-green-700 text-white font-medium py-4 px-6 rounded-lg transition-colors duration-200 shadow-md hover:shadow-lg">
                        üõí BELI
                    </button>
                </div>
            </div>

            <!-- Kolom Kanan (TRANSAKSI) -->
            <div class="bg-white rounded-xl shadow-lg p-6 border-l-4 border-blue-500">
                <h2 class="text-xl font-semibold text-gray-800 mb-6 flex items-center">
                    <span class="bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm mr-3">TRANSAKSI</span>
                    Proses Transaksi
                </h2>
                <div class="space-y-4">
                    <button onclick="openBelangkoForm()" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-4 px-6 rounded-lg transition-colors duration-200 shadow-md hover:shadow-lg">
                        üíå HITUNG UNDANGAN BELANGKO
                    </button>
                    <button class="w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-4 px-6 rounded-lg transition-colors duration-200 shadow-md hover:shadow-lg">
                        üìä HITUNG KERTAS
                    </button>
                    <button class="w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-4 px-6 rounded-lg transition-colors duration-200 shadow-md hover:shadow-lg">
                        üíé HITUNG RIZA
                    </button>
                    <button class="w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-4 px-6 rounded-lg transition-colors duration-200 shadow-md hover:shadow-lg">
                        üìã FOCOPY
                    </button>
                    <button class="w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-4 px-6 rounded-lg transition-colors duration-200 shadow-md hover:shadow-lg">
                        üè¢ NPWP
                    </button>
                </div>
            </div>
        </div>

        <!-- Kolom Bawah (MOBILE) -->
        <div class="bg-white rounded-xl shadow-lg p-6 border-l-4 border-purple-500">
            <h2 class="text-xl font-semibold text-gray-800 mb-6 flex items-center">
                <span class="bg-purple-100 text-purple-800 px-3 py-1 rounded-full text-sm mr-3">MOBILE</span>
                Fitur Mobile
            </h2>
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                <button class="bg-purple-600 hover:bg-purple-700 text-white font-medium py-4 px-6 rounded-lg transition-colors duration-200 shadow-md hover:shadow-lg">
                    üì¶ PESANAN
                </button>
                <button class="bg-purple-600 hover:bg-purple-700 text-white font-medium py-4 px-6 rounded-lg transition-colors duration-200 shadow-md hover:shadow-lg">
                    üí≥ UTANG
                </button>
                <button onclick="openNotaForm()" class="bg-purple-600 hover:bg-purple-700 text-white font-medium py-4 px-6 rounded-lg transition-colors duration-200 shadow-md hover:shadow-lg">
                    üßæ NOTA
                </button>
                <button class="bg-purple-600 hover:bg-purple-700 text-white font-medium py-4 px-6 rounded-lg transition-colors duration-200 shadow-md hover:shadow-lg">
                    üìä DATA NOTA
                </button>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-gray-800 text-white py-6 mt-12">
        <div class="container mx-auto px-6 text-center">
            <p class="text-gray-300">¬© 2024 MUSADAD.COM - Sistem Manajemen Bisnis</p>
        </div>
    </footer>

    <!-- Form Harga Kertas Modal -->
    <div id="hargaKertasModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto">
            <div class="bg-green-600 text-white p-4 rounded-t-xl">
                <h3 class="text-xl font-semibold flex items-center justify-between">
                    üìÑ Form Harga Kertas
                    <button onclick="closeHargaKertasForm()" class="text-white hover:text-gray-200 text-2xl">&times;</button>
                </h3>
            </div>
            
            <div class="p-6">
                <!-- Form Fields -->
                <form id="hargaKertasForm" class="space-y-4">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">No (Primary Key)</label>
                            <input type="number" id="no" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" placeholder="Auto Generate" readonly>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Harga Kertas</label>
                            <input type="number" id="harga_kertas" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" placeholder="Masukkan harga">
                        </div>
                        
                        <!-- No Results Message -->
                        <div id="noUangResultsMessage" class="hidden text-center py-8 text-gray-500">
                            <div class="text-4xl mb-2">üìÖ</div>
                            <p class="text-sm">Tidak ada data yang cocok dengan tanggal pencarian</p>
                            <p class="text-xs mt-1">Coba tanggal lain atau <button onclick="clearUangSearch()" class="text-blue-500 hover:text-blue-700 underline">hapus pencarian</button></p>
                        </div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Nama Kertas</label>
                        <input type="text" id="nama_kertas" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" placeholder="Masukkan nama kertas">
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ukuran Lebar (cm)</label>
                            <input type="number" id="ukuran_lebar" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" placeholder="Lebar dalam cm">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ukuran Panjang (cm)</label>
                            <input type="number" id="ukuran_panjang" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" placeholder="Panjang dalam cm">
                        </div>
                        
                        <!-- No Results Message -->
                        <div id="noUangResultsMessage" class="hidden text-center py-8 text-gray-500">
                            <div class="text-4xl mb-2">üìÖ</div>
                            <p class="text-sm">Tidak ada data yang cocok dengan tanggal pencarian</p>
                            <p class="text-xs mt-1">Coba tanggal lain atau <button onclick="clearUangSearch()" class="text-blue-500 hover:text-blue-700 underline">hapus pencarian</button></p>
                        </div>
                    </div>
                </form>
                
                <!-- Record Navigation Buttons -->
                <div class="mt-6 border-t pt-4">
                    <h4 class="text-sm font-medium text-gray-700 mb-3">Record Navigation Buttons:</h4>
                    <div class="flex flex-wrap gap-2 mb-4">
                        <button onclick="firstRecord()" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg text-sm transition-colors">
                            ‚èÆÔ∏è First Record
                        </button>
                        <button onclick="previousRecord()" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg text-sm transition-colors">
                            ‚è™ Previous Record
                        </button>
                        <button onclick="nextRecord()" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg text-sm transition-colors">
                            ‚è© Next Record
                        </button>
                        <button onclick="lastRecord()" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg text-sm transition-colors">
                            ‚è≠Ô∏è Last Record
                        </button>
                    </div>
                </div>
                
                <!-- Data Control Buttons -->
                <div class="border-t pt-4">
                    <h4 class="text-sm font-medium text-gray-700 mb-3">Data Control Buttons:</h4>
                    <div class="flex flex-wrap gap-2">
                        <button onclick="undoRecord()" class="bg-yellow-500 hover:bg-yellow-600 text-white px-4 py-2 rounded-lg text-sm transition-colors">
                            ‚Ü∂ Undo Record
                        </button>
                        <button onclick="saveRecord()" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg text-sm transition-colors">
                            üíæ Save New Record
                        </button>
                        <button onclick="refreshData()" class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg text-sm transition-colors">
                            üîÑ Refresh Data
                        </button>
                        <button onclick="newRecord()" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg text-sm transition-colors">
                            ‚ûï New Data
                        </button>
                        <button onclick="deleteCurrentRecord()" class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg text-sm transition-colors">
                            üóëÔ∏è Hapus
                        </button>
                    </div>
                </div>
                
                <!-- Current Record Info -->
                <div class="mt-4 p-3 bg-gray-100 rounded-lg">
                    <p class="text-sm text-gray-600">Record: <span id="currentRecord">1</span> of <span id="totalRecords">5</span></p>
                </div>
                
                <!-- Database Table -->
                <div class="mt-6 border-t pt-4">
                    <h4 class="text-lg font-medium text-gray-800 mb-4">üìä Database Harga Kertas</h4>
                    <div class="overflow-x-auto">
                        <table class="w-full border-collapse border border-gray-300 text-sm">
                            <thead>
                                <tr class="bg-green-100">
                                    <th class="border border-gray-300 px-3 py-2 text-left font-semibold">No</th>
                                    <th class="border border-gray-300 px-3 py-2 text-left font-semibold">Harga Kertas</th>
                                    <th class="border border-gray-300 px-3 py-2 text-left font-semibold">Nama Kertas</th>
                                    <th class="border border-gray-300 px-3 py-2 text-left font-semibold">Lebar (cm)</th>
                                    <th class="border border-gray-300 px-3 py-2 text-left font-semibold">Panjang (cm)</th>
                                    <th class="border border-gray-300 px-3 py-2 text-center font-semibold">Aksi</th>
                                </tr>
                            </thead>
                            <tbody id="kertasTableBody">
                                <!-- Data akan diisi oleh JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Form Harga Produk Modal -->
    <div id="hargaProdukModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-xl shadow-2xl w-full max-w-6xl max-h-[90vh] overflow-y-auto">
            <div class="bg-green-600 text-white p-4 rounded-t-xl">
                <h3 class="text-xl font-semibold flex items-center justify-between">
                    üí∞ Form Harga Produk
                    <button onclick="closeHargaProdukForm()" class="text-white hover:text-gray-200 text-2xl">&times;</button>
                </h3>
            </div>
            
            <div class="p-6">
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <!-- Kolom Kiri - Input Data -->
                    <div class="lg:col-span-1">
                        <h4 class="text-lg font-semibold text-gray-800 mb-4 border-b pb-2">üìù Input Data</h4>
                        <form id="hargaProdukForm" class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">NO</label>
                                <input type="number" id="produk_no" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" placeholder="Auto Generate" readonly>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">NAMA BAHAN</label>
                                <input type="text" id="nama_bahan" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" placeholder="Masukkan nama bahan">
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">HARGA</label>
                                <input type="number" id="harga_bahan" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" placeholder="Masukkan harga">
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">NAMA PEMESAN</label>
                                <input type="text" id="nama_pemesan" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" placeholder="Masukkan nama pemesan">
                            </div>
                        </form>
                        
                        <!-- Current Record Info -->
                        <div class="mt-4 p-3 bg-gray-100 rounded-lg">
                            <p class="text-sm text-gray-600">Record: <span id="currentProdukRecord">1</span> of <span id="totalProdukRecords">5</span></p>
                        </div>
                        
                        <!-- No Results Message -->
                        <div id="noUangResultsMessage" class="hidden text-center py-8 text-gray-500">
                            <div class="text-4xl mb-2">üìÖ</div>
                            <p class="text-sm">Tidak ada data yang cocok dengan tanggal pencarian</p>
                            <p class="text-xs mt-1">Coba tanggal lain atau <button onclick="clearUangSearch()" class="text-blue-500 hover:text-blue-700 underline">hapus pencarian</button></p>
                        </div>
                    </div>
                    
                    <!-- Kolom Tengah - Tabel Data -->
                    <div class="lg:col-span-1">
                        <h4 class="text-lg font-semibold text-gray-800 mb-4 border-b pb-2">üìä Data Produk</h4>
                        
                        <!-- Search Box -->
                        <div class="mb-4">
                            <div class="relative">
                                <input type="text" id="searchProduk" placeholder="üîç Cari nama bahan..." class="w-full px-4 py-2 pl-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 text-sm">
                                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                    <span class="text-gray-400">üîç</span>
                                </div>
                                <button onclick="clearSearch()" class="absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600" title="Clear search">
                                    <span class="text-lg">√ó</span>
                                </button>
                            </div>
                            <div class="mt-2 text-xs text-gray-500">
                                <span id="searchResults">Menampilkan <span id="visibleCount">5</span> dari <span id="totalCount">5</span> data</span>
                            </div>
                        </div>
                        
                        <div class="overflow-x-auto max-h-96">
                            <table class="w-full border-collapse border border-gray-300 text-sm">
                                <thead class="sticky top-0 bg-white">
                                    <tr class="bg-green-100">
                                        <th class="border border-gray-300 px-3 py-2 text-left font-semibold">NO</th>
                                        <th class="border border-gray-300 px-3 py-2 text-left font-semibold">NAMA BAHAN</th>
                                        <th class="border border-gray-300 px-3 py-2 text-left font-semibold">HARGA</th>
                                        <th class="border border-gray-300 px-3 py-2 text-center font-semibold">Aksi</th>
                                    </tr>
                                </thead>
                                <tbody id="produkTableBody">
                                    <!-- Data akan diisi oleh JavaScript -->
                                </tbody>
                            </table>
                        </div>
                        
                        <!-- No Results Message -->
                        <div id="noResultsMessage" class="hidden text-center py-8 text-gray-500">
                            <div class="text-4xl mb-2">üîç</div>
                            <p class="text-sm">Tidak ada data yang cocok dengan pencarian</p>
                            <p class="text-xs mt-1">Coba kata kunci lain atau <button onclick="clearSearch()" class="text-blue-500 hover:text-blue-700 underline">hapus pencarian</button></p>
                        </div>
                        
                        <!-- No Results Message -->
                        <div id="noUangResultsMessage" class="hidden text-center py-8 text-gray-500">
                            <div class="text-4xl mb-2">üìÖ</div>
                            <p class="text-sm">Tidak ada data yang cocok dengan tanggal pencarian</p>
                            <p class="text-xs mt-1">Coba tanggal lain atau <button onclick="clearUangSearch()" class="text-blue-500 hover:text-blue-700 underline">hapus pencarian</button></p>
                        </div>
                    </div>
                    
                    <!-- Kolom Kanan - Kontrol -->
                    <div class="lg:col-span-1">
                        <h4 class="text-lg font-semibold text-gray-800 mb-4 border-b pb-2">üéÆ Kontrol</h4>
                        
                        <!-- Tombol Navigasi -->
                        <div class="mb-6">
                            <h5 class="text-sm font-medium text-gray-700 mb-3">üìç Navigasi Data:</h5>
                            <div class="grid grid-cols-2 gap-2">
                                <button onclick="firstProdukRecord()" class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-2 rounded-lg text-sm transition-colors flex items-center justify-center">
                                    ‚èÆÔ∏è Pertama
                                </button>
                                <button onclick="previousProdukRecord()" class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-2 rounded-lg text-sm transition-colors flex items-center justify-center">
                                    ‚è™ Sebelum
                                </button>
                                <button onclick="nextProdukRecord()" class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-2 rounded-lg text-sm transition-colors flex items-center justify-center">
                                    ‚è© Sesudah
                                </button>
                                <button onclick="lastProdukRecord()" class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-2 rounded-lg text-sm transition-colors flex items-center justify-center">
                                    ‚è≠Ô∏è Terakhir
                                </button>
                            </div>
                        </div>
                        
                        <!-- Tombol Aksi Data -->
                        <div class="mb-6">
                            <h5 class="text-sm font-medium text-gray-700 mb-3">üíæ Aksi Data:</h5>
                            <div class="space-y-2">
                                <button onclick="saveProdukRecord()" class="w-full bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg text-sm transition-colors flex items-center justify-center">
                                    üíæ Simpan Data
                                </button>
                                <button onclick="undoProdukRecord()" class="w-full bg-yellow-500 hover:bg-yellow-600 text-white px-4 py-2 rounded-lg text-sm transition-colors flex items-center justify-center">
                                    üíæ‚ùå Batal Ubah
                                </button>
                                <button onclick="refreshProdukData()" class="w-full bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg text-sm transition-colors flex items-center justify-center">
                                    üíæ‚ö° Refresh
                                </button>
                                <button onclick="newProdukRecord()" class="w-full bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg text-sm transition-colors flex items-center justify-center">
                                    ‚ûï Data Baru
                                </button>
                                <button onclick="deleteProdukRecord()" class="w-full bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg text-sm transition-colors flex items-center justify-center">
                                    üóëÔ∏è Hapus Data
                                </button>
                            </div>
                        </div>
                        
                        <!-- Tombol Menu -->
                        <div>
                            <h5 class="text-sm font-medium text-gray-700 mb-3">üè† Navigasi Menu:</h5>
                            <button onclick="closeHargaProdukForm()" class="w-full bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg text-sm transition-colors flex items-center justify-center">
                                üíæüè† MENU DEPAN
                            </button>
                        </div>
                        
                        <!-- No Results Message -->
                        <div id="noUangResultsMessage" class="hidden text-center py-8 text-gray-500">
                            <div class="text-4xl mb-2">üìÖ</div>
                            <p class="text-sm">Tidak ada data yang cocok dengan tanggal pencarian</p>
                            <p class="text-xs mt-1">Coba tanggal lain atau <button onclick="clearUangSearch()" class="text-blue-500 hover:text-blue-700 underline">hapus pencarian</button></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Form Itung Uang Modal -->
    <div id="itungUangModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-xl shadow-2xl w-full max-w-5xl max-h-[90vh] overflow-y-auto">
            <div class="bg-green-600 text-white p-4 rounded-t-xl">
                <h3 class="text-xl font-semibold flex items-center justify-between">
                    üßÆ Form Itung Uang
                    <button onclick="closeItungUangForm()" class="text-white hover:text-gray-200 text-2xl">&times;</button>
                </h3>
            </div>
            
            <div class="p-6">
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <!-- Kolom Kiri - Input Data -->
                    <div class="lg:col-span-1">
                        <h4 class="text-lg font-semibold text-gray-800 mb-4 border-b pb-2">üìù Input Data</h4>
                        <form id="itungUangForm" class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">ID (Kunci Database)</label>
                                <input type="number" id="uang_id" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" placeholder="Auto Generate" readonly>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Tanggal</label>
                                <input type="date" id="tanggal_uang" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500">
                            </div>
                        </form>
                        
                        <!-- Money Counter -->
                        <div class="mt-6">
                            <h5 class="text-lg font-semibold text-gray-800 mb-4 border-b pb-2">üí∞ Hitung Uang</h5>
                            <div class="space-y-3">
                                <div class="grid grid-cols-3 gap-2 items-center">
                                    <span class="text-sm font-medium">Rp. 100.000</span>
                                    <input type="number" id="count_100000" class="px-2 py-1 border rounded text-center text-sm" placeholder="0" min="0">
                                    <span class="text-xs text-gray-600">√ó Jumlah lembar</span>
                                </div>
                                <div class="grid grid-cols-3 gap-2 items-center">
                                    <span class="text-sm font-medium">Rp. 75.000</span>
                                    <input type="number" id="count_75000" class="px-2 py-1 border rounded text-center text-sm" placeholder="0" min="0">
                                    <span class="text-xs text-gray-600">√ó Jumlah lembar</span>
                                </div>
                                <div class="grid grid-cols-3 gap-2 items-center">
                                    <span class="text-sm font-medium">Rp. 50.000</span>
                                    <input type="number" id="count_50000" class="px-2 py-1 border rounded text-center text-sm" placeholder="0" min="0">
                                    <span class="text-xs text-gray-600">√ó Jumlah lembar</span>
                                </div>
                                <div class="grid grid-cols-3 gap-2 items-center">
                                    <span class="text-sm font-medium">Rp. 20.000</span>
                                    <input type="number" id="count_20000" class="px-2 py-1 border rounded text-center text-sm" placeholder="0" min="0">
                                    <span class="text-xs text-gray-600">√ó Jumlah lembar</span>
                                </div>
                                <div class="grid grid-cols-3 gap-2 items-center">
                                    <span class="text-sm font-medium">Rp. 10.000</span>
                                    <input type="number" id="count_10000" class="px-2 py-1 border rounded text-center text-sm" placeholder="0" min="0">
                                    <span class="text-xs text-gray-600">√ó Jumlah lembar</span>
                                </div>
                                <div class="grid grid-cols-3 gap-2 items-center">
                                    <span class="text-sm font-medium">Rp. 5.000</span>
                                    <input type="number" id="count_5000" class="px-2 py-1 border rounded text-center text-sm" placeholder="0" min="0">
                                    <span class="text-xs text-gray-600">√ó Jumlah lembar</span>
                                </div>
                                <div class="grid grid-cols-3 gap-2 items-center">
                                    <span class="text-sm font-medium">Rp. 2.000</span>
                                    <input type="number" id="count_2000" class="px-2 py-1 border rounded text-center text-sm" placeholder="0" min="0">
                                    <span class="text-xs text-gray-600">√ó Jumlah lembar</span>
                                </div>
                                <div class="grid grid-cols-3 gap-2 items-center">
                                    <span class="text-sm font-medium">Rp. 1.000</span>
                                    <input type="number" id="count_1000" class="px-2 py-1 border rounded text-center text-sm" placeholder="0" min="0">
                                    <span class="text-xs text-gray-600">√ó Jumlah lembar</span>
                                </div>
                                <div class="grid grid-cols-3 gap-2 items-center">
                                    <span class="text-sm font-medium">Rp. 500</span>
                                    <input type="number" id="count_500" class="px-2 py-1 border rounded text-center text-sm" placeholder="0" min="0">
                                    <span class="text-xs text-gray-600">√ó Jumlah koin</span>
                                </div>
                                <div class="grid grid-cols-3 gap-2 items-center">
                                    <span class="text-sm font-medium">Rp. 200</span>
                                    <input type="number" id="count_200" class="px-2 py-1 border rounded text-center text-sm" placeholder="0" min="0">
                                    <span class="text-xs text-gray-600">√ó Jumlah koin</span>
                                </div>
                            </div>
                            
                            <!-- Total Display -->
                            <div class="mt-6 p-4 bg-green-50 rounded-lg border-2 border-green-200">
                                <h6 class="text-lg font-bold text-green-800 mb-2">üí∞ Total Uang:</h6>
                                <div class="text-2xl font-bold text-green-600" id="totalUang">Rp 0</div>
                                <button onclick="hitungTotal()" class="mt-3 w-full bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg text-sm font-medium">
                                    üßÆ Hitung Total
                                </button>
                            </div>
                            
                            <!-- Additional Asset Inputs -->
                            <div class="mt-6">
                                <h6 class="text-lg font-semibold text-gray-800 mb-4 border-b pb-2">üí≥ Aset Keuangan</h6>
                                <div class="space-y-3">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">REK BCA</label>
                                        <input type="number" id="rek_bca" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 text-sm" placeholder="0" min="0">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">SALDO PULSA</label>
                                        <input type="number" id="saldo_pulsa" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 text-sm" placeholder="0" min="0">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">SALDO DANA</label>
                                        <input type="number" id="saldo_dana" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 text-sm" placeholder="0" min="0">
                                    </div>
                                    
                                    <!-- Jumlah Aset Display -->
                                    <div class="mt-4 p-3 bg-blue-50 rounded-lg border-2 border-blue-200">
                                        <h6 class="text-sm font-bold text-blue-800 mb-1">üíé Jumlah Aset:</h6>
                                        <div class="text-xl font-bold text-blue-600" id="jumlahAset">Rp 0</div>
                                        <p class="text-xs text-gray-600 mt-1">REK BCA + SALDO PULSA + SALDO DANA + TOTAL UANG</p>
                                        <button onclick="itungAset()" class="mt-3 w-full bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm font-medium">
                                            üíé Itung Aset
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Current Record Info -->
                        <div class="mt-4 p-3 bg-gray-100 rounded-lg">
                            <p class="text-sm text-gray-600">Record: <span id="currentUangRecord">1</span> of <span id="totalUangRecords">3</span></p>
                        </div>
                        
                        <!-- No Results Message -->
                        <div id="noUangResultsMessage" class="hidden text-center py-8 text-gray-500">
                            <div class="text-4xl mb-2">üìÖ</div>
                            <p class="text-sm">Tidak ada data yang cocok dengan tanggal pencarian</p>
                            <p class="text-xs mt-1">Coba tanggal lain atau <button onclick="clearUangSearch()" class="text-blue-500 hover:text-blue-700 underline">hapus pencarian</button></p>
                        </div>
                    </div>
                    
                    <!-- Kolom Tengah - Tabel Data -->
                    <div class="lg:col-span-1">
                        <h4 class="text-lg font-semibold text-gray-800 mb-4 border-b pb-2">üìä Data Itung Uang</h4>
                        
                        <!-- Search Box -->
                        <div class="mb-4">
                            <div class="relative">
                                <input type="date" id="searchTanggalUang" class="w-full px-4 py-2 pl-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 text-sm">
                                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                    <span class="text-gray-400">üìÖ</span>
                                </div>
                                <button onclick="clearUangSearch()" class="absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600" title="Clear search">
                                    <span class="text-lg">√ó</span>
                                </button>
                            </div>
                            <div class="mt-2 text-xs text-gray-500">
                                <span id="searchUangResults">Menampilkan <span id="visibleUangCount">3</span> dari <span id="totalUangCount">3</span> data</span>
                            </div>
                        </div>
                        
                        <div class="overflow-x-auto max-h-96">
                            <table class="w-full border-collapse border border-gray-300 text-sm">
                                <thead class="sticky top-0 bg-white">
                                    <tr class="bg-green-100">
                                        <th class="border border-gray-300 px-3 py-2 text-left font-semibold">ID</th>
                                        <th class="border border-gray-300 px-3 py-2 text-left font-semibold">Tanggal</th>
                                        <th class="border border-gray-300 px-3 py-2 text-left font-semibold">Keuangan</th>
                                        <th class="border border-gray-300 px-3 py-2 text-center font-semibold">Aksi</th>
                                    </tr>
                                </thead>
                                <tbody id="uangTableBody">
                                    <!-- Data akan diisi oleh JavaScript -->
                                </tbody>
                            </table>
                        </div>
                        
                        <!-- No Results Message -->
                        <div id="noUangResultsMessage" class="hidden text-center py-8 text-gray-500">
                            <div class="text-4xl mb-2">üìÖ</div>
                            <p class="text-sm">Tidak ada data yang cocok dengan tanggal pencarian</p>
                            <p class="text-xs mt-1">Coba tanggal lain atau <button onclick="clearUangSearch()" class="text-blue-500 hover:text-blue-700 underline">hapus pencarian</button></p>
                        </div>
                    </div>
                    
                    <!-- Kolom Kanan - Kontrol -->
                    <div class="lg:col-span-1">
                        <h4 class="text-lg font-semibold text-gray-800 mb-4 border-b pb-2">üéÆ Kontrol</h4>
                        
                        <!-- Tombol Navigasi -->
                        <div class="mb-6">
                            <h5 class="text-sm font-medium text-gray-700 mb-3">üìç Navigasi Data:</h5>
                            <div class="grid grid-cols-2 gap-2">
                                <button onclick="firstUangRecord()" class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-2 rounded-lg text-sm transition-colors flex items-center justify-center">
                                    ‚èÆÔ∏è Pertama
                                </button>
                                <button onclick="previousUangRecord()" class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-2 rounded-lg text-sm transition-colors flex items-center justify-center">
                                    ‚è™ Sebelum
                                </button>
                                <button onclick="nextUangRecord()" class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-2 rounded-lg text-sm transition-colors flex items-center justify-center">
                                    ‚è© Sesudah
                                </button>
                                <button onclick="lastUangRecord()" class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-2 rounded-lg text-sm transition-colors flex items-center justify-center">
                                    ‚è≠Ô∏è Terakhir
                                </button>
                            </div>
                        </div>
                        
                        <!-- Tombol Aksi Data -->
                        <div class="mb-6">
                            <h5 class="text-sm font-medium text-gray-700 mb-3">üíæ Aksi Data:</h5>
                            <div class="space-y-2">
                                <button onclick="saveUangRecord()" class="w-full bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg text-sm transition-colors flex items-center justify-center">
                                    üíæ Simpan Data
                                </button>
                                <button onclick="undoUangRecord()" class="w-full bg-yellow-500 hover:bg-yellow-600 text-white px-4 py-2 rounded-lg text-sm transition-colors flex items-center justify-center">
                                    üíæ‚ùå Batal Ubah
                                </button>
                                <button onclick="refreshUangData()" class="w-full bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg text-sm transition-colors flex items-center justify-center">
                                    üíæ‚ö° Refresh
                                </button>
                                <button onclick="newUangRecord()" class="w-full bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg text-sm transition-colors flex items-center justify-center">
                                    ‚ûï Data Baru
                                </button>
                                <button onclick="deleteUangRecord()" class="w-full bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg text-sm transition-colors flex items-center justify-center">
                                    üóëÔ∏è Hapus Data
                                </button>
                            </div>
                        </div>
                        
                        <!-- Detail Perhitungan -->
                        <div class="mb-6">
                            <h5 class="text-sm font-medium text-gray-700 mb-3">üìã Detail Perhitungan:</h5>
                            <div class="bg-gray-50 p-3 rounded-lg text-xs space-y-1" id="detailPerhitungan">
                                <div class="text-gray-600">Belum ada perhitungan</div>
                            </div>
                        </div>
                        
                        <!-- Tombol Menu -->
                        <div>
                            <h5 class="text-sm font-medium text-gray-700 mb-3">üè† Navigasi Menu:</h5>
                            <button onclick="closeItungUangForm()" class="w-full bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg text-sm transition-colors flex items-center justify-center">
                                üíæüè† MENU DEPAN
                            </button>
                        </div>
                        
                        <!-- No Results Message -->
                        <div id="noUangResultsMessage" class="hidden text-center py-8 text-gray-500">
                            <div class="text-4xl mb-2">üìÖ</div>
                            <p class="text-sm">Tidak ada data yang cocok dengan tanggal pencarian</p>
                            <p class="text-xs mt-1">Coba tanggal lain atau <button onclick="clearUangSearch()" class="text-blue-500 hover:text-blue-700 underline">hapus pencarian</button></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Form Beli Modal -->
    <div id="beliModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-xl shadow-2xl w-full max-w-6xl max-h-[90vh] overflow-y-auto">
            <div class="bg-green-600 text-white p-4 rounded-t-xl">
                <h3 class="text-xl font-semibold flex items-center justify-between">
                    üõí Form Beli
                    <button onclick="closeBeliForm()" class="text-white hover:text-gray-200 text-2xl">&times;</button>
                </h3>
            </div>
            
            <div class="p-6">
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <!-- Kolom Kiri - Input Data -->
                    <div class="lg:col-span-1">
                        <h4 class="text-lg font-semibold text-gray-800 mb-4 border-b pb-2">üìù Input Data</h4>
                        <form id="beliForm" class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">No (Primary Key)</label>
                                <input type="number" id="beli_no" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" placeholder="Auto Generate" readonly>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Tanggal</label>
                                <input type="date" id="beli_tanggal" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500">
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Ket Kebutuhan</label>
                                <textarea id="ket_kebutuhan" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" placeholder="Masukkan keterangan kebutuhan"></textarea>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Nama Barang</label>
                                <input type="text" id="nama_barang" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" placeholder="Masukkan nama barang">
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Harga</label>
                                <input type="number" id="harga_barang" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" placeholder="Masukkan harga">
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Jumlah</label>
                                <input type="number" id="jumlah_barang" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" placeholder="Masukkan jumlah">
                            </div>
                            
                            <!-- Total Harga Display -->
                            <div class="mt-4 p-3 bg-green-50 rounded-lg border-2 border-green-200">
                                <h6 class="text-sm font-bold text-green-800 mb-1">üí∞ Total Harga:</h6>
                                <div class="text-xl font-bold text-green-600" id="totalHargaBeli">Rp 0</div>
                                <p class="text-xs text-gray-600 mt-1">Harga √ó Jumlah</p>
                            </div>
                        </form>
                        
                        <!-- Current Record Info -->
                        <div class="mt-4 p-3 bg-gray-100 rounded-lg">
                            <p class="text-sm text-gray-600">Record: <span id="currentBeliRecord">1</span> of <span id="totalBeliRecords">5</span></p>
                        </div>
                    </div>
                    
                    <!-- Kolom Tengah - Tabel Data -->
                    <div class="lg:col-span-1">
                        <h4 class="text-lg font-semibold text-gray-800 mb-4 border-b pb-2">üìä Data Pembelian</h4>
                        
                        <!-- Search Box -->
                        <div class="mb-4">
                            <div class="relative">
                                <input type="text" id="searchBeli" placeholder="üîç Cari nama barang..." class="w-full px-4 py-2 pl-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 text-sm">
                                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                    <span class="text-gray-400">üîç</span>
                                </div>
                                <button onclick="clearBeliSearch()" class="absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600" title="Clear search">
                                    <span class="text-lg">√ó</span>
                                </button>
                            </div>
                            <div class="mt-2 text-xs text-gray-500">
                                <span id="searchBeliResults">Menampilkan <span id="visibleBeliCount">5</span> dari <span id="totalBeliCount">5</span> data</span>
                            </div>
                        </div>
                        
                        <div class="overflow-x-auto max-h-96">
                            <table class="w-full border-collapse border border-gray-300 text-sm">
                                <thead class="sticky top-0 bg-white">
                                    <tr class="bg-green-100">
                                        <th class="border border-gray-300 px-3 py-2 text-left font-semibold">No</th>
                                        <th class="border border-gray-300 px-3 py-2 text-left font-semibold">Tanggal</th>
                                        <th class="border border-gray-300 px-3 py-2 text-left font-semibold">Nama Barang</th>
                                        <th class="border border-gray-300 px-3 py-2 text-left font-semibold">Total</th>
                                        <th class="border border-gray-300 px-3 py-2 text-center font-semibold">Aksi</th>
                                    </tr>
                                </thead>
                                <tbody id="beliTableBody">
                                    <!-- Data akan diisi oleh JavaScript -->
                                </tbody>
                            </table>
                        </div>
                        
                        <!-- No Results Message -->
                        <div id="noBeliResultsMessage" class="hidden text-center py-8 text-gray-500">
                            <div class="text-4xl mb-2">üîç</div>
                            <p class="text-sm">Tidak ada data yang cocok dengan pencarian</p>
                            <p class="text-xs mt-1">Coba kata kunci lain atau <button onclick="clearBeliSearch()" class="text-blue-500 hover:text-blue-700 underline">hapus pencarian</button></p>
                        </div>
                    </div>
                    
                    <!-- Kolom Kanan - Kontrol -->
                    <div class="lg:col-span-1">
                        <h4 class="text-lg font-semibold text-gray-800 mb-4 border-b pb-2">üéÆ Kontrol</h4>
                        
                        <!-- Tombol Navigasi -->
                        <div class="mb-6">
                            <h5 class="text-sm font-medium text-gray-700 mb-3">üìç Navigasi Data:</h5>
                            <div class="grid grid-cols-2 gap-2">
                                <button onclick="firstBeliRecord()" class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-2 rounded-lg text-sm transition-colors flex items-center justify-center">
                                    ‚èÆÔ∏è Pertama
                                </button>
                                <button onclick="previousBeliRecord()" class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-2 rounded-lg text-sm transition-colors flex items-center justify-center">
                                    ‚è™ Sebelum
                                </button>
                                <button onclick="nextBeliRecord()" class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-2 rounded-lg text-sm transition-colors flex items-center justify-center">
                                    ‚è© Sesudah
                                </button>
                                <button onclick="lastBeliRecord()" class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-2 rounded-lg text-sm transition-colors flex items-center justify-center">
                                    ‚è≠Ô∏è Terakhir
                                </button>
                            </div>
                        </div>
                        
                        <!-- Tombol Aksi Data -->
                        <div class="mb-6">
                            <h5 class="text-sm font-medium text-gray-700 mb-3">üíæ Aksi Data:</h5>
                            <div class="space-y-2">
                                <button onclick="saveBeliRecord()" class="w-full bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg text-sm transition-colors flex items-center justify-center">
                                    üíæ Simpan Data
                                </button>
                                <button onclick="undoBeliRecord()" class="w-full bg-yellow-500 hover:bg-yellow-600 text-white px-4 py-2 rounded-lg text-sm transition-colors flex items-center justify-center">
                                    üíæ‚ùå Batal Ubah
                                </button>
                                <button onclick="refreshBeliData()" class="w-full bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg text-sm transition-colors flex items-center justify-center">
                                    üíæ‚ö° Refresh
                                </button>
                                <button onclick="newBeliRecord()" class="w-full bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg text-sm transition-colors flex items-center justify-center">
                                    ‚ûï Data Baru
                                </button>
                                <button onclick="deleteBeliRecord()" class="w-full bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg text-sm transition-colors flex items-center justify-center">
                                    üóëÔ∏è Hapus Data
                                </button>
                            </div>
                        </div>
                        
                        <!-- Detail Pembelian -->
                        <div class="mb-6">
                            <h5 class="text-sm font-medium text-gray-700 mb-3">üìã Detail Pembelian:</h5>
                            <div class="bg-gray-50 p-3 rounded-lg text-xs space-y-1" id="detailPembelian">
                                <div class="text-gray-600">Belum ada data pembelian</div>
                            </div>
                        </div>
                        
                        <!-- Tombol Menu -->
                        <div>
                            <h5 class="text-sm font-medium text-gray-700 mb-3">üè† Navigasi Menu:</h5>
                            <button onclick="closeBeliForm()" class="w-full bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg text-sm transition-colors flex items-center justify-center">
                                üíæüè† MENU DEPAN
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Form Belangko Modal -->
    <div id="belangkoModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-xl shadow-2xl w-full max-w-6xl max-h-[90vh] overflow-y-auto">
            <div class="bg-blue-600 text-white p-4 rounded-t-xl">
                <h3 class="text-xl font-semibold flex items-center justify-between">
                    üíå Form Hitung Undangan Belangko
                    <button onclick="closeBelangkoForm()" class="text-white hover:text-gray-200 text-2xl">&times;</button>
                </h3>
            </div>
            
            <div class="p-6">
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <!-- Kolom Kiri - Input Data -->
                    <div class="lg:col-span-1">
                        <h4 class="text-lg font-semibold text-gray-800 mb-4 border-b pb-2">üìù Input Data</h4>
                        <form id="belangkoForm" class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">No (Primary Key)</label>
                                <input type="number" id="belangko_no" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="Auto Generate" readonly>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Kode Belangko</label>
                                <input type="text" id="kode_belangko" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="Masukkan kode belangko">
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Harga</label>
                                <input type="number" id="harga_belangko" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="Masukkan harga">
                            </div>
                            
                            <!-- Tombol Input Ukuran Plastik -->
                            <div class="mt-4">
                                <button type="button" onclick="openPlastikSizeInput()" class="w-full bg-orange-500 hover:bg-orange-600 text-white px-4 py-3 rounded-lg text-sm font-medium transition-colors shadow-md hover:shadow-lg flex items-center justify-center">
                                    üìè INPUT UKURAN PLASTIK
                                </button>
                            </div>
                            
                            <!-- Input Jumlah Undangan -->
                            <div class="mt-4">
                                <label class="block text-sm font-medium text-gray-700 mb-2">BUAT UNDANGAN BERAPA PIS</label>
                                <input type="number" id="jumlah_undangan" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="Masukkan jumlah undangan" min="1">
                                <p class="text-xs text-gray-500 mt-1">Masukkan jumlah undangan yang akan dibuat (dalam pis/lembar)</p>
                            </div>
                            
                            <!-- Combo Box Harga OC/Cetak -->
                            <div class="mt-4">
                                <label class="block text-sm font-medium text-gray-700 mb-2">PILIH HARGA OC/CETAK</label>
                                <select id="harga_oc" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                    <option value="">-- Pilih Jenis OC/Cetak --</option>
                                    <option value="50">OC Mesin Toko - Rp 50 per lembar</option>
                                    <option value="120">OC Printer - Rp 120 per lembar</option>
                                    <option value="200">OC Warna - Rp 200 per lembar</option>
                                </select>
                                <p class="text-xs text-gray-500 mt-1">Pilih jenis cetak untuk menambahkan biaya OC ke kalkulasi</p>
                            </div>
                            
                            <!-- Selected Plastic Display -->
                            <div id="selectedPlastikDisplay" class="mt-4 p-4 bg-orange-50 border-2 border-orange-200 rounded-lg hidden">
                                <h6 class="text-sm font-semibold text-orange-800 mb-3 flex items-center">
                                    üìè Ukuran Plastik Terpilih
                                </h6>
                                <div id="selectedPlastikInfo" class="space-y-2">
                                    <!-- Info will be populated by JavaScript -->
                                </div>
                                <button onclick="clearSelectedPlastik()" class="mt-3 w-full bg-red-500 hover:bg-red-600 text-white px-3 py-2 rounded-lg text-xs font-medium transition-colors">
                                    ‚ùå Hapus Pilihan
                                </button>
                            </div>
                            
                            <!-- Customer Pricing Menu -->
                            <div id="customerPricingDisplay" class="mt-4 p-4 bg-red-50 border-2 border-red-300 rounded-lg hidden">
                                <h6 class="text-lg font-bold text-red-600 mb-4 text-center">
                                    üí∞ HARGA JUAL KE CUSTOMER
                                </h6>
                                <div id="customerPricingInfo" class="space-y-3">
                                    <!-- Pricing info will be populated by JavaScript -->
                                </div>
                            </div>
                            
                            <!-- Price Negotiation Input -->
                            <div id="priceTawarDisplay" class="mt-4 p-4 bg-yellow-50 border-2 border-yellow-300 rounded-lg hidden">
                                <h6 class="text-lg font-bold text-yellow-700 mb-4 text-center">
                                    üí¨ HARGA TAWAR
                                </h6>
                                <div class="space-y-3">
                                    <div>
                                        <label class="block text-sm font-medium text-yellow-700 mb-2">Harga Tawar Customer (per pis)</label>
                                        <input type="number" id="harga_tawar" class="w-full px-3 py-2 border border-yellow-300 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-yellow-500" placeholder="Masukkan harga tawar customer" min="0">
                                    </div>
                                    
                                    <!-- Calculation Display -->
                                    <div id="tawarCalculation" class="mt-4 p-3 bg-white rounded-lg border border-yellow-200">
                                        <div class="text-sm text-gray-600 mb-2">üßÆ Hitung Harga Tawar:</div>
                                        <div class="space-y-2 text-xs">
                                            <div class="bg-yellow-50 p-2 rounded">
                                                <div class="flex justify-between">
                                                    <span>Harga Tawar per pis:</span>
                                                    <span id="tawarPerPis" class="font-medium">-</span>
                                                </div>
                                                <div class="flex justify-between">
                                                    <span>Jumlah Undangan:</span>
                                                    <span id="jumlahUndanganTawar" class="font-medium">-</span>
                                                </div>
                                                <hr class="my-2 border-yellow-200">
                                                <div class="flex justify-between font-bold text-lg">
                                                    <span>TOTAL HARGA TAWAR:</span>
                                                    <span id="totalHargaTawar" class="text-blue-600">-</span>
                                                </div>
                                            </div>
                                            <div class="bg-green-50 p-2 rounded">
                                                <div class="flex justify-between">
                                                    <span>Harga Modal per pis:</span>
                                                    <span id="modalPerPis" class="font-medium">-</span>
                                                </div>
                                                <div class="flex justify-between font-bold">
                                                    <span>Keuntungan per pis:</span>
                                                    <span id="keuntunganPerPis" class="text-green-600">-</span>
                                                </div>
                                                <div class="flex justify-between font-bold">
                                                    <span>Total Keuntungan:</span>
                                                    <span id="totalKeuntungan" class="text-green-600">-</span>
                                                </div>
                                                <div class="flex justify-between font-bold">
                                                    <span>Status:</span>
                                                    <span id="statusTawar" class="font-bold">-</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </form>
                        
                        <!-- Current Record Info -->
                        <div class="mt-4 p-3 bg-gray-100 rounded-lg">
                            <p class="text-sm text-gray-600">Record: <span id="currentBelangkoRecord">1</span> of <span id="totalBelangkoRecords">5</span></p>
                        </div>
                    </div>
                    
                    <!-- Kolom Tengah - Tabel Data -->
                    <div class="lg:col-span-1">
                        <!-- Tab Navigation -->
                        <div class="flex mb-4 border-b">
                            <button onclick="showBelangkoTab()" id="belangkoTab" class="px-4 py-2 text-sm font-medium border-b-2 border-blue-500 text-blue-600 bg-blue-50">
                                üìä Data Belangko
                            </button>
                            <button onclick="showPlastikTab()" id="plastikTab" class="px-4 py-2 text-sm font-medium border-b-2 border-transparent text-gray-500 hover:text-gray-700">
                                üìè Ukuran Plastik
                            </button>
                        </div>
                        
                        <!-- Belangko Data Tab -->
                        <div id="belangkoDataTab">
                            <h4 class="text-lg font-semibold text-gray-800 mb-4 border-b pb-2">üìä Data Belangko</h4>
                            
                            <!-- Search Box -->
                            <div class="mb-4">
                                <div class="relative">
                                    <input type="text" id="searchBelangko" placeholder="üîç Cari kode belangko..." class="w-full px-4 py-2 pl-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm">
                                    <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                        <span class="text-gray-400">üîç</span>
                                    </div>
                                    <button onclick="clearBelangkoSearch()" class="absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600" title="Clear search">
                                        <span class="text-lg">√ó</span>
                                    </button>
                                </div>
                                <div class="mt-2 text-xs text-gray-500">
                                    <span id="searchBelangkoResults">Menampilkan <span id="visibleBelangkoCount">5</span> dari <span id="totalBelangkoCount">5</span> data</span>
                                </div>
                            </div>
                            
                            <div class="overflow-x-auto max-h-96">
                                <table class="w-full border-collapse border border-gray-300 text-sm">
                                    <thead class="sticky top-0 bg-white">
                                        <tr class="bg-blue-100">
                                            <th class="border border-gray-300 px-3 py-2 text-left font-semibold">No</th>
                                            <th class="border border-gray-300 px-3 py-2 text-left font-semibold">Kode Belangko</th>
                                            <th class="border border-gray-300 px-3 py-2 text-left font-semibold">Harga</th>
                                            <th class="border border-gray-300 px-3 py-2 text-center font-semibold">Aksi</th>
                                        </tr>
                                    </thead>
                                    <tbody id="belangkoTableBody">
                                        <!-- Data akan diisi oleh JavaScript -->
                                    </tbody>
                                </table>
                            </div>
                            
                            <!-- No Results Message -->
                            <div id="noBelangkoResultsMessage" class="hidden text-center py-8 text-gray-500">
                                <div class="text-4xl mb-2">üîç</div>
                                <p class="text-sm">Tidak ada data yang cocok dengan pencarian</p>
                                <p class="text-xs mt-1">Coba kata kunci lain atau <button onclick="clearBelangkoSearch()" class="text-blue-500 hover:text-blue-700 underline">hapus pencarian</button></p>
                            </div>
                        </div>
                        
                        <!-- Plastik Data Tab -->
                        <div id="plastikDataTab" class="hidden">
                            <h4 class="text-lg font-semibold text-gray-800 mb-4 border-b pb-2">üìè Database Ukuran Plastik</h4>
                            
                            <!-- Search Box for Plastik -->
                            <div class="mb-4">
                                <div class="relative">
                                    <input type="text" id="searchPlastikInBelangko" placeholder="üîç Cari nama ukuran..." class="w-full px-4 py-2 pl-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 text-sm">
                                    <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                        <span class="text-gray-400">üîç</span>
                                    </div>
                                    <button onclick="clearPlastikInBelangkoSearch()" class="absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600" title="Clear search">
                                        <span class="text-lg">√ó</span>
                                    </button>
                                </div>
                                <div class="mt-2 text-xs text-gray-500">
                                    <span id="searchPlastikInBelangkoResults">Menampilkan <span id="visiblePlastikInBelangkoCount">3</span> dari <span id="totalPlastikInBelangkoCount">3</span> data</span>
                                </div>
                            </div>
                            
                            <div class="overflow-x-auto max-h-96">
                                <table class="w-full border-collapse border border-gray-300 text-sm">
                                    <thead class="sticky top-0 bg-white">
                                        <tr class="bg-orange-100">
                                            <th class="border border-gray-300 px-2 py-2 text-left font-semibold text-xs">ID</th>
                                            <th class="border border-gray-300 px-2 py-2 text-left font-semibold text-xs">Nama Ukuran</th>
                                            <th class="border border-gray-300 px-2 py-2 text-center font-semibold text-xs">Panjang</th>
                                            <th class="border border-gray-300 px-2 py-2 text-center font-semibold text-xs">Lebar</th>
                                            <th class="border border-gray-300 px-2 py-2 text-left font-semibold text-xs">Harga</th>
                                            <th class="border border-gray-300 px-2 py-2 text-center font-semibold text-xs">Aksi</th>
                                        </tr>
                                    </thead>
                                    <tbody id="plastikInBelangkoTableBody">
                                        <!-- Data akan diisi oleh JavaScript -->
                                    </tbody>
                                </table>
                            </div>
                            
                            <!-- No Results Message -->
                            <div id="noPlastikInBelangkoResultsMessage" class="hidden text-center py-8 text-gray-500">
                                <div class="text-4xl mb-2">üîç</div>
                                <p class="text-sm">Tidak ada data yang cocok dengan pencarian</p>
                                <p class="text-xs mt-1">Coba kata kunci lain atau <button onclick="clearPlastikInBelangkoSearch()" class="text-orange-500 hover:text-orange-700 underline">hapus pencarian</button></p>
                            </div>
                            
                            <!-- Quick Actions -->
                            <div class="mt-4 p-3 bg-orange-50 rounded-lg border border-orange-200">
                                <h5 class="text-sm font-medium text-orange-800 mb-2">‚ö° Aksi Cepat:</h5>
                                <div class="flex flex-wrap gap-2">
                                    <button onclick="openPlastikSizeInput()" class="bg-orange-500 hover:bg-orange-600 text-white px-3 py-1 rounded text-xs transition-colors">
                                        ‚ûï Tambah Ukuran
                                    </button>
                                    <button onclick="refreshPlastikInBelangkoTable()" class="bg-gray-500 hover:bg-gray-600 text-white px-3 py-1 rounded text-xs transition-colors">
                                        üîÑ Refresh
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Kolom Kanan - Kontrol -->
                    <div class="lg:col-span-1">
                        <h4 class="text-lg font-semibold text-gray-800 mb-4 border-b pb-2">üéÆ Kontrol</h4>
                        
                        <!-- Tombol Navigasi -->
                        <div class="mb-6">
                            <h5 class="text-sm font-medium text-gray-700 mb-3">üìç Navigasi Data:</h5>
                            <div class="grid grid-cols-2 gap-2">
                                <button onclick="firstBelangkoRecord()" class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-2 rounded-lg text-sm transition-colors flex items-center justify-center">
                                    ‚èÆÔ∏è Pertama
                                </button>
                                <button onclick="previousBelangkoRecord()" class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-2 rounded-lg text-sm transition-colors flex items-center justify-center">
                                    ‚è™ Sebelum
                                </button>
                                <button onclick="nextBelangkoRecord()" class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-2 rounded-lg text-sm transition-colors flex items-center justify-center">
                                    ‚è© Sesudah
                                </button>
                                <button onclick="lastBelangkoRecord()" class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-2 rounded-lg text-sm transition-colors flex items-center justify-center">
                                    ‚è≠Ô∏è Terakhir
                                </button>
                            </div>
                        </div>
                        
                        <!-- Tombol Aksi Data -->
                        <div class="mb-6">
                            <h5 class="text-sm font-medium text-gray-700 mb-3">üíæ Aksi Data:</h5>
                            <div class="space-y-2">
                                <button onclick="saveBelangkoRecord()" class="w-full bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg text-sm transition-colors flex items-center justify-center">
                                    üíæ Simpan Data
                                </button>
                                <button onclick="undoBelangkoRecord()" class="w-full bg-yellow-500 hover:bg-yellow-600 text-white px-4 py-2 rounded-lg text-sm transition-colors flex items-center justify-center">
                                    üíæ‚ùå Batal Ubah
                                </button>
                                <button onclick="refreshBelangkoData()" class="w-full bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg text-sm transition-colors flex items-center justify-center">
                                    üíæ‚ö° Refresh
                                </button>
                                <button onclick="newBelangkoRecord()" class="w-full bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg text-sm transition-colors flex items-center justify-center">
                                    ‚ûï Data Baru
                                </button>
                                <button onclick="deleteBelangkoRecord()" class="w-full bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg text-sm transition-colors flex items-center justify-center">
                                    üóëÔ∏è Hapus Data
                                </button>
                            </div>
                        </div>
                        
                        <!-- Detail Belangko -->
                        <div class="mb-6">
                            <h5 class="text-sm font-medium text-gray-700 mb-3">üìã Detail Belangko:</h5>
                            <div class="bg-gray-50 p-3 rounded-lg text-xs space-y-1" id="detailBelangko">
                                <div class="text-gray-600">Belum ada data belangko</div>
                            </div>
                        </div>
                        
                        <!-- Detail Data Proses Belangko (Harga Modal) -->
                        <div class="mb-6">
                            <h5 class="text-sm font-medium text-gray-700 mb-3">üí∞ Harga Modal:</h5>
                            <div class="bg-blue-50 p-3 rounded-lg border border-blue-200 text-xs space-y-1" id="detailProsesBelangko">
                                <div class="text-gray-600">Pilih data belangko dan ukuran plastik untuk melihat detail proses</div>
                            </div>
                        </div>
                        
                        <!-- Tombol Menu -->
                        <div>
                            <h5 class="text-sm font-medium text-gray-700 mb-3">üè† Navigasi Menu:</h5>
                            <button onclick="closeBelangkoForm()" class="w-full bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg text-sm transition-colors flex items-center justify-center">
                                üíæüè† MENU DEPAN
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Form Ukuran Plastik Modal -->
    <div id="plastikSizeModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto">
            <div class="bg-orange-600 text-white p-4 rounded-t-xl">
                <h3 class="text-xl font-semibold flex items-center justify-between">
                    üìè Input Ukuran Plastik
                    <button onclick="closePlastikSizeInput()" class="text-white hover:text-gray-200 text-2xl">&times;</button>
                </h3>
            </div>
            
            <div class="p-6">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- Kolom Kiri - Input Data -->
                    <div>
                        <h4 class="text-lg font-semibold text-gray-800 mb-4 border-b pb-2">üìù Data Ukuran Plastik</h4>
                        <form id="plastikSizeForm" class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">ID Ukuran</label>
                                <input type="number" id="plastik_id" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500" placeholder="Auto Generate" readonly>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Nama Ukuran</label>
                                <input type="text" id="nama_ukuran" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500" placeholder="Contoh: Plastik A4, Plastik A5">
                            </div>
                            
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Panjang (cm)</label>
                                    <input type="number" id="panjang_plastik" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500" placeholder="0" step="0.1">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Lebar (cm)</label>
                                    <input type="number" id="lebar_plastik" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500" placeholder="0" step="0.1">
                                </div>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Harga per Lembar</label>
                                <input type="number" id="harga_plastik" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500" placeholder="0">
                            </div>
                        </form>
                        
                        <!-- Current Record Info -->
                        <div class="mt-4 p-3 bg-gray-100 rounded-lg">
                            <p class="text-sm text-gray-600">Record: <span id="currentPlastikRecord">1</span> of <span id="totalPlastikRecords">3</span></p>
                        </div>
                    </div>
                    
                    <!-- Kolom Kanan - Tabel & Kontrol -->
                    <div>
                        <h4 class="text-lg font-semibold text-gray-800 mb-4 border-b pb-2">üìä Data Ukuran Plastik</h4>
                        
                        <!-- Search Box -->
                        <div class="mb-4">
                            <div class="relative">
                                <input type="text" id="searchPlastik" placeholder="üîç Cari nama ukuran..." class="w-full px-4 py-2 pl-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 text-sm">
                                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                    <span class="text-gray-400">üîç</span>
                                </div>
                                <button onclick="clearPlastikSearch()" class="absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600" title="Clear search">
                                    <span class="text-lg">√ó</span>
                                </button>
                            </div>
                            <div class="mt-2 text-xs text-gray-500">
                                <span id="searchPlastikResults">Menampilkan <span id="visiblePlastikCount">3</span> dari <span id="totalPlastikCount">3</span> data</span>
                            </div>
                        </div>
                        
                        <div class="overflow-x-auto max-h-64 mb-4">
                            <table class="w-full border-collapse border border-gray-300 text-sm">
                                <thead class="sticky top-0 bg-white">
                                    <tr class="bg-orange-100">
                                        <th class="border border-gray-300 px-2 py-2 text-left font-semibold text-xs">ID</th>
                                        <th class="border border-gray-300 px-2 py-2 text-left font-semibold text-xs">Nama</th>
                                        <th class="border border-gray-300 px-2 py-2 text-left font-semibold text-xs">Panjang</th>
                                        <th class="border border-gray-300 px-2 py-2 text-left font-semibold text-xs">Lebar</th>
                                        <th class="border border-gray-300 px-2 py-2 text-left font-semibold text-xs">Harga</th>
                                        <th class="border border-gray-300 px-2 py-2 text-center font-semibold text-xs">Aksi</th>
                                    </tr>
                                </thead>
                                <tbody id="plastikTableBody">
                                    <!-- Data akan diisi oleh JavaScript -->
                                </tbody>
                            </table>
                        </div>
                        
                        <!-- No Results Message -->
                        <div id="noPlastikResultsMessage" class="hidden text-center py-8 text-gray-500">
                            <div class="text-4xl mb-2">üîç</div>
                            <p class="text-sm">Tidak ada data yang cocok dengan pencarian</p>
                            <p class="text-xs mt-1">Coba kata kunci lain atau <button onclick="clearPlastikSearch()" class="text-orange-500 hover:text-orange-700 underline">hapus pencarian</button></p>
                        </div>
                        
                        <!-- Kontrol Buttons -->
                        <div class="space-y-4">
                            <!-- Navigasi Data -->
                            <div>
                                <h5 class="text-sm font-medium text-gray-700 mb-2">üìç Navigasi Data:</h5>
                                <div class="grid grid-cols-2 gap-2">
                                    <button onclick="firstPlastikRecord()" class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-2 rounded-lg text-xs transition-colors">
                                        ‚èÆÔ∏è Pertama
                                    </button>
                                    <button onclick="previousPlastikRecord()" class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-2 rounded-lg text-xs transition-colors">
                                        ‚è™ Sebelum
                                    </button>
                                    <button onclick="nextPlastikRecord()" class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-2 rounded-lg text-xs transition-colors">
                                        ‚è© Sesudah
                                    </button>
                                    <button onclick="lastPlastikRecord()" class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-2 rounded-lg text-xs transition-colors">
                                        ‚è≠Ô∏è Terakhir
                                    </button>
                                </div>
                            </div>
                            
                            <!-- Aksi Data -->
                            <div>
                                <h5 class="text-sm font-medium text-gray-700 mb-2">üíæ Aksi Data:</h5>
                                <div class="space-y-2">
                                    <button onclick="savePlastikRecord()" class="w-full bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg text-xs transition-colors">
                                        üíæ Simpan Data
                                    </button>
                                    <button onclick="newPlastikRecord()" class="w-full bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg text-xs transition-colors">
                                        ‚ûï Data Baru
                                    </button>
                                    <button onclick="deletePlastikRecord()" class="w-full bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg text-xs transition-colors">
                                        üóëÔ∏è Hapus Data
                                    </button>
                                    <button onclick="refreshPlastikData()" class="w-full bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg text-xs transition-colors">
                                        üîÑ Refresh
                                    </button>
                                </div>
                            </div>
                            
                            <!-- Menu Navigation -->
                            <div>
                                <h5 class="text-sm font-medium text-gray-700 mb-2">üè† Menu:</h5>
                                <button onclick="closePlastikSizeInput()" class="w-full bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg text-xs transition-colors">
                                    üîô Kembali ke Belangko
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Form Nota Modal -->
    <div id="notaModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto">
            <div class="bg-purple-600 text-white p-4 rounded-t-xl">
                <h3 class="text-xl font-semibold flex items-center justify-between">
                    üßæ Form Nota Digital
                    <button onclick="closeNotaForm()" class="text-white hover:text-gray-200 text-2xl">&times;</button>
                </h3>
            </div>
            
            <div class="p-6">
                <!-- Input Form -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                    <!-- Customer Info -->
                    <div class="space-y-4">
                        <h4 class="text-lg font-semibold text-gray-800 border-b pb-2">Informasi Pelanggan</h4>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Nama Pelanggan</label>
                            <input type="text" id="customerName" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500" placeholder="Masukkan nama pelanggan">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Nomor Telepon</label>
                            <input type="tel" id="customerPhone" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500" placeholder="Masukkan nomor telepon">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Alamat</label>
                            <textarea id="customerAddress" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500" placeholder="Masukkan alamat pelanggan"></textarea>
                        </div>
                        
                        <!-- No Results Message -->
                        <div id="noUangResultsMessage" class="hidden text-center py-8 text-gray-500">
                            <div class="text-4xl mb-2">üìÖ</div>
                            <p class="text-sm">Tidak ada data yang cocok dengan tanggal pencarian</p>
                            <p class="text-xs mt-1">Coba tanggal lain atau <button onclick="clearUangSearch()" class="text-blue-500 hover:text-blue-700 underline">hapus pencarian</button></p>
                        </div>
                    </div>
                    
                    <!-- Order Items -->
                    <div class="space-y-4">
                        <h4 class="text-lg font-semibold text-gray-800 border-b pb-2">Item Pesanan</h4>
                        <div id="orderItems">
                            <div class="order-item grid grid-cols-4 gap-2 mb-2">
                                <input type="number" placeholder="Qty" class="px-2 py-1 border rounded text-sm qty-input">
                                <input type="text" placeholder="Nama Barang" class="px-2 py-1 border rounded text-sm item-name">
                                <input type="number" placeholder="Harga" class="px-2 py-1 border rounded text-sm item-price">
                                <input type="number" placeholder="Total" class="px-2 py-1 border rounded text-sm bg-gray-100" readonly>
                            </div>
                        </div>
                        <button onclick="addOrderItem()" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg text-sm">
                            ‚ûï Tambah Item
                        </button>
                        
                        <!-- Payment Info -->
                        <div class="mt-4 space-y-2">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Uang Muka (DP)</label>
                                <input type="number" id="downPayment" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500" placeholder="0">
                            </div>
                        </div>
                        
                        <!-- No Results Message -->
                        <div id="noUangResultsMessage" class="hidden text-center py-8 text-gray-500">
                            <div class="text-4xl mb-2">üìÖ</div>
                            <p class="text-sm">Tidak ada data yang cocok dengan tanggal pencarian</p>
                            <p class="text-xs mt-1">Coba tanggal lain atau <button onclick="clearUangSearch()" class="text-blue-500 hover:text-blue-700 underline">hapus pencarian</button></p>
                        </div>
                    </div>
                </div>
                
                <!-- Generate Button -->
                <div class="text-center mb-6">
                    <button onclick="generateNota()" class="bg-purple-600 hover:bg-purple-700 text-white px-8 py-3 rounded-lg font-semibold text-lg shadow-lg">
                        üìÑ Generate Nota
                    </button>
                </div>
                
                <!-- Nota Preview -->
                <div id="notaPreview" class="hidden">
                    <div class="bg-white border-2 border-gray-300 rounded-lg p-6 max-w-2xl mx-auto" id="notaContent">
                        <!-- Nota content will be generated here -->
                    </div>
                    
                    <!-- Print Button -->
                    <div class="text-center mt-4">
                        <button onclick="printNota()" class="bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded-lg font-semibold">
                            üñ®Ô∏è Print Nota
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Sample data untuk simulasi
        let kertasData = [
            {no: 1, harga_kertas: 15000, nama_kertas: "HVS A4", ukuran_lebar: 21, ukuran_panjang: 29.7},
            {no: 2, harga_kertas: 25000, nama_kertas: "Art Paper A4", ukuran_lebar: 21, ukuran_panjang: 29.7},
            {no: 3, harga_kertas: 12000, nama_kertas: "HVS A3", ukuran_lebar: 29.7, ukuran_panjang: 42},
            {no: 4, harga_kertas: 35000, nama_kertas: "Ivory 230gsm", ukuran_lebar: 21, ukuran_panjang: 29.7},
            {no: 5, harga_kertas: 18000, nama_kertas: "Manila Card", ukuran_lebar: 21, ukuran_panjang: 29.7}
        ];
        
        // Sample data untuk produk
        let produkData = [
            {no: 1, nama_bahan: "Tinta Hitam Canon", harga: 85000, nama_pemesan: "Budi Santoso"},
            {no: 2, nama_bahan: "Tinta Warna Epson", harga: 120000, nama_pemesan: "Siti Aminah"},
            {no: 3, nama_bahan: "Kertas Photo Glossy", harga: 45000, nama_pemesan: "Ahmad Rizki"},
            {no: 4, nama_bahan: "Laminating Film A4", harga: 35000, nama_pemesan: "Maya Sari"},
            {no: 5, nama_bahan: "Spiral Binding", harga: 15000, nama_pemesan: "Dedi Kurniawan"}
        ];
        
        let currentRecordIndex = 0;
        let originalData = {};
        let currentProdukRecordIndex = 0;
        let originalProdukData = {};

        // Fungsi untuk membuka form Harga Kertas
        function openHargaKertasForm() {
            document.getElementById('hargaKertasModal').classList.remove('hidden');
            loadRecord(currentRecordIndex);
            refreshTable();
        }

        // Fungsi untuk menutup form
        function closeHargaKertasForm() {
            document.getElementById('hargaKertasModal').classList.add('hidden');
        }

        // Fungsi untuk memuat data ke form
        function loadRecord(index) {
            if (index >= 0 && index < kertasData.length) {
                const data = kertasData[index];
                document.getElementById('no').value = data.no;
                document.getElementById('harga_kertas').value = data.harga_kertas;
                document.getElementById('nama_kertas').value = data.nama_kertas;
                document.getElementById('ukuran_lebar').value = data.ukuran_lebar;
                document.getElementById('ukuran_panjang').value = data.ukuran_panjang;
                
                // Simpan data asli untuk undo
                originalData = {...data};
                
                // Update info record
                document.getElementById('currentRecord').textContent = index + 1;
                document.getElementById('totalRecords').textContent = kertasData.length;
            }
        }

        // Record Navigation Functions
        function firstRecord() {
            currentRecordIndex = 0;
            loadRecord(currentRecordIndex);
        }

        function previousRecord() {
            if (currentRecordIndex > 0) {
                currentRecordIndex--;
                loadRecord(currentRecordIndex);
            }
        }

        function nextRecord() {
            if (currentRecordIndex < kertasData.length - 1) {
                currentRecordIndex++;
                loadRecord(currentRecordIndex);
            }
        }

        function lastRecord() {
            currentRecordIndex = kertasData.length - 1;
            loadRecord(currentRecordIndex);
        }

        // Data Control Functions
        function undoRecord() {
            loadRecord(currentRecordIndex);
            alert('Data dikembalikan ke kondisi semula');
        }

        function saveRecord() {
            const formData = {
                no: parseInt(document.getElementById('no').value),
                harga_kertas: parseInt(document.getElementById('harga_kertas').value),
                nama_kertas: document.getElementById('nama_kertas').value,
                ukuran_lebar: parseFloat(document.getElementById('ukuran_lebar').value),
                ukuran_panjang: parseFloat(document.getElementById('ukuran_panjang').value)
            };
            
            // Update data array
            kertasData[currentRecordIndex] = formData;
            refreshTable();
            alert('Data berhasil disimpan!');
        }

        function refreshData() {
            loadRecord(currentRecordIndex);
            refreshTable();
            alert('Data berhasil di-refresh');
        }

        // Fungsi untuk me-refresh tabel
        function refreshTable() {
            const tableBody = document.getElementById('kertasTableBody');
            tableBody.innerHTML = '';
            
            kertasData.forEach((data, index) => {
                const row = document.createElement('tr');
                row.className = index === currentRecordIndex ? 'bg-green-50' : 'hover:bg-gray-50';
                
                row.innerHTML = `
                    <td class="border border-gray-300 px-3 py-2 font-medium">${data.no}</td>
                    <td class="border border-gray-300 px-3 py-2">Rp ${data.harga_kertas.toLocaleString('id-ID')}</td>
                    <td class="border border-gray-300 px-3 py-2">${data.nama_kertas}</td>
                    <td class="border border-gray-300 px-3 py-2 text-center">${data.ukuran_lebar}</td>
                    <td class="border border-gray-300 px-3 py-2 text-center">${data.ukuran_panjang}</td>
                    <td class="border border-gray-300 px-3 py-2 text-center">
                        <button onclick="selectRecord(${index})" class="bg-blue-500 hover:bg-blue-600 text-white px-2 py-1 rounded text-xs transition-colors">
                            Pilih
                        </button>
                        <button onclick="deleteRecord(${index})" class="bg-red-500 hover:bg-red-600 text-white px-2 py-1 rounded text-xs ml-1 transition-colors">
                            Hapus
                        </button>
                    </td>
                `;
                
                tableBody.appendChild(row);
            });
        }

        // Fungsi untuk memilih record dari tabel
        function selectRecord(index) {
            currentRecordIndex = index;
            loadRecord(currentRecordIndex);
            refreshTable();
        }

        // Fungsi untuk menghapus record
        function deleteRecord(index) {
            if (confirm('Apakah Anda yakin ingin menghapus data ini?')) {
                kertasData.splice(index, 1);
                
                // Update nomor urut
                kertasData.forEach((item, idx) => {
                    item.no = idx + 1;
                });
                
                // Adjust current record index
                if (currentRecordIndex >= kertasData.length) {
                    currentRecordIndex = kertasData.length - 1;
                }
                if (currentRecordIndex < 0) currentRecordIndex = 0;
                
                loadRecord(currentRecordIndex);
                refreshTable();
                alert('Data berhasil dihapus!');
            }
        }

        // Fungsi untuk menghapus record yang sedang aktif
        function deleteCurrentRecord() {
            // Cek apakah ada data
            if (!kertasData || kertasData.length === 0) {
                alert('Tidak ada data untuk dihapus!');
                return;
            }
            
            // Cek apakah currentRecordIndex valid
            if (currentRecordIndex < 0 || currentRecordIndex >= kertasData.length) {
                alert('Record tidak valid!');
                return;
            }
            
            const currentData = kertasData[currentRecordIndex];
            const confirmMessage = `Apakah Anda yakin ingin menghapus data:\n\n"${currentData.nama_kertas}"\nHarga: Rp ${currentData.harga_kertas.toLocaleString('id-ID')}\nUkuran: ${currentData.ukuran_lebar} x ${currentData.ukuran_panjang} cm?`;
            
            if (confirm(confirmMessage)) {
                // Simpan nama data yang dihapus untuk pesan konfirmasi
                const deletedName = currentData.nama_kertas;
                
                // Hapus record yang sedang aktif
                kertasData.splice(currentRecordIndex, 1);
                
                // Update nomor urut untuk semua data yang tersisa
                kertasData.forEach((item, idx) => {
                    item.no = idx + 1;
                });
                
                // Sesuaikan currentRecordIndex setelah penghapusan
                if (kertasData.length > 0) {
                    // Jika masih ada data
                    if (currentRecordIndex >= kertasData.length) {
                        currentRecordIndex = kertasData.length - 1;
                    }
                    // Load record yang baru
                    loadRecord(currentRecordIndex);
                } else {
                    // Jika semua data sudah habis
                    currentRecordIndex = 0;
                    // Kosongkan form
                    document.getElementById('no').value = '';
                    document.getElementById('harga_kertas').value = '';
                    document.getElementById('nama_kertas').value = '';
                    document.getElementById('ukuran_lebar').value = '';
                    document.getElementById('ukuran_panjang').value = '';
                    document.getElementById('currentRecord').textContent = '0';
                    document.getElementById('totalRecords').textContent = '0';
                }
                
                // Refresh tabel untuk menampilkan perubahan
                refreshTable();
                
                // Tampilkan pesan konfirmasi
                alert(`Data "${deletedName}" berhasil dihapus!\n\nDatabase telah diperbarui.`);
            }
        }

        // Fungsi untuk membuat record baru
        function newRecord() {
            const newNo = kertasData.length > 0 ? Math.max(...kertasData.map(item => item.no)) + 1 : 1;
            
            const newData = {
                no: newNo,
                harga_kertas: 0,
                nama_kertas: '',
                ukuran_lebar: 0,
                ukuran_panjang: 0
            };
            
            kertasData.push(newData);
            currentRecordIndex = kertasData.length - 1;
            
            loadRecord(currentRecordIndex);
            refreshTable();
            
            // Focus pada field pertama yang bisa diedit
            document.getElementById('harga_kertas').focus();
            
            alert('Record baru telah dibuat! Silakan isi data dan klik Save.');
        }

        // Nota Functions
        function openNotaForm() {
            document.getElementById('notaModal').classList.remove('hidden');
            document.getElementById('notaPreview').classList.add('hidden');
        }

        function closeNotaForm() {
            document.getElementById('notaModal').classList.add('hidden');
        }

        function addOrderItem() {
            const orderItems = document.getElementById('orderItems');
            const newItem = document.createElement('div');
            newItem.className = 'order-item grid grid-cols-4 gap-2 mb-2';
            newItem.innerHTML = `
                <input type="number" placeholder="Qty" class="px-2 py-1 border rounded text-sm qty-input">
                <input type="text" placeholder="Nama Barang" class="px-2 py-1 border rounded text-sm item-name">
                <input type="number" placeholder="Harga" class="px-2 py-1 border rounded text-sm item-price">
                <input type="number" placeholder="Total" class="px-2 py-1 border rounded text-sm bg-gray-100" readonly>
            `;
            orderItems.appendChild(newItem);
            
            // Add event listeners for automatic calculation
            const qtyInput = newItem.querySelector('.qty-input');
            const priceInput = newItem.querySelector('.item-price');
            const totalInput = newItem.querySelector('input[readonly]');
            
            function calculateTotal() {
                const qty = parseFloat(qtyInput.value) || 0;
                const price = parseFloat(priceInput.value) || 0;
                totalInput.value = qty * price;
            }
            
            qtyInput.addEventListener('input', calculateTotal);
            priceInput.addEventListener('input', calculateTotal);
        }

        function generateNota() {
            const customerName = document.getElementById('customerName').value;
            const customerPhone = document.getElementById('customerPhone').value;
            const customerAddress = document.getElementById('customerAddress').value;
            const downPayment = parseFloat(document.getElementById('downPayment').value) || 0;
            
            if (!customerName) {
                alert('Nama pelanggan harus diisi!');
                return;
            }
            
            // Get order items
            const orderItems = document.querySelectorAll('.order-item');
            let itemsHtml = '';
            let grandTotal = 0;
            
            orderItems.forEach(item => {
                const qty = item.querySelector('.qty-input').value;
                const name = item.querySelector('.item-name').value;
                const price = parseFloat(item.querySelector('.item-price').value) || 0;
                const total = parseFloat(item.querySelector('input[readonly]').value) || 0;
                
                if (qty && name && price) {
                    itemsHtml += `
                        <tr>
                            <td class="border border-gray-300 px-3 py-2 text-center">${qty}</td>
                            <td class="border border-gray-300 px-3 py-2">${name}</td>
                            <td class="border border-gray-300 px-3 py-2 text-right">Rp ${price.toLocaleString('id-ID')}</td>
                            <td class="border border-gray-300 px-3 py-2 text-right">Rp ${total.toLocaleString('id-ID')}</td>
                        </tr>
                    `;
                    grandTotal += total;
                }
            });
            
            if (!itemsHtml) {
                alert('Minimal satu item pesanan harus diisi!');
                return;
            }
            
            const remainingBalance = grandTotal - downPayment;
            const currentDate = new Date().toLocaleDateString('id-ID');
            const notaNumber = 'NOTA-' + Date.now().toString().slice(-6);
            
            const notaHtml = `
                <div class="text-center mb-6">
                    <h1 class="text-2xl font-bold text-blue-800 mb-2">MUSADAD.COM PERCETAKAN</h1>
                    <p class="text-sm text-gray-600">Jl. Contoh No. 123, Kota, Provinsi</p>
                    <p class="text-sm text-gray-600">Telp: (021) 1234-5678 | Email: info@musadad.com</p>
                    <hr class="my-4 border-gray-300">
                </div>
                
                <div class="grid grid-cols-2 gap-4 mb-6">
                    <div>
                        <p class="text-sm"><strong>Tanggal:</strong> ${currentDate}</p>
                        <p class="text-sm"><strong>No. Nota:</strong> ${notaNumber}</p>
                    </div>
                    <div>
                        <p class="text-sm"><strong>Nama:</strong> ${customerName}</p>
                        <p class="text-sm"><strong>Telp:</strong> ${customerPhone}</p>
                        <p class="text-sm"><strong>Alamat:</strong> ${customerAddress}</p>
                    </div>
                </div>
                
                <table class="w-full border-collapse border border-gray-300 mb-6">
                    <thead>
                        <tr class="bg-gray-100">
                            <th class="border border-gray-300 px-3 py-2 text-center font-semibold">Banyak</th>
                            <th class="border border-gray-300 px-3 py-2 text-left font-semibold">Nama Barang</th>
                            <th class="border border-gray-300 px-3 py-2 text-right font-semibold">Harga</th>
                            <th class="border border-gray-300 px-3 py-2 text-right font-semibold">Jumlah</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${itemsHtml}
                    </tbody>
                </table>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                    <div class="bg-blue-50 p-4 rounded-lg">
                        <h3 class="font-semibold text-lg mb-3">Ringkasan Pembayaran</h3>
                        <div class="space-y-2">
                            <div class="flex justify-between">
                                <span>Total Biaya:</span>
                                <span class="font-semibold">Rp ${grandTotal.toLocaleString('id-ID')}</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Uang Muka (DP):</span>
                                <span class="font-semibold">Rp ${downPayment.toLocaleString('id-ID')}</span>
                            </div>
                            <hr class="border-gray-300">
                            <div class="flex justify-between text-lg font-bold">
                                <span>Sisa Tagihan:</span>
                                <span class="text-red-600">Rp ${remainingBalance.toLocaleString('id-ID')}</span>
                            </div>
                        </div>
                        
                        <!-- No Results Message -->
                        <div id="noUangResultsMessage" class="hidden text-center py-8 text-gray-500">
                            <div class="text-4xl mb-2">üìÖ</div>
                            <p class="text-sm">Tidak ada data yang cocok dengan tanggal pencarian</p>
                            <p class="text-xs mt-1">Coba tanggal lain atau <button onclick="clearUangSearch()" class="text-blue-500 hover:text-blue-700 underline">hapus pencarian</button></p>
                        </div>
                    </div>
                    
                    <div class="bg-red-50 p-4 rounded-lg">
                        <h3 class="font-semibold text-lg mb-3 text-red-600">‚ö†Ô∏è PERHATIAN!!!</h3>
                        <ul class="text-sm space-y-1 text-red-700">
                            <li>‚Ä¢ Barang yang sudah dicetak tidak dapat dikembalikan</li>
                            <li>‚Ä¢ Penukaran hanya berlaku jika ada kesalahan dari pihak percetakan</li>
                            <li>‚Ä¢ Komplain maksimal 3 hari setelah barang diterima</li>
                            <li>‚Ä¢ Simpan nota ini sebagai bukti transaksi</li>
                        </ul>
                    </div>
                </div>
                
                <div class="bg-green-50 p-4 rounded-lg">
                    <h3 class="font-semibold text-lg mb-3 text-green-700">üí≥ Informasi Pembayaran</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                        <div>
                            <p><strong>Bank BCA:</strong></p>
                            <p>No. Rek: 1234567890</p>
                            <p>A.n: MUSADAD PERCETAKAN</p>
                        </div>
                        <div>
                            <p><strong>Bank Mandiri:</strong></p>
                            <p>No. Rek: 0987654321</p>
                            <p>A.n: MUSADAD PERCETAKAN</p>
                        </div>
                        
                        <!-- No Results Message -->
                        <div id="noUangResultsMessage" class="hidden text-center py-8 text-gray-500">
                            <div class="text-4xl mb-2">üìÖ</div>
                            <p class="text-sm">Tidak ada data yang cocok dengan tanggal pencarian</p>
                            <p class="text-xs mt-1">Coba tanggal lain atau <button onclick="clearUangSearch()" class="text-blue-500 hover:text-blue-700 underline">hapus pencarian</button></p>
                        </div>
                    </div>
                </div>
                
                <div class="text-center mt-6 pt-4 border-t border-gray-300">
                    <p class="text-sm text-gray-600">Terima kasih atas kepercayaan Anda!</p>
                    <p class="text-xs text-gray-500 mt-2">Nota ini dibuat secara otomatis oleh sistem MUSADAD.COM</p>
                </div>
            `;
            
            document.getElementById('notaContent').innerHTML = notaHtml;
            document.getElementById('notaPreview').classList.remove('hidden');
        }

        function printNota() {
            // Show preview modal first
            showPrintPreview();
        }

        function showPrintPreview() {
            const notaContent = document.getElementById('notaContent').innerHTML;
            
            // Create preview modal
            const previewModal = document.createElement('div');
            previewModal.id = 'printPreviewModal';
            previewModal.className = 'fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4';
            
            previewModal.innerHTML = `
                <div class="bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto">
                    <div class="bg-blue-600 text-white p-4 rounded-t-xl flex justify-between items-center">
                        <h3 class="text-xl font-semibold">üìÑ Preview Nota A5 - Siap Print</h3>
                        <button onclick="closePrintPreview()" class="text-white hover:text-gray-200 text-2xl">&times;</button>
                    </div>
                    
                    <div class="p-6">
                        <div class="mb-4 text-center">
                            <p class="text-gray-600 mb-4">Preview nota dalam format A5. Periksa semua data sebelum mencetak.</p>
                            <div class="flex justify-center gap-4 mb-6">
                                <button onclick="proceedToPrint()" class="bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded-lg font-semibold shadow-lg">
                                    üñ®Ô∏è Lanjut Print A5
                                </button>
                                <button onclick="closePrintPreview()" class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-3 rounded-lg font-semibold shadow-lg">
                                    ‚ùå Batal
                                </button>
                            </div>
                        </div>
                        
                        <!-- Preview Container with A5 styling -->
                        <div class="border-2 border-gray-300 rounded-lg p-6 bg-white mx-auto" style="width: 420px; min-height: 594px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                            <div id="previewContent" style="font-size: 11px; line-height: 1.3;">
                                ${generateA5NotaContent()}
                            </div>
                        </div>
                        
                        <div class="mt-6 text-center">
                            <p class="text-sm text-gray-500">Ukuran: A5 (148mm x 210mm) | Font: Optimized untuk print</p>
                        </div>
                        
                        <!-- No Results Message -->
                        <div id="noUangResultsMessage" class="hidden text-center py-8 text-gray-500">
                            <div class="text-4xl mb-2">üìÖ</div>
                            <p class="text-sm">Tidak ada data yang cocok dengan tanggal pencarian</p>
                            <p class="text-xs mt-1">Coba tanggal lain atau <button onclick="clearUangSearch()" class="text-blue-500 hover:text-blue-700 underline">hapus pencarian</button></p>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(previewModal);
        }

        function closePrintPreview() {
            const modal = document.getElementById('printPreviewModal');
            if (modal) {
                modal.remove();
            }
        }

        function proceedToPrint() {
            const printWindow = window.open('', '_blank', 'width=600,height=800');
            printWindow.document.write(`
                <html>
                <head>
                    <title>Nota A5 - MUSADAD.COM</title>
                    <style>
                        @page {
                            size: A5;
                            margin: 10mm;
                        }
                        body { 
                            font-family: Arial, sans-serif; 
                            margin: 0;
                            padding: 10px;
                            font-size: 11px;
                            line-height: 1.3;
                            width: 148mm;
                            max-width: 148mm;
                        }
                        h1 { 
                            font-size: 16px; 
                            margin: 0 0 5px 0; 
                            color: #1e40af;
                        }
                        h3 { 
                            font-size: 12px; 
                            margin: 8px 0 4px 0; 
                        }
                        p { 
                            margin: 2px 0; 
                            font-size: 10px;
                        }
                        table { 
                            border-collapse: collapse; 
                            width: 100%; 
                            margin: 8px 0;
                            font-size: 10px;
                        }
                        th, td { 
                            border: 1px solid #333; 
                            padding: 4px; 
                            text-align: left; 
                        }
                        th { 
                            background-color: #f0f0f0; 
                            font-weight: bold;
                            font-size: 9px;
                        }
                        .text-center { text-align: center; }
                        .text-right { text-align: right; }
                        .font-bold { font-weight: bold; }
                        .text-red-600 { color: #dc2626; }
                        .text-green-700 { color: #15803d; }
                        .payment-summary { 
                            background-color: #f8fafc; 
                            padding: 8px; 
                            margin: 6px 0;
                            border: 1px solid #e2e8f0;
                            border-radius: 4px;
                        }
                        .warning-box { 
                            background-color: #fef2f2; 
                            padding: 8px; 
                            margin: 6px 0;
                            border: 1px solid #fecaca;
                            border-radius: 4px;
                        }
                        .bank-info { 
                            background-color: #f0fdf4; 
                            padding: 8px; 
                            margin: 6px 0;
                            border: 1px solid #bbf7d0;
                            border-radius: 4px;
                        }
                        .grid-2 {
                            display: grid;
                            grid-template-columns: 1fr 1fr;
                            gap: 8px;
                        }
                        .header-info {
                            display: grid;
                            grid-template-columns: 1fr 1fr;
                            gap: 10px;
                            margin-bottom: 10px;
                        }
                        hr { 
                            border: none; 
                            border-top: 1px solid #ccc; 
                            margin: 8px 0; 
                        }
                        ul {
                            margin: 4px 0;
                            padding-left: 15px;
                        }
                        li {
                            margin: 1px 0;
                            font-size: 9px;
                        }
                        @media print {
                            body { 
                                margin: 0;
                                padding: 5mm;
                            }
                            .no-print { display: none; }
                        }
                    </style>
                </head>
                <body>
                    <div class="text-center" style="margin-bottom: 15px;">
                        <h1>MUSADAD.COM PERCETAKAN</h1>
                        <p>Jl. Contoh No. 123, Kota, Provinsi</p>
                        <p>Telp: (021) 1234-5678 | Email: info@musadad.com</p>
                        <hr>
                    </div>
                    
                    <div class="header-info">
                        <div>
                            <p><strong>Tanggal:</strong> ${new Date().toLocaleDateString('id-ID')}</p>
                            <p><strong>No. Nota:</strong> NOTA-${Date.now().toString().slice(-6)}</p>
                        </div>
                        <div>
                            <p><strong>Nama:</strong> ${document.getElementById('customerName').value}</p>
                            <p><strong>Telp:</strong> ${document.getElementById('customerPhone').value}</p>
                            <p><strong>Alamat:</strong> ${document.getElementById('customerAddress').value}</p>
                        </div>
                        
                        <!-- No Results Message -->
                        <div id="noUangResultsMessage" class="hidden text-center py-8 text-gray-500">
                            <div class="text-4xl mb-2">üìÖ</div>
                            <p class="text-sm">Tidak ada data yang cocok dengan tanggal pencarian</p>
                            <p class="text-xs mt-1">Coba tanggal lain atau <button onclick="clearUangSearch()" class="text-blue-500 hover:text-blue-700 underline">hapus pencarian</button></p>
                        </div>
                    </div>
                    
                    ${generateOrderTable()}
                    
                    <div class="payment-summary">
                        <h3>üí∞ Ringkasan Pembayaran</h3>
                        ${generatePaymentSummary()}
                    </div>
                    
                    <div class="warning-box">
                        <h3 style="color: #dc2626;">‚ö†Ô∏è PERHATIAN!!!</h3>
                        <ul style="color: #dc2626;">
                            <li>Barang yang sudah dicetak tidak dapat dikembalikan</li>
                            <li>Penukaran hanya berlaku jika ada kesalahan dari pihak percetakan</li>
                            <li>Komplain maksimal 3 hari setelah barang diterima</li>
                            <li>Simpan nota ini sebagai bukti transaksi</li>
                        </ul>
                    </div>
                    
                    <div class="bank-info">
                        <h3 style="color: #15803d;">üí≥ Informasi Pembayaran</h3>
                        <div class="grid-2">
                            <div>
                                <p><strong>Bank BCA:</strong></p>
                                <p>No. Rek: 1234567890</p>
                                <p>A.n: MUSADAD PERCETAKAN</p>
                            </div>
                            <div>
                                <p><strong>Bank Mandiri:</strong></p>
                                <p>No. Rek: 0987654321</p>
                                <p>A.n: MUSADAD PERCETAKAN</p>
                            </div>
                        </div>
                        
                        <!-- No Results Message -->
                        <div id="noUangResultsMessage" class="hidden text-center py-8 text-gray-500">
                            <div class="text-4xl mb-2">üìÖ</div>
                            <p class="text-sm">Tidak ada data yang cocok dengan tanggal pencarian</p>
                            <p class="text-xs mt-1">Coba tanggal lain atau <button onclick="clearUangSearch()" class="text-blue-500 hover:text-blue-700 underline">hapus pencarian</button></p>
                        </div>
                    </div>
                    
                    <div class="text-center" style="margin-top: 15px; padding-top: 8px; border-top: 1px solid #ccc;">
                        <p><strong>Terima kasih atas kepercayaan Anda!</strong></p>
                        <p style="font-size: 8px; color: #666;">Nota ini dibuat secara otomatis oleh sistem MUSADAD.COM</p>
                    </div>
                    
                    <div class="no-print" style="text-align: center; margin-top: 20px; padding: 10px; background-color: #f0f9ff; border: 1px solid #0ea5e9; border-radius: 8px;">
                        <p style="margin: 5px 0; color: #0369a1;"><strong>üìÑ Print Preview - Format A5</strong></p>
                        <button onclick="window.print()" style="background-color: #0ea5e9; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; margin: 5px;">
                            üñ®Ô∏è Print Sekarang
                        </button>
                        <button onclick="window.close()" style="background-color: #6b7280; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; margin: 5px;">
                            ‚ùå Tutup
                        </button>
                    </div>
                </body>
                </html>
            `);
            printWindow.document.close();
            
            // Auto focus on print window
            printWindow.focus();
            
            // Close preview modal after printing
            closePrintPreview();
        }

        function generateA5NotaContent() {
            const customerName = document.getElementById('customerName').value;
            const customerPhone = document.getElementById('customerPhone').value;
            const customerAddress = document.getElementById('customerAddress').value;
            const downPayment = parseFloat(document.getElementById('downPayment').value) || 0;
            const currentDate = new Date().toLocaleDateString('id-ID');
            const notaNumber = 'NOTA-' + Date.now().toString().slice(-6);
            
            // Calculate totals
            const orderItems = document.querySelectorAll('.order-item');
            let itemsHtml = '';
            let grandTotal = 0;
            
            orderItems.forEach(item => {
                const qty = item.querySelector('.qty-input').value;
                const name = item.querySelector('.item-name').value;
                const price = parseFloat(item.querySelector('.item-price').value) || 0;
                const total = parseFloat(item.querySelector('input[readonly]').value) || 0;
                
                if (qty && name && price) {
                    itemsHtml += `
                        <tr>
                            <td style="border: 1px solid #333; padding: 4px; text-align: center; font-size: 10px;">${qty}</td>
                            <td style="border: 1px solid #333; padding: 4px; font-size: 10px;">${name}</td>
                            <td style="border: 1px solid #333; padding: 4px; text-align: right; font-size: 10px;">Rp ${price.toLocaleString('id-ID')}</td>
                            <td style="border: 1px solid #333; padding: 4px; text-align: right; font-size: 10px;">Rp ${total.toLocaleString('id-ID')}</td>
                        </tr>
                    `;
                    grandTotal += total;
                }
            });
            
            const remainingBalance = grandTotal - downPayment;
            
            return `
                <div style="text-align: center; margin-bottom: 15px;">
                    <h1 style="font-size: 16px; margin: 0 0 5px 0; color: #1e40af; font-weight: bold;">MUSADAD.COM PERCETAKAN</h1>
                    <p style="font-size: 10px; margin: 2px 0;">Jl. Contoh No. 123, Kota, Provinsi</p>
                    <p style="font-size: 10px; margin: 2px 0;">Telp: (021) 1234-5678 | Email: info@musadad.com</p>
                    <hr style="border: none; border-top: 1px solid #ccc; margin: 8px 0;">
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 10px;">
                    <div>
                        <p style="font-size: 10px; margin: 2px 0;"><strong>Tanggal:</strong> ${currentDate}</p>
                        <p style="font-size: 10px; margin: 2px 0;"><strong>No. Nota:</strong> ${notaNumber}</p>
                    </div>
                    <div>
                        <p style="font-size: 10px; margin: 2px 0;"><strong>Nama:</strong> ${customerName}</p>
                        <p style="font-size: 10px; margin: 2px 0;"><strong>Telp:</strong> ${customerPhone}</p>
                        <p style="font-size: 10px; margin: 2px 0;"><strong>Alamat:</strong> ${customerAddress}</p>
                    </div>
                </div>
                
                <table style="border-collapse: collapse; width: 100%; margin: 8px 0; font-size: 10px;">
                    <thead>
                        <tr style="background-color: #f0f0f0;">
                            <th style="border: 1px solid #333; padding: 4px; text-align: center; font-weight: bold; font-size: 9px;">Banyak</th>
                            <th style="border: 1px solid #333; padding: 4px; text-align: left; font-weight: bold; font-size: 9px;">Nama Barang</th>
                            <th style="border: 1px solid #333; padding: 4px; text-align: right; font-weight: bold; font-size: 9px;">Harga</th>
                            <th style="border: 1px solid #333; padding: 4px; text-align: right; font-weight: bold; font-size: 9px;">Jumlah</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${itemsHtml}
                    </tbody>
                </table>
                
                <div style="background-color: #f8fafc; padding: 8px; margin: 6px 0; border: 1px solid #e2e8f0; border-radius: 4px;">
                    <h3 style="font-size: 12px; margin: 8px 0 4px 0;">üí∞ Ringkasan Pembayaran</h3>
                    <div style="display: grid; grid-template-columns: 1fr auto; gap: 10px; align-items: center;">
                        <span style="font-size: 10px;">Total Biaya:</span>
                        <span style="font-weight: bold; font-size: 10px;">Rp ${grandTotal.toLocaleString('id-ID')}</span>
                        <span style="font-size: 10px;">Uang Muka (DP):</span>
                        <span style="font-weight: bold; font-size: 10px;">Rp ${downPayment.toLocaleString('id-ID')}</span>
                        <hr style="grid-column: 1 / -1; margin: 4px 0; border: none; border-top: 1px solid #ccc;">
                        <span style="font-weight: bold; font-size: 10px;">Sisa Tagihan:</span>
                        <span style="font-weight: bold; color: #dc2626; font-size: 10px;">Rp ${remainingBalance.toLocaleString('id-ID')}</span>
                    </div>
                </div>
                
                <div style="background-color: #fef2f2; padding: 8px; margin: 6px 0; border: 1px solid #fecaca; border-radius: 4px;">
                    <h3 style="color: #dc2626; font-size: 12px; margin: 8px 0 4px 0;">‚ö†Ô∏è PERHATIAN!!!</h3>
                    <ul style="color: #dc2626; margin: 4px 0; padding-left: 15px;">
                        <li style="margin: 1px 0; font-size: 9px;">Barang yang sudah dicetak tidak dapat dikembalikan</li>
                        <li style="margin: 1px 0; font-size: 9px;">Penukaran hanya berlaku jika ada kesalahan dari pihak percetakan</li>
                        <li style="margin: 1px 0; font-size: 9px;">Komplain maksimal 3 hari setelah barang diterima</li>
                        <li style="margin: 1px 0; font-size: 9px;">Simpan nota ini sebagai bukti transaksi</li>
                    </ul>
                </div>
                
                <div style="background-color: #f0fdf4; padding: 8px; margin: 6px 0; border: 1px solid #bbf7d0; border-radius: 4px;">
                    <h3 style="color: #15803d; font-size: 12px; margin: 8px 0 4px 0;">üí≥ Informasi Pembayaran</h3>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px;">
                        <div>
                            <p style="font-size: 10px; margin: 2px 0;"><strong>Bank BCA:</strong></p>
                            <p style="font-size: 10px; margin: 2px 0;">No. Rek: 1234567890</p>
                            <p style="font-size: 10px; margin: 2px 0;">A.n: MUSADAD PERCETAKAN</p>
                        </div>
                        <div>
                            <p style="font-size: 10px; margin: 2px 0;"><strong>Bank Mandiri:</strong></p>
                            <p style="font-size: 10px; margin: 2px 0;">No. Rek: 0987654321</p>
                            <p style="font-size: 10px; margin: 2px 0;">A.n: MUSADAD PERCETAKAN</p>
                        </div>
                        
                        <!-- No Results Message -->
                        <div id="noUangResultsMessage" class="hidden text-center py-8 text-gray-500">
                            <div class="text-4xl mb-2">üìÖ</div>
                            <p class="text-sm">Tidak ada data yang cocok dengan tanggal pencarian</p>
                            <p class="text-xs mt-1">Coba tanggal lain atau <button onclick="clearUangSearch()" class="text-blue-500 hover:text-blue-700 underline">hapus pencarian</button></p>
                        </div>
                    </div>
                </div>
                
                <div style="text-center; margin-top: 15px; padding-top: 8px; border-top: 1px solid #ccc;">
                    <p style="font-size: 10px; margin: 2px 0;"><strong>Terima kasih atas kepercayaan Anda!</strong></p>
                    <p style="font-size: 8px; color: #666; margin: 2px 0;">Nota ini dibuat secara otomatis oleh sistem MUSADAD.COM</p>
                </div>
            `;
        }

        function generateOrderTable() {
            const orderItems = document.querySelectorAll('.order-item');
            let itemsHtml = '';
            
            orderItems.forEach(item => {
                const qty = item.querySelector('.qty-input').value;
                const name = item.querySelector('.item-name').value;
                const price = parseFloat(item.querySelector('.item-price').value) || 0;
                const total = parseFloat(item.querySelector('input[readonly]').value) || 0;
                
                if (qty && name && price) {
                    itemsHtml += `
                        <tr>
                            <td class="text-center">${qty}</td>
                            <td>${name}</td>
                            <td class="text-right">Rp ${price.toLocaleString('id-ID')}</td>
                            <td class="text-right">Rp ${total.toLocaleString('id-ID')}</td>
                        </tr>
                    `;
                }
            });
            
            return `
                <table>
                    <thead>
                        <tr>
                            <th class="text-center">Banyak</th>
                            <th>Nama Barang</th>
                            <th class="text-right">Harga</th>
                            <th class="text-right">Jumlah</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${itemsHtml}
                    </tbody>
                </table>
            `;
        }

        function generatePaymentSummary() {
            const orderItems = document.querySelectorAll('.order-item');
            let grandTotal = 0;
            
            orderItems.forEach(item => {
                const total = parseFloat(item.querySelector('input[readonly]').value) || 0;
                grandTotal += total;
            });
            
            const downPayment = parseFloat(document.getElementById('downPayment').value) || 0;
            const remainingBalance = grandTotal - downPayment;
            
            return `
                <div style="display: grid; grid-template-columns: 1fr auto; gap: 10px; align-items: center;">
                    <span>Total Biaya:</span>
                    <span class="font-bold">Rp ${grandTotal.toLocaleString('id-ID')}</span>
                    <span>Uang Muka (DP):</span>
                    <span class="font-bold">Rp ${downPayment.toLocaleString('id-ID')}</span>
                    <hr style="grid-column: 1 / -1; margin: 4px 0;">
                    <span class="font-bold">Sisa Tagihan:</span>
                    <span class="font-bold text-red-600">Rp ${remainingBalance.toLocaleString('id-ID')}</span>
                </div>
            `;
        }

        // Add event listeners for automatic calculation on initial item
        document.addEventListener('DOMContentLoaded', function() {
            const initialItem = document.querySelector('.order-item');
            if (initialItem) {
                const qtyInput = initialItem.querySelector('.qty-input');
                const priceInput = initialItem.querySelector('.item-price');
                const totalInput = initialItem.querySelector('input[readonly]');
                
                function calculateTotal() {
                    const qty = parseFloat(qtyInput.value) || 0;
                    const price = parseFloat(priceInput.value) || 0;
                    totalInput.value = qty * price;
                }
                
                qtyInput.addEventListener('input', calculateTotal);
                priceInput.addEventListener('input', calculateTotal);
            }
        });

        // Fungsi untuk menangani klik tombol
        function handleButtonClick(buttonName, element) {
            if (buttonName.includes('HARGA KERTAS')) {
                openHargaKertasForm();
            } else if (buttonName.includes('NOTA')) {
                openNotaForm();
            } else {
                alert(`Anda mengklik: ${buttonName}`);
            }
        }

        // Menambahkan event listener ke semua tombol
        document.querySelectorAll('button').forEach(button => {
            button.addEventListener('click', function() {
                const buttonText = this.textContent.trim();
                handleButtonClick(buttonText, this);
            });
        });

        // ===== FUNGSI BELANGKO =====
        
        // Sample data untuk belangko
        let belangkoData = [
            {no: 1, kode_belangko: 'BLG001', harga: 300},
            {no: 2, kode_belangko: 'BLG002', harga: 3000},
            {no: 3, kode_belangko: 'BLG003', harga: 3500},
            {no: 4, kode_belangko: 'BLG004', harga: 4000},
            {no: 5, kode_belangko: 'BLG005', harga: 4500}
        ];
        
        let currentBelangkoRecordIndex = 0;
        let originalBelangkoData = {};
        let filteredBelangkoData = [...belangkoData];

        // Fungsi untuk membuka form Belangko
        function openBelangkoForm() {
            document.getElementById('belangkoModal').classList.remove('hidden');
            loadBelangkoRecord(currentBelangkoRecordIndex);
            refreshBelangkoTable();
            
            // Reset filtered data dan search box
            filteredBelangkoData = [...belangkoData];
            document.getElementById('searchBelangko').value = '';
            
            // Reset selected plastik display
            selectedPlastikForBelangko = null;
            document.getElementById('selectedPlastikDisplay').classList.add('hidden');
            
            // Reset jumlah undangan
            document.getElementById('jumlah_undangan').value = '';
            
            // Reset harga OC selection
            document.getElementById('harga_oc').value = '';
            
            // Add search event listener
            const searchInput = document.getElementById('searchBelangko');
            searchInput.addEventListener('input', searchBelangko);
            searchInput.addEventListener('keyup', function(e) {
                if (e.key === 'Escape') {
                    clearBelangkoSearch();
                }
            });
            
            // Add search event listener for plastik in belangko
            const searchPlastikInput = document.getElementById('searchPlastikInBelangko');
            searchPlastikInput.addEventListener('input', searchPlastikInBelangko);
            searchPlastikInput.addEventListener('keyup', function(e) {
                if (e.key === 'Escape') {
                    clearPlastikInBelangkoSearch();
                }
            });
            
            // Add event listener for jumlah undangan input
            const jumlahUndanganInput = document.getElementById('jumlah_undangan');
            jumlahUndanganInput.addEventListener('input', function() {
                // Update detail proses belangko when quantity changes
                const currentBelangko = belangkoData[currentBelangkoRecordIndex];
                updateDetailProsesBelangko(currentBelangko, selectedPlastikForBelangko);
                // Update customer pricing when quantity changes
                updateCustomerPricingDisplay();
            });
            
            // Add event listener for harga OC select
            const hargaOCSelect = document.getElementById('harga_oc');
            hargaOCSelect.addEventListener('change', function() {
                // Update detail proses belangko when OC price changes
                const currentBelangko = belangkoData[currentBelangkoRecordIndex];
                updateDetailProsesBelangko(currentBelangko, selectedPlastikForBelangko);
                // Update customer pricing when OC price changes
                updateCustomerPricingDisplay();
            });
            
            // Add event listener for harga tawar input (auto calculate)
            const hargaTawarInput = document.getElementById('harga_tawar');
            hargaTawarInput.addEventListener('input', function() {
                hitungTawar();
            });
        }

        // Fungsi untuk menutup form Belangko
        function closeBelangkoForm() {
            document.getElementById('belangkoModal').classList.add('hidden');
        }

        // Fungsi untuk memuat data belangko ke form
        function loadBelangkoRecord(index) {
            if (index >= 0 && index < belangkoData.length) {
                const data = belangkoData[index];
                document.getElementById('belangko_no').value = data.no;
                document.getElementById('kode_belangko').value = data.kode_belangko;
                document.getElementById('harga_belangko').value = data.harga;
                
                // Simpan data asli untuk undo
                originalBelangkoData = {...data};
                
                // Update info record
                document.getElementById('currentBelangkoRecord').textContent = index + 1;
                document.getElementById('totalBelangkoRecords').textContent = belangkoData.length;
                
                // Update detail belangko
                updateDetailBelangko(data);
            }
        }

        // Fungsi untuk update detail belangko
        function updateDetailBelangko(data = null) {
            const detailDiv = document.getElementById('detailBelangko');
            
            if (!data) {
                detailDiv.innerHTML = '<div class="text-gray-600">Belum ada data belangko</div>';
                updateDetailProsesBelangko();
                return;
            }
            
            const html = `
                <div class="space-y-1">
                    <div class="flex justify-between text-xs">
                        <span>No:</span>
                        <span class="font-medium">${data.no}</span>
                    </div>
                    <div class="flex justify-between text-xs">
                        <span>Kode Belangko:</span>
                        <span class="font-medium">${data.kode_belangko}</span>
                    </div>
                    <div class="flex justify-between text-xs">
                        <span>Harga:</span>
                        <span class="font-medium">Rp ${data.harga.toLocaleString('id-ID')}</span>
                    </div>
                    <hr class="my-2 border-gray-300">
                    <div class="mt-2 p-2 bg-blue-50 rounded text-xs">
                        <div class="font-medium text-blue-800">Status:</div>
                        <div class="text-blue-700">Data Belangko Aktif</div>
                    </div>
                </div>
            `;
            
            detailDiv.innerHTML = html;
            
            // Update detail proses belangko
            updateDetailProsesBelangko(data, selectedPlastikForBelangko);
        }
        
        // Fungsi untuk update detail data proses belangko
        function updateDetailProsesBelangko(belangkoData = null, plastikData = null) {
            const detailDiv = document.getElementById('detailProsesBelangko');
            
            if (!belangkoData && !plastikData) {
                detailDiv.innerHTML = '<div class="text-gray-600">Pilih data belangko dan ukuran plastik untuk melihat detail proses</div>';
                return;
            }
            
            let html = '<div class="space-y-2">';
            
            // Data Belangko Section
            if (belangkoData) {
                html += `
                    <div class="bg-white p-2 rounded border border-blue-300">
                        <div class="font-semibold text-blue-800 text-xs mb-1">üìä Data Belangko:</div>
                        <div class="flex justify-between text-xs">
                            <span>Nama Belangko:</span>
                            <span class="font-medium">${belangkoData.kode_belangko}</span>
                        </div>
                        <div class="flex justify-between text-xs">
                            <span>Harga Belangko:</span>
                            <span class="font-medium text-green-600">Rp ${belangkoData.harga.toLocaleString('id-ID')}</span>
                        </div>
                    </div>
                `;
            }
            
            // Data Plastik Section dengan Kalkulasi
            if (plastikData) {
                const jumlahUndangan = parseInt(document.getElementById('jumlah_undangan').value) || 0;
                
                // Kalkulasi plastik: jumlah undangan dibagi 100 lalu dikali harga plastik
                const jumlahPlastikDibutuhkan = jumlahUndangan > 0 ? Math.ceil(jumlahUndangan / 100) : 0;
                const totalHargaPlastik = jumlahPlastikDibutuhkan * plastikData.harga;
                
                html += `
                    <div class="bg-white p-2 rounded border border-orange-300">
                        <div class="font-semibold text-orange-800 text-xs mb-1">üìè Data Ukuran Plastik:</div>
                        <div class="flex justify-between text-xs">
                            <span>Nama Ukuran:</span>
                            <span class="font-medium">${plastikData.nama_ukuran}</span>
                        </div>
                        <div class="flex justify-between text-xs">
                            <span>Harga per Lembar:</span>
                            <span class="font-medium text-green-600">Rp ${plastikData.harga.toLocaleString('id-ID')}</span>
                        </div>
                        ${jumlahUndangan > 0 ? `
                        <hr class="my-1 border-orange-200">
                        <div class="bg-orange-50 p-1 rounded text-xs">
                            <div class="font-medium text-orange-700 mb-1">üßÆ Hitung Plastik:</div>
                            <div class="flex justify-between text-xs">
                                <span>Rumus:</span>
                                <span class="font-mono text-xs">${jumlahUndangan} √∑ 100 = ${(jumlahUndangan / 100).toFixed(1)}</span>
                            </div>
                            <div class="flex justify-between text-xs">
                                <span>Dibulatkan:</span>
                                <span class="font-medium">${jumlahPlastikDibutuhkan} lembar</span>
                            </div>
                            <div class="flex justify-between text-xs font-bold text-orange-700">
                                <span>Total Harga Plastik:</span>
                                <span>Rp ${totalHargaPlastik.toLocaleString('id-ID')}</span>
                            </div>
                        </div>
                        ` : ''}
                    </div>
                `;
            }
            
            // Jumlah Undangan Section
            const jumlahUndangan = parseInt(document.getElementById('jumlah_undangan').value) || 0;
            if (jumlahUndangan > 0) {
                html += `
                    <div class="bg-white p-2 rounded border border-purple-300">
                        <div class="font-semibold text-purple-800 text-xs mb-1">üìÑ Jumlah Undangan:</div>
                        <div class="flex justify-between text-xs">
                            <span>Jumlah Pis:</span>
                            <span class="font-medium text-purple-600">${jumlahUndangan.toLocaleString('id-ID')} pis</span>
                        </div>
                    </div>
                `;
            }
            
            // Harga OC Section
            const hargaOCSelect = document.getElementById('harga_oc');
            const hargaOCValue = parseInt(hargaOCSelect.value) || 0;
            const hargaOCText = hargaOCSelect.options[hargaOCSelect.selectedIndex].text;
            
            if (hargaOCValue > 0) {
                const totalHargaOC = jumlahUndangan > 0 ? hargaOCValue * jumlahUndangan : hargaOCValue;
                
                // Check if using OC Mesin Toko (value 50) for master fee
                const isOCMesinToko = hargaOCValue === 50;
                const masterFee = isOCMesinToko ? 35000 : 0;
                const totalOCWithMaster = totalHargaOC + masterFee;
                
                html += `
                    <div class="bg-white p-2 rounded border border-indigo-300">
                        <div class="font-semibold text-indigo-800 text-xs mb-1">üñ®Ô∏è Harga OC/Cetak:</div>
                        <div class="flex justify-between text-xs">
                            <span>Jenis:</span>
                            <span class="font-medium text-indigo-600">${hargaOCText.split(' - ')[0]}</span>
                        </div>
                        <div class="flex justify-between text-xs">
                            <span>Harga per lembar:</span>
                            <span class="font-medium text-green-600">Rp ${hargaOCValue.toLocaleString('id-ID')}</span>
                        </div>
                        ${jumlahUndangan > 0 ? `
                        <div class="flex justify-between text-xs">
                            <span>Total Harga OC:</span>
                            <span class="font-medium text-indigo-700">Rp ${totalHargaOC.toLocaleString('id-ID')}</span>
                        </div>
                        ${isOCMesinToko ? `
                        <div class="flex justify-between text-xs">
                            <span>Biaya Master:</span>
                            <span class="font-medium text-orange-600">Rp ${masterFee.toLocaleString('id-ID')}</span>
                        </div>
                        <hr class="my-1 border-indigo-200">
                        <div class="flex justify-between text-xs font-bold text-indigo-700">
                            <span>Total OC + Master:</span>
                            <span>Rp ${totalOCWithMaster.toLocaleString('id-ID')}</span>
                        </div>
                        ` : `
                        <div class="flex justify-between text-xs font-bold text-indigo-700">
                            <span>Total Harga OC:</span>
                            <span>Rp ${totalHargaOC.toLocaleString('id-ID')}</span>
                        </div>
                        `}
                        ` : ''}
                    </div>
                `;
            }
            
            // Total Section dengan Kalkulasi Plastik yang Benar
            if (belangkoData && plastikData) {
                const jumlahPlastikDibutuhkan = jumlahUndangan > 0 ? Math.ceil(jumlahUndangan / 100) : 1;
                const totalHargaPlastik = jumlahPlastikDibutuhkan * plastikData.harga;
                const totalHargaOC = hargaOCValue > 0 && jumlahUndangan > 0 ? hargaOCValue * jumlahUndangan : 0;
                
                // Check for master fee (only for OC Mesin Toko - value 50)
                const isOCMesinToko = hargaOCValue === 50;
                const masterFee = isOCMesinToko ? 35000 : 0;
                const totalOCWithMaster = totalHargaOC + masterFee;
                
                // Harga per pis = harga belangko + (harga plastik per lembar / 100) + harga OC
                const hargaPlastikPerPis = plastikData.harga / 100;
                const hargaPerPis = belangkoData.harga + hargaPlastikPerPis + hargaOCValue;
                
                // Total harga = (harga belangko * jumlah undangan) + total harga plastik + total harga OC + master fee
                const totalHargaBelangko = jumlahUndangan > 0 ? belangkoData.harga * jumlahUndangan : belangkoData.harga;
                const totalHarga = totalHargaBelangko + totalHargaPlastik + totalOCWithMaster;
                
                html += `
                    <hr class="border-blue-300">
                    <div class="bg-green-50 p-2 rounded border border-green-300">
                        <div class="font-semibold text-green-800 text-xs mb-1">üí∞ Harga Modal:</div>
                        <div class="flex justify-between text-xs">
                            <span>Harga Belangko:</span>
                            <span>Rp ${belangkoData.harga.toLocaleString('id-ID')} per pis</span>
                        </div>
                        <div class="flex justify-between text-xs">
                            <span>Harga Plastik:</span>
                            <span>Rp ${hargaPlastikPerPis.toLocaleString('id-ID')} per pis</span>
                        </div>
                        ${hargaOCValue > 0 ? `
                        <div class="flex justify-between text-xs">
                            <span>Harga OC/Cetak:</span>
                            <span>Rp ${hargaOCValue.toLocaleString('id-ID')} per pis</span>
                        </div>
                        ` : ''}
                        <hr class="my-1 border-green-300">
                        <div class="flex justify-between text-xs font-medium">
                            <span>Harga per Pis:</span>
                            <span>Rp ${hargaPerPis.toLocaleString('id-ID')}</span>
                        </div>
                        ${jumlahUndangan > 0 ? `
                        <hr class="my-1 border-green-300">
                        <div class="bg-white p-2 rounded border border-gray-200 mt-2">
                            <div class="font-medium text-gray-800 text-xs mb-1">üìä Rincian Total:</div>
                            <div class="flex justify-between text-xs">
                                <span>Belangko (${jumlahUndangan} √ó ${belangkoData.harga.toLocaleString('id-ID')}):</span>
                                <span>Rp ${totalHargaBelangko.toLocaleString('id-ID')}</span>
                            </div>
                            <div class="flex justify-between text-xs">
                                <span>Plastik (${jumlahPlastikDibutuhkan} lembar √ó ${plastikData.harga.toLocaleString('id-ID')}):</span>
                                <span>Rp ${totalHargaPlastik.toLocaleString('id-ID')}</span>
                            </div>
                            ${totalHargaOC > 0 ? `
                            <div class="flex justify-between text-xs">
                                <span>OC/Cetak (${jumlahUndangan} √ó ${hargaOCValue.toLocaleString('id-ID')}):</span>
                                <span>Rp ${totalHargaOC.toLocaleString('id-ID')}</span>
                            </div>
                            ` : ''}
                            ${masterFee > 0 ? `
                            <div class="flex justify-between text-xs">
                                <span>Biaya Master (OC Mesin Toko):</span>
                                <span class="font-medium text-orange-600">Rp ${masterFee.toLocaleString('id-ID')}</span>
                            </div>
                            ` : ''}
                        </div>
                        <div class="flex justify-between font-bold text-green-700 text-sm mt-2">
                            <span>TOTAL HARGA:</span>
                            <span>Rp ${totalHarga.toLocaleString('id-ID')}</span>
                        </div>
                        ` : `
                        <div class="flex justify-between font-bold text-green-700">
                            <span>HARGA PER PIS:</span>
                            <span>Rp ${hargaPerPis.toLocaleString('id-ID')}</span>
                        </div>
                        `}
                    </div>
                `;
            } else if (belangkoData && !plastikData) {
                html += `
                    <div class="bg-yellow-50 p-2 rounded border border-yellow-300">
                        <div class="font-medium text-yellow-800 text-xs">‚ö†Ô∏è Belum Lengkap:</div>
                        <div class="text-yellow-700 text-xs">Pilih ukuran plastik untuk melengkapi proses</div>
                    </div>
                `;
            } else if (!belangkoData && plastikData) {
                html += `
                    <div class="bg-yellow-50 p-2 rounded border border-yellow-300">
                        <div class="font-medium text-yellow-800 text-xs">‚ö†Ô∏è Belum Lengkap:</div>
                        <div class="text-yellow-700 text-xs">Pilih data belangko untuk melengkapi proses</div>
                    </div>
                `;
            }
            
            html += '</div>';
            detailDiv.innerHTML = html;
        }

        // Fungsi navigasi belangko
        function firstBelangkoRecord() {
            currentBelangkoRecordIndex = 0;
            loadBelangkoRecord(currentBelangkoRecordIndex);
            refreshBelangkoTable();
        }

        function previousBelangkoRecord() {
            if (currentBelangkoRecordIndex > 0) {
                currentBelangkoRecordIndex--;
                loadBelangkoRecord(currentBelangkoRecordIndex);
                refreshBelangkoTable();
            }
        }

        function nextBelangkoRecord() {
            if (currentBelangkoRecordIndex < belangkoData.length - 1) {
                currentBelangkoRecordIndex++;
                loadBelangkoRecord(currentBelangkoRecordIndex);
                refreshBelangkoTable();
            }
        }

        function lastBelangkoRecord() {
            currentBelangkoRecordIndex = belangkoData.length - 1;
            loadBelangkoRecord(currentBelangkoRecordIndex);
            refreshBelangkoTable();
        }

        // Fungsi kontrol data belangko
        function undoBelangkoRecord() {
            loadBelangkoRecord(currentBelangkoRecordIndex);
            alert('Data belangko dikembalikan ke kondisi semula');
        }

        function saveBelangkoRecord() {
            const formData = {
                no: parseInt(document.getElementById('belangko_no').value),
                kode_belangko: document.getElementById('kode_belangko').value,
                harga: parseInt(document.getElementById('harga_belangko').value)
            };
            
            // Validasi data
            if (!formData.kode_belangko || !formData.harga) {
                alert('Semua field harus diisi!');
                return;
            }
            
            // Update data array
            belangkoData[currentBelangkoRecordIndex] = formData;
            
            // Update filtered data
            filteredBelangkoData = [...belangkoData];
            
            refreshBelangkoTable();
            alert(`Data belangko berhasil disimpan!\n\nKode: ${formData.kode_belangko}\nHarga: Rp ${formData.harga.toLocaleString('id-ID')}`);
        }

        function refreshBelangkoData() {
            loadBelangkoRecord(currentBelangkoRecordIndex);
            refreshBelangkoTable();
            alert('Data belangko berhasil di-refresh');
        }

        function newBelangkoRecord() {
            const newNo = belangkoData.length > 0 ? Math.max(...belangkoData.map(item => item.no)) + 1 : 1;
            
            const newData = {
                no: newNo,
                kode_belangko: '',
                harga: 0
            };
            
            belangkoData.push(newData);
            currentBelangkoRecordIndex = belangkoData.length - 1;
            
            // Update filtered data
            filteredBelangkoData = [...belangkoData];
            
            loadBelangkoRecord(currentBelangkoRecordIndex);
            refreshBelangkoTable();
            
            // Focus pada field pertama
            document.getElementById('kode_belangko').focus();
            
            alert('Record belangko baru telah dibuat! Silakan isi data dan klik Simpan Data.');
        }

        function deleteBelangkoRecord() {
            if (!belangkoData || belangkoData.length === 0) {
                alert('Tidak ada data untuk dihapus!');
                return;
            }
            
            if (currentBelangkoRecordIndex < 0 || currentBelangkoRecordIndex >= belangkoData.length) {
                alert('Record tidak valid!');
                return;
            }
            
            const currentData = belangkoData[currentBelangkoRecordIndex];
            const confirmMessage = `Apakah Anda yakin ingin menghapus data:\n\nKode: ${currentData.kode_belangko}\nHarga: Rp ${currentData.harga.toLocaleString('id-ID')}?`;
            
            if (confirm(confirmMessage)) {
                const deletedKode = currentData.kode_belangko;
                const deletedHarga = currentData.harga;
                
                belangkoData.splice(currentBelangkoRecordIndex, 1);
                
                // Update nomor urut
                belangkoData.forEach((item, idx) => {
                    item.no = idx + 1;
                });
                
                // Update filtered data
                filteredBelangkoData = [...belangkoData];
                
                // Sesuaikan currentBelangkoRecordIndex
                if (belangkoData.length > 0) {
                    if (currentBelangkoRecordIndex >= belangkoData.length) {
                        currentBelangkoRecordIndex = belangkoData.length - 1;
                    }
                    loadBelangkoRecord(currentBelangkoRecordIndex);
                } else {
                    currentBelangkoRecordIndex = 0;
                    // Clear form
                    document.getElementById('belangko_no').value = '';
                    document.getElementById('kode_belangko').value = '';
                    document.getElementById('harga_belangko').value = 0;
                    document.getElementById('currentBelangkoRecord').textContent = '0';
                    document.getElementById('totalBelangkoRecords').textContent = '0';
                    updateDetailBelangko();
                }
                
                refreshBelangkoTable();
                alert(`Data "${deletedKode}" (Rp ${deletedHarga.toLocaleString('id-ID')}) berhasil dihapus!`);
            }
        }

        // Fungsi untuk me-refresh tabel belangko
        function refreshBelangkoTable() {
            const tableBody = document.getElementById('belangkoTableBody');
            const noResultsMessage = document.getElementById('noBelangkoResultsMessage');
            tableBody.innerHTML = '';
            
            // Update counter
            updateBelangkoSearchCounter();
            
            if (filteredBelangkoData.length === 0) {
                // Show no results message
                noResultsMessage.classList.remove('hidden');
                return;
            } else {
                // Hide no results message
                noResultsMessage.classList.add('hidden');
            }
            
            filteredBelangkoData.forEach((data, filteredIndex) => {
                // Find original index in belangkoData
                const originalIndex = belangkoData.findIndex(item => item.no === data.no);
                const row = document.createElement('tr');
                row.className = originalIndex === currentBelangkoRecordIndex ? 'bg-blue-50' : 'hover:bg-gray-50';
                
                row.innerHTML = `
                    <td class="border border-gray-300 px-3 py-2 font-medium">${data.no}</td>
                    <td class="border border-gray-300 px-3 py-2">${highlightBelangkoSearchTerm(data.kode_belangko)}</td>
                    <td class="border border-gray-300 px-3 py-2">Rp ${data.harga.toLocaleString('id-ID')}</td>
                    <td class="border border-gray-300 px-3 py-2 text-center">
                        <button onclick="selectBelangkoRecord(${originalIndex})" class="bg-blue-500 hover:bg-blue-600 text-white px-2 py-1 rounded text-xs transition-colors">
                            Pilih
                        </button>
                        <button onclick="deleteBelangkoRecordFromTable(${originalIndex})" class="bg-red-500 hover:bg-red-600 text-white px-2 py-1 rounded text-xs ml-1 transition-colors">
                            Hapus
                        </button>
                    </td>
                `;
                
                tableBody.appendChild(row);
            });
        }

        // Fungsi untuk memilih record belangko dari tabel
        function selectBelangkoRecord(index) {
            currentBelangkoRecordIndex = index;
            loadBelangkoRecord(currentBelangkoRecordIndex);
            refreshBelangkoTable();
        }

        // Fungsi untuk menghapus record belangko dari tabel
        function deleteBelangkoRecordFromTable(index) {
            if (confirm('Apakah Anda yakin ingin menghapus data ini?')) {
                const deletedData = belangkoData[index];
                belangkoData.splice(index, 1);
                
                // Update nomor urut
                belangkoData.forEach((item, idx) => {
                    item.no = idx + 1;
                });
                
                // Update filtered data
                filteredBelangkoData = [...belangkoData];
                
                // Adjust current record index
                if (currentBelangkoRecordIndex >= belangkoData.length) {
                    currentBelangkoRecordIndex = belangkoData.length - 1;
                }
                if (currentBelangkoRecordIndex < 0) currentBelangkoRecordIndex = 0;
                
                if (belangkoData.length > 0) {
                    loadBelangkoRecord(currentBelangkoRecordIndex);
                } else {
                    // Clear form if no data left
                    document.getElementById('belangko_no').value = '';
                    document.getElementById('kode_belangko').value = '';
                    document.getElementById('harga_belangko').value = 0;
                    document.getElementById('currentBelangkoRecord').textContent = '0';
                    document.getElementById('totalBelangkoRecords').textContent = '0';
                    updateDetailBelangko();
                }
                
                // Re-apply current search if any
                searchBelangko();
                alert(`Data "${deletedData.kode_belangko}" berhasil dihapus!`);
            }
        }

        // Fungsi pencarian belangko
        function searchBelangko() {
            const searchTerm = document.getElementById('searchBelangko').value.toLowerCase().trim();
            
            if (!searchTerm) {
                // Jika pencarian kosong, tampilkan semua data
                filteredBelangkoData = [...belangkoData];
            } else {
                // Filter data berdasarkan kode belangko
                filteredBelangkoData = belangkoData.filter(item => 
                    item.kode_belangko.toLowerCase().includes(searchTerm)
                );
            }
            
            refreshBelangkoTable();
        }

        // Fungsi untuk clear search belangko
        function clearBelangkoSearch() {
            document.getElementById('searchBelangko').value = '';
            filteredBelangkoData = [...belangkoData];
            refreshBelangkoTable();
            document.getElementById('searchBelangko').focus();
        }

        // Fungsi untuk highlight search term pada kode belangko
        function highlightBelangkoSearchTerm(text) {
            const searchTerm = document.getElementById('searchBelangko').value.trim();
            if (!searchTerm) return text;
            
            const regex = new RegExp(`(${searchTerm})`, 'gi');
            return text.replace(regex, '<mark class="bg-yellow-200 px-1 rounded">$1</mark>');
        }

        // Fungsi untuk update counter pencarian belangko
        function updateBelangkoSearchCounter() {
            const visibleCount = document.getElementById('visibleBelangkoCount');
            const totalCount = document.getElementById('totalBelangkoCount');
            
            if (visibleCount && totalCount) {
                visibleCount.textContent = filteredBelangkoData.length;
                totalCount.textContent = belangkoData.length;
            }
        }

        // ===== FUNGSI BELI =====
        
        // Sample data untuk beli
        let beliData = [
            {no: 1, tanggal: '2024-01-15', ket_kebutuhan: 'Kebutuhan tinta untuk printer', nama_barang: 'Tinta Canon Black', harga: 85000, jumlah: 2, total: 170000},
            {no: 2, tanggal: '2024-01-16', ket_kebutuhan: 'Kertas untuk cetak undangan', nama_barang: 'Kertas Art Paper A4', harga: 25000, jumlah: 10, total: 250000},
            {no: 3, tanggal: '2024-01-17', ket_kebutuhan: 'Alat binding untuk finishing', nama_barang: 'Spiral Binding 12mm', harga: 15000, jumlah: 5, total: 75000},
            {no: 4, tanggal: '2024-01-18', ket_kebutuhan: 'Laminating untuk proteksi dokumen', nama_barang: 'Laminating Film A4', harga: 35000, jumlah: 3, total: 105000},
            {no: 5, tanggal: '2024-01-19', ket_kebutuhan: 'Tinta warna untuk cetak foto', nama_barang: 'Tinta Epson Color Set', harga: 120000, jumlah: 1, total: 120000}
        ];
        
        let currentBeliRecordIndex = 0;
        let originalBeliData = {};
        let filteredBeliData = [...beliData];

        // Fungsi untuk membuka form Beli
        function openBeliForm() {
            document.getElementById('beliModal').classList.remove('hidden');
            loadBeliRecord(currentBeliRecordIndex);
            refreshBeliTable();
            
            // Set tanggal hari ini jika kosong
            const today = new Date().toISOString().split('T')[0];
            if (!document.getElementById('beli_tanggal').value) {
                document.getElementById('beli_tanggal').value = today;
            }
            
            // Reset filtered data dan search box
            filteredBeliData = [...beliData];
            document.getElementById('searchBeli').value = '';
            
            // Add event listeners untuk auto calculate
            addBeliCalculationListeners();
            
            // Add search event listener
            const searchInput = document.getElementById('searchBeli');
            searchInput.addEventListener('input', searchBeli);
            searchInput.addEventListener('keyup', function(e) {
                if (e.key === 'Escape') {
                    clearBeliSearch();
                }
            });
        }

        // Fungsi untuk menutup form Beli
        function closeBeliForm() {
            document.getElementById('beliModal').classList.add('hidden');
        }

        // Fungsi untuk memuat data beli ke form
        function loadBeliRecord(index) {
            if (index >= 0 && index < beliData.length) {
                const data = beliData[index];
                document.getElementById('beli_no').value = data.no;
                document.getElementById('beli_tanggal').value = data.tanggal;
                document.getElementById('ket_kebutuhan').value = data.ket_kebutuhan;
                document.getElementById('nama_barang').value = data.nama_barang;
                document.getElementById('harga_barang').value = data.harga;
                document.getElementById('jumlah_barang').value = data.jumlah;
                
                // Update total display
                document.getElementById('totalHargaBeli').textContent = 'Rp ' + (data.total || 0).toLocaleString('id-ID');
                
                // Simpan data asli untuk undo
                originalBeliData = {...data};
                
                // Update info record
                document.getElementById('currentBeliRecord').textContent = index + 1;
                document.getElementById('totalBeliRecords').textContent = beliData.length;
                
                // Update detail pembelian
                updateDetailPembelian(data);
            }
        }

        // Fungsi untuk menambahkan event listeners pada input calculation
        function addBeliCalculationListeners() {
            const hargaInput = document.getElementById('harga_barang');
            const jumlahInput = document.getElementById('jumlah_barang');
            
            function calculateTotal() {
                const harga = parseFloat(hargaInput.value) || 0;
                const jumlah = parseFloat(jumlahInput.value) || 0;
                const total = harga * jumlah;
                document.getElementById('totalHargaBeli').textContent = 'Rp ' + total.toLocaleString('id-ID');
                return total;
            }
            
            hargaInput.addEventListener('input', calculateTotal);
            jumlahInput.addEventListener('input', calculateTotal);
        }

        // Fungsi untuk update detail pembelian
        function updateDetailPembelian(data = null) {
            const detailDiv = document.getElementById('detailPembelian');
            
            if (!data) {
                detailDiv.innerHTML = '<div class="text-gray-600">Belum ada data pembelian</div>';
                return;
            }
            
            const html = `
                <div class="space-y-1">
                    <div class="flex justify-between text-xs">
                        <span>Tanggal:</span>
                        <span class="font-medium">${new Date(data.tanggal).toLocaleDateString('id-ID')}</span>
                    </div>
                    <div class="flex justify-between text-xs">
                        <span>Nama Barang:</span>
                        <span class="font-medium">${data.nama_barang}</span>
                    </div>
                    <div class="flex justify-between text-xs">
                        <span>Harga Satuan:</span>
                        <span class="font-medium">Rp ${data.harga.toLocaleString('id-ID')}</span>
                    </div>
                    <div class="flex justify-between text-xs">
                        <span>Jumlah:</span>
                        <span class="font-medium">${data.jumlah}</span>
                    </div>
                    <hr class="my-2 border-gray-300">
                    <div class="flex justify-between font-bold text-green-600">
                        <span>TOTAL:</span>
                        <span>Rp ${data.total.toLocaleString('id-ID')}</span>
                    </div>
                    <div class="mt-2 p-2 bg-blue-50 rounded text-xs">
                        <div class="font-medium text-blue-800">Kebutuhan:</div>
                        <div class="text-blue-700">${data.ket_kebutuhan}</div>
                    </div>
                </div>
            `;
            
            detailDiv.innerHTML = html;
        }

        // Fungsi navigasi beli
        function firstBeliRecord() {
            currentBeliRecordIndex = 0;
            loadBeliRecord(currentBeliRecordIndex);
            refreshBeliTable();
        }

        function previousBeliRecord() {
            if (currentBeliRecordIndex > 0) {
                currentBeliRecordIndex--;
                loadBeliRecord(currentBeliRecordIndex);
                refreshBeliTable();
            }
        }

        function nextBeliRecord() {
            if (currentBeliRecordIndex < beliData.length - 1) {
                currentBeliRecordIndex++;
                loadBeliRecord(currentBeliRecordIndex);
                refreshBeliTable();
            }
        }

        function lastBeliRecord() {
            currentBeliRecordIndex = beliData.length - 1;
            loadBeliRecord(currentBeliRecordIndex);
            refreshBeliTable();
        }

        // Fungsi kontrol data beli
        function undoBeliRecord() {
            loadBeliRecord(currentBeliRecordIndex);
            alert('Data pembelian dikembalikan ke kondisi semula');
        }

        function saveBeliRecord() {
            const harga = parseFloat(document.getElementById('harga_barang').value) || 0;
            const jumlah = parseFloat(document.getElementById('jumlah_barang').value) || 0;
            const total = harga * jumlah;
            
            const formData = {
                no: parseInt(document.getElementById('beli_no').value),
                tanggal: document.getElementById('beli_tanggal').value,
                ket_kebutuhan: document.getElementById('ket_kebutuhan').value,
                nama_barang: document.getElementById('nama_barang').value,
                harga: harga,
                jumlah: jumlah,
                total: total
            };
            
            // Validasi data
            if (!formData.tanggal || !formData.nama_barang || !formData.harga || !formData.jumlah) {
                alert('Semua field harus diisi!');
                return;
            }
            
            // Update data array
            beliData[currentBeliRecordIndex] = formData;
            
            // Update filtered data
            filteredBeliData = [...beliData];
            
            refreshBeliTable();
            alert(`Data pembelian berhasil disimpan!\n\nBarang: ${formData.nama_barang}\nTotal: Rp ${total.toLocaleString('id-ID')}`);
        }

        function refreshBeliData() {
            loadBeliRecord(currentBeliRecordIndex);
            refreshBeliTable();
            alert('Data pembelian berhasil di-refresh');
        }

        function newBeliRecord() {
            const newNo = beliData.length > 0 ? Math.max(...beliData.map(item => item.no)) + 1 : 1;
            const today = new Date().toISOString().split('T')[0];
            
            const newData = {
                no: newNo,
                tanggal: today,
                ket_kebutuhan: '',
                nama_barang: '',
                harga: 0,
                jumlah: 0,
                total: 0
            };
            
            beliData.push(newData);
            currentBeliRecordIndex = beliData.length - 1;
            
            // Update filtered data
            filteredBeliData = [...beliData];
            
            loadBeliRecord(currentBeliRecordIndex);
            refreshBeliTable();
            
            // Focus pada field pertama
            document.getElementById('ket_kebutuhan').focus();
            
            alert('Record pembelian baru telah dibuat! Silakan isi data dan klik Simpan Data.');
        }

        function deleteBeliRecord() {
            if (!beliData || beliData.length === 0) {
                alert('Tidak ada data untuk dihapus!');
                return;
            }
            
            if (currentBeliRecordIndex < 0 || currentBeliRecordIndex >= beliData.length) {
                alert('Record tidak valid!');
                return;
            }
            
            const currentData = beliData[currentBeliRecordIndex];
            const confirmMessage = `Apakah Anda yakin ingin menghapus data:\n\nBarang: ${currentData.nama_barang}\nTotal: Rp ${currentData.total.toLocaleString('id-ID')}\nTanggal: ${currentData.tanggal}?`;
            
            if (confirm(confirmMessage)) {
                const deletedName = currentData.nama_barang;
                const deletedTotal = currentData.total;
                
                beliData.splice(currentBeliRecordIndex, 1);
                
                // Update nomor urut
                beliData.forEach((item, idx) => {
                    item.no = idx + 1;
                });
                
                // Update filtered data
                filteredBeliData = [...beliData];
                
                // Sesuaikan currentBeliRecordIndex
                if (beliData.length > 0) {
                    if (currentBeliRecordIndex >= beliData.length) {
                        currentBeliRecordIndex = beliData.length - 1;
                    }
                    loadBeliRecord(currentBeliRecordIndex);
                } else {
                    currentBeliRecordIndex = 0;
                    // Clear form
                    document.getElementById('beli_no').value = '';
                    document.getElementById('beli_tanggal').value = '';
                    document.getElementById('ket_kebutuhan').value = '';
                    document.getElementById('nama_barang').value = '';
                    document.getElementById('harga_barang').value = 0;
                    document.getElementById('jumlah_barang').value = 0;
                    document.getElementById('totalHargaBeli').textContent = 'Rp 0';
                    document.getElementById('currentBeliRecord').textContent = '0';
                    document.getElementById('totalBeliRecords').textContent = '0';
                    updateDetailPembelian();
                }
                
                refreshBeliTable();
                alert(`Data "${deletedName}" (Rp ${deletedTotal.toLocaleString('id-ID')}) berhasil dihapus!`);
            }
        }

        // Fungsi untuk me-refresh tabel beli
        function refreshBeliTable() {
            const tableBody = document.getElementById('beliTableBody');
            const noResultsMessage = document.getElementById('noBeliResultsMessage');
            tableBody.innerHTML = '';
            
            // Update counter
            updateBeliSearchCounter();
            
            if (filteredBeliData.length === 0) {
                // Show no results message
                noResultsMessage.classList.remove('hidden');
                return;
            } else {
                // Hide no results message
                noResultsMessage.classList.add('hidden');
            }
            
            filteredBeliData.forEach((data, filteredIndex) => {
                // Find original index in beliData
                const originalIndex = beliData.findIndex(item => item.no === data.no);
                const row = document.createElement('tr');
                row.className = originalIndex === currentBeliRecordIndex ? 'bg-green-50' : 'hover:bg-gray-50';
                
                row.innerHTML = `
                    <td class="border border-gray-300 px-3 py-2 font-medium">${data.no}</td>
                    <td class="border border-gray-300 px-3 py-2">${new Date(data.tanggal).toLocaleDateString('id-ID')}</td>
                    <td class="border border-gray-300 px-3 py-2">${highlightBeliSearchTerm(data.nama_barang)}</td>
                    <td class="border border-gray-300 px-3 py-2">
                        <div class="text-xs text-gray-600">Qty: ${data.jumlah}</div>
                        <div class="font-semibold text-green-600">Rp ${data.total.toLocaleString('id-ID')}</div>
                    </td>
                    <td class="border border-gray-300 px-3 py-2 text-center">
                        <button onclick="selectBeliRecord(${originalIndex})" class="bg-blue-500 hover:bg-blue-600 text-white px-2 py-1 rounded text-xs transition-colors">
                            Pilih
                        </button>
                        <button onclick="deleteBeliRecordFromTable(${originalIndex})" class="bg-red-500 hover:bg-red-600 text-white px-2 py-1 rounded text-xs ml-1 transition-colors">
                            Hapus
                        </button>
                    </td>
                `;
                
                tableBody.appendChild(row);
            });
        }

        // Fungsi untuk memilih record beli dari tabel
        function selectBeliRecord(index) {
            currentBeliRecordIndex = index;
            loadBeliRecord(currentBeliRecordIndex);
            refreshBeliTable();
        }

        // Fungsi untuk menghapus record beli dari tabel
        function deleteBeliRecordFromTable(index) {
            if (confirm('Apakah Anda yakin ingin menghapus data ini?')) {
                const deletedData = beliData[index];
                beliData.splice(index, 1);
                
                // Update nomor urut
                beliData.forEach((item, idx) => {
                    item.no = idx + 1;
                });
                
                // Update filtered data
                filteredBeliData = [...beliData];
                
                // Adjust current record index
                if (currentBeliRecordIndex >= beliData.length) {
                    currentBeliRecordIndex = beliData.length - 1;
                }
                if (currentBeliRecordIndex < 0) currentBeliRecordIndex = 0;
                
                if (beliData.length > 0) {
                    loadBeliRecord(currentBeliRecordIndex);
                } else {
                    // Clear form if no data left
                    document.getElementById('beli_no').value = '';
                    document.getElementById('beli_tanggal').value = '';
                    document.getElementById('ket_kebutuhan').value = '';
                    document.getElementById('nama_barang').value = '';
                    document.getElementById('harga_barang').value = 0;
                    document.getElementById('jumlah_barang').value = 0;
                    document.getElementById('totalHargaBeli').textContent = 'Rp 0';
                    document.getElementById('currentBeliRecord').textContent = '0';
                    document.getElementById('totalBeliRecords').textContent = '0';
                    updateDetailPembelian();
                }
                
                // Re-apply current search if any
                searchBeli();
                alert(`Data "${deletedData.nama_barang}" berhasil dihapus!`);
            }
        }

        // Fungsi pencarian beli
        function searchBeli() {
            const searchTerm = document.getElementById('searchBeli').value.toLowerCase().trim();
            
            if (!searchTerm) {
                // Jika pencarian kosong, tampilkan semua data
                filteredBeliData = [...beliData];
            } else {
                // Filter data berdasarkan nama barang
                filteredBeliData = beliData.filter(item => 
                    item.nama_barang.toLowerCase().includes(searchTerm)
                );
            }
            
            refreshBeliTable();
        }

        // Fungsi untuk clear search beli
        function clearBeliSearch() {
            document.getElementById('searchBeli').value = '';
            filteredBeliData = [...beliData];
            refreshBeliTable();
            document.getElementById('searchBeli').focus();
        }

        // Fungsi untuk highlight search term pada nama barang
        function highlightBeliSearchTerm(text) {
            const searchTerm = document.getElementById('searchBeli').value.trim();
            if (!searchTerm) return text;
            
            const regex = new RegExp(`(${searchTerm})`, 'gi');
            return text.replace(regex, '<mark class="bg-yellow-200 px-1 rounded">$1</mark>');
        }

        // Fungsi untuk update counter pencarian beli
        function updateBeliSearchCounter() {
            const visibleCount = document.getElementById('visibleBeliCount');
            const totalCount = document.getElementById('totalBeliCount');
            
            if (visibleCount && totalCount) {
                visibleCount.textContent = filteredBeliData.length;
                totalCount.textContent = beliData.length;
            }
        }

        // ===== FUNGSI ITUNG UANG =====
        
        // Sample data untuk itung uang
        let uangData = [
            {
                id: 1, 
                tanggal: '2024-01-15',
                count_100000: 5, count_75000: 2, count_50000: 10, count_20000: 15, count_10000: 20,
                count_5000: 25, count_2000: 30, count_1000: 40, count_500: 20, count_200: 15,
                total: 1275000,
                rek_bca: 2500000,
                saldo_pulsa: 150000,
                saldo_dana: 750000,
                jumlah_aset: 4675000
            },
            {
                id: 2, 
                tanggal: '2024-01-16',
                count_100000: 3, count_75000: 1, count_50000: 8, count_20000: 12, count_10000: 18,
                count_5000: 20, count_2000: 25, count_1000: 35, count_500: 15, count_200: 10,
                total: 985000,
                rek_bca: 2750000,
                saldo_pulsa: 125000,
                saldo_dana: 680000,
                jumlah_aset: 4540000
            },
            {
                id: 3, 
                tanggal: '2024-01-17',
                count_100000: 7, count_75000: 3, count_50000: 12, count_20000: 18, count_10000: 25,
                count_5000: 30, count_2000: 35, count_1000: 45, count_500: 25, count_200: 20,
                total: 1685000,
                rek_bca: 3200000,
                saldo_pulsa: 200000,
                saldo_dana: 850000,
                jumlah_aset: 5935000
            }
        ];
        
        let currentUangRecordIndex = 0;
        let originalUangData = {};

        // Fungsi untuk membuka form Itung Uang
        function openItungUangForm() {
            document.getElementById('itungUangModal').classList.remove('hidden');
            loadUangRecord(currentUangRecordIndex);
            refreshUangTable();
            
            // Set tanggal hari ini jika kosong
            const today = new Date().toISOString().split('T')[0];
            if (!document.getElementById('tanggal_uang').value) {
                document.getElementById('tanggal_uang').value = today;
            }
            
            // Reset filtered data dan search box
            filteredUangData = [...uangData];
            document.getElementById('searchTanggalUang').value = '';
            
            // Add event listeners untuk auto calculate
            addMoneyCounterListeners();
            
            // Add search event listener
            const searchInput = document.getElementById('searchTanggalUang');
            searchInput.addEventListener('input', searchUangByDate);
            searchInput.addEventListener('keyup', function(e) {
                if (e.key === 'Escape') {
                    clearUangSearch();
                }
            });
        }

        // Fungsi untuk menutup form Itung Uang
        function closeItungUangForm() {
            document.getElementById('itungUangModal').classList.add('hidden');
        }

        // Fungsi untuk memuat data uang ke form
        function loadUangRecord(index) {
            if (index >= 0 && index < uangData.length) {
                const data = uangData[index];
                document.getElementById('uang_id').value = data.id;
                document.getElementById('tanggal_uang').value = data.tanggal;
                
                // Load money counts
                document.getElementById('count_100000').value = data.count_100000 || 0;
                document.getElementById('count_75000').value = data.count_75000 || 0;
                document.getElementById('count_50000').value = data.count_50000 || 0;
                document.getElementById('count_20000').value = data.count_20000 || 0;
                document.getElementById('count_10000').value = data.count_10000 || 0;
                document.getElementById('count_5000').value = data.count_5000 || 0;
                document.getElementById('count_2000').value = data.count_2000 || 0;
                document.getElementById('count_1000').value = data.count_1000 || 0;
                document.getElementById('count_500').value = data.count_500 || 0;
                document.getElementById('count_200').value = data.count_200 || 0;
                
                // Load asset data
                document.getElementById('rek_bca').value = data.rek_bca || 0;
                document.getElementById('saldo_pulsa').value = data.saldo_pulsa || 0;
                document.getElementById('saldo_dana').value = data.saldo_dana || 0;
                
                // Update total display
                document.getElementById('totalUang').textContent = 'Rp ' + (data.total || 0).toLocaleString('id-ID');
                document.getElementById('jumlahAset').textContent = 'Rp ' + (data.jumlah_aset || 0).toLocaleString('id-ID');
                
                // Simpan data asli untuk undo
                originalUangData = {...data};
                
                // Update info record
                document.getElementById('currentUangRecord').textContent = index + 1;
                document.getElementById('totalUangRecords').textContent = uangData.length;
                
                // Update detail perhitungan
                updateDetailPerhitungan();
            }
        }

        // Fungsi untuk menambahkan event listeners pada input counter
        function addMoneyCounterListeners() {
            const denominations = [100000, 75000, 50000, 20000, 10000, 5000, 2000, 1000, 500, 200];
            
            denominations.forEach(denom => {
                const input = document.getElementById(`count_${denom}`);
                if (input) {
                    input.addEventListener('input', hitungTotal);
                }
            });
        }

        // Fungsi untuk menghitung total uang
        function hitungTotal() {
            const denominations = [
                {value: 100000, id: 'count_100000'},
                {value: 75000, id: 'count_75000'},
                {value: 50000, id: 'count_50000'},
                {value: 20000, id: 'count_20000'},
                {value: 10000, id: 'count_10000'},
                {value: 5000, id: 'count_5000'},
                {value: 2000, id: 'count_2000'},
                {value: 1000, id: 'count_1000'},
                {value: 500, id: 'count_500'},
                {value: 200, id: 'count_200'}
            ];
            
            let total = 0;
            let details = [];
            
            denominations.forEach(denom => {
                const count = parseInt(document.getElementById(denom.id).value) || 0;
                const subtotal = count * denom.value;
                total += subtotal;
                
                if (count > 0) {
                    details.push({
                        denomination: denom.value,
                        count: count,
                        subtotal: subtotal
                    });
                }
            });
            
            // Update total display
            document.getElementById('totalUang').textContent = 'Rp ' + total.toLocaleString('id-ID');
            
            // Update detail perhitungan
            updateDetailPerhitungan(details, total);
            
            return total;
        }

        // Fungsi untuk menghitung total aset
        function itungAset() {
            // Ambil nilai dari setiap input
            const rekBCA = parseInt(document.getElementById('rek_bca').value) || 0;
            const saldoPulsa = parseInt(document.getElementById('saldo_pulsa').value) || 0;
            const saldoDana = parseInt(document.getElementById('saldo_dana').value) || 0;
            
            // Hitung total uang terlebih dahulu
            const totalUang = hitungTotal();
            
            // Hitung total aset
            const totalAset = rekBCA + saldoPulsa + saldoDana + totalUang;
            
            // Update display jumlah aset
            document.getElementById('jumlahAset').textContent = 'Rp ' + totalAset.toLocaleString('id-ID');
            
            // Tampilkan detail perhitungan aset
            const detailAset = `
                <div class="space-y-1">
                    <div class="flex justify-between text-xs">
                        <span>REK BCA:</span>
                        <span class="font-medium">Rp ${rekBCA.toLocaleString('id-ID')}</span>
                    </div>
                    <div class="flex justify-between text-xs">
                        <span>SALDO PULSA:</span>
                        <span class="font-medium">Rp ${saldoPulsa.toLocaleString('id-ID')}</span>
                    </div>
                    <div class="flex justify-between text-xs">
                        <span>SALDO DANA:</span>
                        <span class="font-medium">Rp ${saldoDana.toLocaleString('id-ID')}</span>
                    </div>
                    <div class="flex justify-between text-xs">
                        <span>TOTAL UANG:</span>
                        <span class="font-medium">Rp ${totalUang.toLocaleString('id-ID')}</span>
                    </div>
                    <hr class="my-2 border-gray-300">
                    <div class="flex justify-between font-bold text-blue-600">
                        <span>TOTAL ASET:</span>
                        <span>Rp ${totalAset.toLocaleString('id-ID')}</span>
                    </div>
                </div>
            `;
            
            // Update detail perhitungan dengan info aset
            const detailDiv = document.getElementById('detailPerhitungan');
            detailDiv.innerHTML = detailAset;
            
            // Tampilkan alert dengan ringkasan
            alert(`üíé TOTAL ASET: Rp ${totalAset.toLocaleString('id-ID')}\n\n` +
                  `üìä Rincian:\n` +
                  `‚Ä¢ REK BCA: Rp ${rekBCA.toLocaleString('id-ID')}\n` +
                  `‚Ä¢ SALDO PULSA: Rp ${saldoPulsa.toLocaleString('id-ID')}\n` +
                  `‚Ä¢ SALDO DANA: Rp ${saldoDana.toLocaleString('id-ID')}\n` +
                  `‚Ä¢ TOTAL UANG: Rp ${totalUang.toLocaleString('id-ID')}`);
            
            return totalAset;
        }

        // Fungsi untuk update detail perhitungan
        function updateDetailPerhitungan(details = null, total = 0) {
            const detailDiv = document.getElementById('detailPerhitungan');
            
            if (!details || details.length === 0) {
                detailDiv.innerHTML = '<div class="text-gray-600">Belum ada perhitungan</div>';
                return;
            }
            
            let html = '';
            details.forEach(detail => {
                html += `
                    <div class="flex justify-between items-center">
                        <span>Rp ${detail.denomination.toLocaleString('id-ID')} √ó ${detail.count}</span>
                        <span class="font-medium">Rp ${detail.subtotal.toLocaleString('id-ID')}</span>
                    </div>
                `;
            });
            
            html += `
                <hr class="my-2 border-gray-300">
                <div class="flex justify-between items-center font-bold text-green-600">
                    <span>TOTAL:</span>
                    <span>Rp ${total.toLocaleString('id-ID')}</span>
                </div>
            `;
            
            detailDiv.innerHTML = html;
        }

        // Fungsi navigasi uang
        function firstUangRecord() {
            currentUangRecordIndex = 0;
            loadUangRecord(currentUangRecordIndex);
            refreshUangTable();
        }

        function previousUangRecord() {
            if (currentUangRecordIndex > 0) {
                currentUangRecordIndex--;
                loadUangRecord(currentUangRecordIndex);
                refreshUangTable();
            }
        }

        function nextUangRecord() {
            if (currentUangRecordIndex < uangData.length - 1) {
                currentUangRecordIndex++;
                loadUangRecord(currentUangRecordIndex);
                refreshUangTable();
            }
        }

        function lastUangRecord() {
            currentUangRecordIndex = uangData.length - 1;
            loadUangRecord(currentUangRecordIndex);
            refreshUangTable();
        }

        // Fungsi kontrol data uang
        function undoUangRecord() {
            loadUangRecord(currentUangRecordIndex);
            alert('Data uang dikembalikan ke kondisi semula');
        }

        function saveUangRecord() {
            const total = hitungTotal();
            const rekBCA = parseInt(document.getElementById('rek_bca').value) || 0;
            const saldoPulsa = parseInt(document.getElementById('saldo_pulsa').value) || 0;
            const saldoDana = parseInt(document.getElementById('saldo_dana').value) || 0;
            const jumlahAset = rekBCA + saldoPulsa + saldoDana + total;
            
            const formData = {
                id: parseInt(document.getElementById('uang_id').value),
                tanggal: document.getElementById('tanggal_uang').value,
                count_100000: parseInt(document.getElementById('count_100000').value) || 0,
                count_75000: parseInt(document.getElementById('count_75000').value) || 0,
                count_50000: parseInt(document.getElementById('count_50000').value) || 0,
                count_20000: parseInt(document.getElementById('count_20000').value) || 0,
                count_10000: parseInt(document.getElementById('count_10000').value) || 0,
                count_5000: parseInt(document.getElementById('count_5000').value) || 0,
                count_2000: parseInt(document.getElementById('count_2000').value) || 0,
                count_1000: parseInt(document.getElementById('count_1000').value) || 0,
                count_500: parseInt(document.getElementById('count_500').value) || 0,
                count_200: parseInt(document.getElementById('count_200').value) || 0,
                total: total,
                rek_bca: rekBCA,
                saldo_pulsa: saldoPulsa,
                saldo_dana: saldoDana,
                jumlah_aset: jumlahAset
            };
            
            // Validasi data
            if (!formData.tanggal) {
                alert('Tanggal harus diisi!');
                return;
            }
            
            // Update data array
            uangData[currentUangRecordIndex] = formData;
            refreshUangTable();
            alert(`Data berhasil disimpan!\n\nTotal Uang: Rp ${total.toLocaleString('id-ID')}\nJumlah Aset: Rp ${jumlahAset.toLocaleString('id-ID')}`);
        }

        function refreshUangData() {
            loadUangRecord(currentUangRecordIndex);
            refreshUangTable();
            alert('Data uang berhasil di-refresh');
        }

        function newUangRecord() {
            const newId = uangData.length > 0 ? Math.max(...uangData.map(item => item.id)) + 1 : 1;
            const today = new Date().toISOString().split('T')[0];
            
            const newData = {
                id: newId,
                tanggal: today,
                count_100000: 0, count_75000: 0, count_50000: 0, count_20000: 0, count_10000: 0,
                count_5000: 0, count_2000: 0, count_1000: 0, count_500: 0, count_200: 0,
                total: 0,
                rek_bca: 0,
                saldo_pulsa: 0,
                saldo_dana: 0,
                jumlah_aset: 0
            };
            
            uangData.push(newData);
            currentUangRecordIndex = uangData.length - 1;
            
            // Update filtered data
            filteredUangData = [...uangData];
            
            loadUangRecord(currentUangRecordIndex);
            refreshUangTable();
            
            // Focus pada field pertama
            document.getElementById('count_100000').focus();
            
            alert('Record baru telah dibuat! Silakan isi data dan klik Simpan Data.');
        }

        function deleteUangRecord() {
            if (!uangData || uangData.length === 0) {
                alert('Tidak ada data untuk dihapus!');
                return;
            }
            
            if (currentUangRecordIndex < 0 || currentUangRecordIndex >= uangData.length) {
                alert('Record tidak valid!');
                return;
            }
            
            const currentData = uangData[currentUangRecordIndex];
            const confirmMessage = `Apakah Anda yakin ingin menghapus data:\n\nTanggal: ${currentData.tanggal}\nTotal: Rp ${currentData.total.toLocaleString('id-ID')}?`;
            
            if (confirm(confirmMessage)) {
                const deletedDate = currentData.tanggal;
                const deletedTotal = currentData.total;
                
                uangData.splice(currentUangRecordIndex, 1);
                
                // Update ID urut
                uangData.forEach((item, idx) => {
                    item.id = idx + 1;
                });
                
                // Update filtered data
                filteredUangData = [...uangData];
                
                // Sesuaikan currentUangRecordIndex
                if (uangData.length > 0) {
                    if (currentUangRecordIndex >= uangData.length) {
                        currentUangRecordIndex = uangData.length - 1;
                    }
                    loadUangRecord(currentUangRecordIndex);
                } else {
                    currentUangRecordIndex = 0;
                    // Clear form
                    document.getElementById('uang_id').value = '';
                    document.getElementById('tanggal_uang').value = '';
                    const denominations = [100000, 75000, 50000, 20000, 10000, 5000, 2000, 1000, 500, 200];
                    denominations.forEach(denom => {
                        document.getElementById(`count_${denom}`).value = 0;
                    });
                    document.getElementById('rek_bca').value = 0;
                    document.getElementById('saldo_pulsa').value = 0;
                    document.getElementById('saldo_dana').value = 0;
                    document.getElementById('totalUang').textContent = 'Rp 0';
                    document.getElementById('jumlahAset').textContent = 'Rp 0';
                    document.getElementById('currentUangRecord').textContent = '0';
                    document.getElementById('totalUangRecords').textContent = '0';
                    updateDetailPerhitungan();
                }
                
                refreshUangTable();
                alert(`Data tanggal ${deletedDate} (Rp ${deletedTotal.toLocaleString('id-ID')}) berhasil dihapus!`);
            }
        }

        // Fungsi untuk me-refresh tabel uang
        function refreshUangTable() {
            const tableBody = document.getElementById('uangTableBody');
            const noResultsMessage = document.getElementById('noUangResultsMessage');
            tableBody.innerHTML = '';
            
            // Update counter
            updateUangSearchCounter();
            
            if (filteredUangData.length === 0) {
                // Show no results message
                noResultsMessage.classList.remove('hidden');
                return;
            } else {
                // Hide no results message
                noResultsMessage.classList.add('hidden');
            }
            
            filteredUangData.forEach((data, filteredIndex) => {
                // Find original index in uangData
                const originalIndex = uangData.findIndex(item => item.id === data.id);
                const row = document.createElement('tr');
                row.className = originalIndex === currentUangRecordIndex ? 'bg-green-50' : 'hover:bg-gray-50';
                
                row.innerHTML = `
                    <td class="border border-gray-300 px-3 py-2 font-medium">${data.id}</td>
                    <td class="border border-gray-300 px-3 py-2">${highlightDateSearchTerm(new Date(data.tanggal).toLocaleDateString('id-ID'))}</td>
                    <td class="border border-gray-300 px-3 py-2">
                        <div class="text-xs text-gray-600">Total Uang:</div>
                        <div class="font-semibold text-green-600">Rp ${data.total.toLocaleString('id-ID')}</div>
                        <div class="text-xs text-gray-600 mt-1">Jumlah Aset:</div>
                        <div class="font-bold text-blue-600">Rp ${(data.jumlah_aset || 0).toLocaleString('id-ID')}</div>
                    </td>
                    <td class="border border-gray-300 px-3 py-2 text-center">
                        <button onclick="selectUangRecord(${originalIndex})" class="bg-blue-500 hover:bg-blue-600 text-white px-2 py-1 rounded text-xs transition-colors">
                            Pilih
                        </button>
                        <button onclick="deleteUangRecordFromTable(${originalIndex})" class="bg-red-500 hover:bg-red-600 text-white px-2 py-1 rounded text-xs ml-1 transition-colors">
                            Hapus
                        </button>
                    </td>
                `;
                
                tableBody.appendChild(row);
            });
        }

        // Fungsi untuk memilih record uang dari tabel
        function selectUangRecord(index) {
            currentUangRecordIndex = index;
            loadUangRecord(currentUangRecordIndex);
            refreshUangTable();
        }

        // Fungsi untuk menghapus record uang dari tabel
        function deleteUangRecordFromTable(index) {
            if (confirm('Apakah Anda yakin ingin menghapus data ini?')) {
                const deletedData = uangData[index];
                uangData.splice(index, 1);
                
                // Update ID urut
                uangData.forEach((item, idx) => {
                    item.id = idx + 1;
                });
                
                // Update filtered data
                filteredUangData = [...uangData];
                
                // Adjust current record index
                if (currentUangRecordIndex >= uangData.length) {
                    currentUangRecordIndex = uangData.length - 1;
                }
                if (currentUangRecordIndex < 0) currentUangRecordIndex = 0;
                
                if (uangData.length > 0) {
                    loadUangRecord(currentUangRecordIndex);
                } else {
                    // Clear form if no data left
                    document.getElementById('uang_id').value = '';
                    document.getElementById('tanggal_uang').value = '';
                    const denominations = [100000, 75000, 50000, 20000, 10000, 5000, 2000, 1000, 500, 200];
                    denominations.forEach(denom => {
                        document.getElementById(`count_${denom}`).value = 0;
                    });
                    document.getElementById('rek_bca').value = 0;
                    document.getElementById('saldo_pulsa').value = 0;
                    document.getElementById('saldo_dana').value = 0;
                    document.getElementById('totalUang').textContent = 'Rp 0';
                    document.getElementById('jumlahAset').textContent = 'Rp 0';
                    document.getElementById('currentUangRecord').textContent = '0';
                    document.getElementById('totalUangRecords').textContent = '0';
                    updateDetailPerhitungan();
                }
                
                // Re-apply current search if any
                searchUangByDate();
                alert(`Data tanggal ${deletedData.tanggal} berhasil dihapus!`);
            }
        }

        // Fungsi pencarian uang berdasarkan tanggal
        function searchUangByDate() {
            const searchDate = document.getElementById('searchTanggalUang').value;
            
            if (!searchDate) {
                // Jika pencarian kosong, tampilkan semua data
                filteredUangData = [...uangData];
            } else {
                // Filter data berdasarkan tanggal
                filteredUangData = uangData.filter(item => 
                    item.tanggal === searchDate
                );
            }
            
            refreshUangTable();
        }

        // Fungsi untuk clear search uang
        function clearUangSearch() {
            document.getElementById('searchTanggalUang').value = '';
            filteredUangData = [...uangData];
            refreshUangTable();
            document.getElementById('searchTanggalUang').focus();
        }

        // Fungsi untuk highlight search term pada tanggal
        function highlightDateSearchTerm(dateText) {
            const searchDate = document.getElementById('searchTanggalUang').value;
            if (!searchDate) return dateText;
            
            // Convert search date to Indonesian format for comparison
            const searchDateFormatted = new Date(searchDate).toLocaleDateString('id-ID');
            
            if (dateText === searchDateFormatted) {
                return `<mark class="bg-yellow-200 px-1 rounded">${dateText}</mark>`;
            }
            
            return dateText;
        }

        // Fungsi untuk update counter pencarian uang
        function updateUangSearchCounter() {
            const visibleCount = document.getElementById('visibleUangCount');
            const totalCount = document.getElementById('totalUangCount');
            
            if (visibleCount && totalCount) {
                visibleCount.textContent = filteredUangData.length;
                totalCount.textContent = uangData.length;
            }
        }

        // ===== FUNGSI UKURAN PLASTIK =====
        
        // Sample data untuk ukuran plastik
        let plastikData = [
            {id: 1, nama_ukuran: 'Plastik A4', panjang: 29.7, lebar: 21, harga: 10000},
            {id: 2, nama_ukuran: 'Plastik A5', panjang: 21, lebar: 14.8, harga: 300},
            {id: 3, nama_ukuran: 'Plastik F4', panjang: 33, lebar: 21.5, harga: 750}
        ];
        
        let currentPlastikRecordIndex = 0;
        let originalPlastikData = {};
        let filteredPlastikData = [...plastikData];

        // Fungsi untuk membuka form Input Ukuran Plastik
        function openPlastikSizeInput() {
            document.getElementById('plastikSizeModal').classList.remove('hidden');
            loadPlastikRecord(currentPlastikRecordIndex);
            refreshPlastikTable();
            
            // Reset filtered data dan search box
            filteredPlastikData = [...plastikData];
            document.getElementById('searchPlastik').value = '';
            
            // Add event listeners untuk auto calculate luas
            addPlastikCalculationListeners();
            
            // Add search event listener
            const searchInput = document.getElementById('searchPlastik');
            searchInput.addEventListener('input', searchPlastik);
            searchInput.addEventListener('keyup', function(e) {
                if (e.key === 'Escape') {
                    clearPlastikSearch();
                }
            });
        }

        // Fungsi untuk menutup form Input Ukuran Plastik
        function closePlastikSizeInput() {
            document.getElementById('plastikSizeModal').classList.add('hidden');
        }

        // Fungsi untuk memuat data plastik ke form
        function loadPlastikRecord(index) {
            if (index >= 0 && index < plastikData.length) {
                const data = plastikData[index];
                document.getElementById('plastik_id').value = data.id;
                document.getElementById('nama_ukuran').value = data.nama_ukuran;
                document.getElementById('panjang_plastik').value = data.panjang;
                document.getElementById('lebar_plastik').value = data.lebar;
                document.getElementById('harga_plastik').value = data.harga;
                
                // Simpan data asli untuk undo
                originalPlastikData = {...data};
                
                // Update info record
                document.getElementById('currentPlastikRecord').textContent = index + 1;
                document.getElementById('totalPlastikRecords').textContent = plastikData.length;
            }
        }

        // Fungsi untuk menambahkan event listeners pada input calculation
        function addPlastikCalculationListeners() {
            // No calculation needed for simplified form
        }

        // Fungsi navigasi plastik
        function firstPlastikRecord() {
            currentPlastikRecordIndex = 0;
            loadPlastikRecord(currentPlastikRecordIndex);
            refreshPlastikTable();
        }

        function previousPlastikRecord() {
            if (currentPlastikRecordIndex > 0) {
                currentPlastikRecordIndex--;
                loadPlastikRecord(currentPlastikRecordIndex);
                refreshPlastikTable();
            }
        }

        function nextPlastikRecord() {
            if (currentPlastikRecordIndex < plastikData.length - 1) {
                currentPlastikRecordIndex++;
                loadPlastikRecord(currentPlastikRecordIndex);
                refreshPlastikTable();
            }
        }

        function lastPlastikRecord() {
            currentPlastikRecordIndex = plastikData.length - 1;
            loadPlastikRecord(currentPlastikRecordIndex);
            refreshPlastikTable();
        }

        // Fungsi kontrol data plastik
        function savePlastikRecord() {
            const panjang = parseFloat(document.getElementById('panjang_plastik').value) || 0;
            const lebar = parseFloat(document.getElementById('lebar_plastik').value) || 0;
            
            const formData = {
                id: parseInt(document.getElementById('plastik_id').value),
                nama_ukuran: document.getElementById('nama_ukuran').value,
                panjang: panjang,
                lebar: lebar,
                harga: parseInt(document.getElementById('harga_plastik').value) || 0
            };
            
            // Validasi data
            if (!formData.nama_ukuran || !formData.panjang || !formData.lebar || !formData.harga) {
                alert('Field Nama Ukuran, Panjang, Lebar, dan Harga harus diisi!');
                return;
            }
            
            // Update data array
            plastikData[currentPlastikRecordIndex] = formData;
            
            // Update filtered data
            filteredPlastikData = [...plastikData];
            
            refreshPlastikTable();
            alert(`Data ukuran plastik berhasil disimpan!\n\nNama: ${formData.nama_ukuran}\nUkuran: ${formData.panjang} √ó ${formData.lebar} cm\nHarga: Rp ${formData.harga.toLocaleString('id-ID')}`);
        }

        function newPlastikRecord() {
            const newId = plastikData.length > 0 ? Math.max(...plastikData.map(item => item.id)) + 1 : 1;
            
            const newData = {
                id: newId,
                nama_ukuran: '',
                panjang: 0,
                lebar: 0,
                harga: 0
            };
            
            plastikData.push(newData);
            currentPlastikRecordIndex = plastikData.length - 1;
            
            // Update filtered data
            filteredPlastikData = [...plastikData];
            
            loadPlastikRecord(currentPlastikRecordIndex);
            refreshPlastikTable();
            
            // Focus pada field pertama
            document.getElementById('nama_ukuran').focus();
            
            alert('Record ukuran plastik baru telah dibuat! Silakan isi data dan klik Simpan Data.');
        }

        function deletePlastikRecord() {
            if (!plastikData || plastikData.length === 0) {
                alert('Tidak ada data untuk dihapus!');
                return;
            }
            
            if (currentPlastikRecordIndex < 0 || currentPlastikRecordIndex >= plastikData.length) {
                alert('Record tidak valid!');
                return;
            }
            
            const currentData = plastikData[currentPlastikRecordIndex];
            const confirmMessage = `Apakah Anda yakin ingin menghapus data:\n\nNama: ${currentData.nama_ukuran}\nUkuran: ${currentData.panjang} √ó ${currentData.lebar} cm\nHarga: Rp ${currentData.harga.toLocaleString('id-ID')}?`;
            
            if (confirm(confirmMessage)) {
                const deletedName = currentData.nama_ukuran;
                
                plastikData.splice(currentPlastikRecordIndex, 1);
                
                // Update ID urut
                plastikData.forEach((item, idx) => {
                    item.id = idx + 1;
                });
                
                // Update filtered data
                filteredPlastikData = [...plastikData];
                
                // Sesuaikan currentPlastikRecordIndex
                if (plastikData.length > 0) {
                    if (currentPlastikRecordIndex >= plastikData.length) {
                        currentPlastikRecordIndex = plastikData.length - 1;
                    }
                    loadPlastikRecord(currentPlastikRecordIndex);
                } else {
                    currentPlastikRecordIndex = 0;
                    // Clear form
                    document.getElementById('plastik_id').value = '';
                    document.getElementById('nama_ukuran').value = '';
                    document.getElementById('panjang_plastik').value = 0;
                    document.getElementById('lebar_plastik').value = 0;
                    document.getElementById('harga_plastik').value = 0;
                    document.getElementById('currentPlastikRecord').textContent = '0';
                    document.getElementById('totalPlastikRecords').textContent = '0';
                }
                
                refreshPlastikTable();
                alert(`Data "${deletedName}" berhasil dihapus!`);
            }
        }

        function refreshPlastikData() {
            loadPlastikRecord(currentPlastikRecordIndex);
            refreshPlastikTable();
            alert('Data ukuran plastik berhasil di-refresh');
        }

        // Fungsi untuk me-refresh tabel plastik
        function refreshPlastikTable() {
            const tableBody = document.getElementById('plastikTableBody');
            const noResultsMessage = document.getElementById('noPlastikResultsMessage');
            tableBody.innerHTML = '';
            
            // Update counter
            updatePlastikSearchCounter();
            
            if (filteredPlastikData.length === 0) {
                // Show no results message
                noResultsMessage.classList.remove('hidden');
                return;
            } else {
                // Hide no results message
                noResultsMessage.classList.add('hidden');
            }
            
            filteredPlastikData.forEach((data, filteredIndex) => {
                // Find original index in plastikData
                const originalIndex = plastikData.findIndex(item => item.id === data.id);
                const row = document.createElement('tr');
                row.className = originalIndex === currentPlastikRecordIndex ? 'bg-orange-50' : 'hover:bg-gray-50';
                
                row.innerHTML = `
                    <td class="border border-gray-300 px-2 py-2 font-medium text-xs">${data.id}</td>
                    <td class="border border-gray-300 px-2 py-2 text-xs">${highlightPlastikSearchTerm(data.nama_ukuran)}</td>
                    <td class="border border-gray-300 px-2 py-2 text-xs text-center">${data.panjang} cm</td>
                    <td class="border border-gray-300 px-2 py-2 text-xs text-center">${data.lebar} cm</td>
                    <td class="border border-gray-300 px-2 py-2 text-xs">
                        <div class="font-semibold text-green-600">Rp ${data.harga.toLocaleString('id-ID')}</div>
                    </td>
                    <td class="border border-gray-300 px-2 py-2 text-center">
                        <button onclick="selectPlastikRecord(${originalIndex})" class="bg-blue-500 hover:bg-blue-600 text-white px-2 py-1 rounded text-xs transition-colors">
                            Pilih
                        </button>
                        <button onclick="deletePlastikRecordFromTable(${originalIndex})" class="bg-red-500 hover:bg-red-600 text-white px-2 py-1 rounded text-xs ml-1 transition-colors">
                            Hapus
                        </button>
                    </td>
                `;
                
                tableBody.appendChild(row);
            });
        }

        // Fungsi untuk memilih record plastik dari tabel
        function selectPlastikRecord(index) {
            currentPlastikRecordIndex = index;
            loadPlastikRecord(currentPlastikRecordIndex);
            refreshPlastikTable();
        }

        // Fungsi untuk menghapus record plastik dari tabel
        function deletePlastikRecordFromTable(index) {
            if (confirm('Apakah Anda yakin ingin menghapus data ini?')) {
                const deletedData = plastikData[index];
                plastikData.splice(index, 1);
                
                // Update ID urut
                plastikData.forEach((item, idx) => {
                    item.id = idx + 1;
                });
                
                // Update filtered data
                filteredPlastikData = [...plastikData];
                
                // Adjust current record index
                if (currentPlastikRecordIndex >= plastikData.length) {
                    currentPlastikRecordIndex = plastikData.length - 1;
                }
                if (currentPlastikRecordIndex < 0) currentPlastikRecordIndex = 0;
                
                if (plastikData.length > 0) {
                    loadPlastikRecord(currentPlastikRecordIndex);
                } else {
                    // Clear form if no data left
                    document.getElementById('plastik_id').value = '';
                    document.getElementById('nama_ukuran').value = '';
                    document.getElementById('panjang_plastik').value = 0;
                    document.getElementById('lebar_plastik').value = 0;
                    document.getElementById('harga_plastik').value = 0;
                    document.getElementById('currentPlastikRecord').textContent = '0';
                    document.getElementById('totalPlastikRecords').textContent = '0';
                }
                
                // Re-apply current search if any
                searchPlastik();
                alert(`Data "${deletedData.nama_ukuran}" berhasil dihapus!`);
            }
        }

        // Fungsi pencarian plastik
        function searchPlastik() {
            const searchTerm = document.getElementById('searchPlastik').value.toLowerCase().trim();
            
            if (!searchTerm) {
                // Jika pencarian kosong, tampilkan semua data
                filteredPlastikData = [...plastikData];
            } else {
                // Filter data berdasarkan nama ukuran
                filteredPlastikData = plastikData.filter(item => 
                    item.nama_ukuran.toLowerCase().includes(searchTerm)
                );
            }
            
            refreshPlastikTable();
        }

        // Fungsi untuk clear search plastik
        function clearPlastikSearch() {
            document.getElementById('searchPlastik').value = '';
            filteredPlastikData = [...plastikData];
            refreshPlastikTable();
            document.getElementById('searchPlastik').focus();
        }

        // Fungsi untuk highlight search term pada nama ukuran
        function highlightPlastikSearchTerm(text) {
            const searchTerm = document.getElementById('searchPlastik').value.trim();
            if (!searchTerm) return text;
            
            const regex = new RegExp(`(${searchTerm})`, 'gi');
            return text.replace(regex, '<mark class="bg-yellow-200 px-1 rounded">$1</mark>');
        }

        // Fungsi untuk update counter pencarian plastik
        function updatePlastikSearchCounter() {
            const visibleCount = document.getElementById('visiblePlastikCount');
            const totalCount = document.getElementById('totalPlastikCount');
            
            if (visibleCount && totalCount) {
                visibleCount.textContent = filteredPlastikData.length;
                totalCount.textContent = plastikData.length;
            }
        }

        // ===== FUNGSI TAB SWITCHING BELANGKO =====
        
        // Variable untuk filtered data plastik di belangko
        let filteredPlastikInBelangkoData = [...plastikData];
        
        // Fungsi untuk menampilkan tab Belangko
        function showBelangkoTab() {
            // Hide plastik tab, show belangko tab
            document.getElementById('plastikDataTab').classList.add('hidden');
            document.getElementById('belangkoDataTab').classList.remove('hidden');
            
            // Update tab styling
            document.getElementById('belangkoTab').className = 'px-4 py-2 text-sm font-medium border-b-2 border-blue-500 text-blue-600 bg-blue-50';
            document.getElementById('plastikTab').className = 'px-4 py-2 text-sm font-medium border-b-2 border-transparent text-gray-500 hover:text-gray-700';
        }
        
        // Fungsi untuk menampilkan tab Plastik
        function showPlastikTab() {
            // Hide belangko tab, show plastik tab
            document.getElementById('belangkoDataTab').classList.add('hidden');
            document.getElementById('plastikDataTab').classList.remove('hidden');
            
            // Update tab styling
            document.getElementById('plastikTab').className = 'px-4 py-2 text-sm font-medium border-b-2 border-orange-500 text-orange-600 bg-orange-50';
            document.getElementById('belangkoTab').className = 'px-4 py-2 text-sm font-medium border-b-2 border-transparent text-gray-500 hover:text-gray-700';
            
            // Refresh plastik table when tab is shown
            refreshPlastikInBelangkoTable();
        }
        
        // Fungsi untuk me-refresh tabel plastik di belangko
        function refreshPlastikInBelangkoTable() {
            const tableBody = document.getElementById('plastikInBelangkoTableBody');
            const noResultsMessage = document.getElementById('noPlastikInBelangkoResultsMessage');
            tableBody.innerHTML = '';
            
            // Update counter
            updatePlastikInBelangkoSearchCounter();
            
            if (filteredPlastikInBelangkoData.length === 0) {
                // Show no results message
                noResultsMessage.classList.remove('hidden');
                return;
            } else {
                // Hide no results message
                noResultsMessage.classList.add('hidden');
            }
            
            filteredPlastikInBelangkoData.forEach((data, filteredIndex) => {
                // Find original index in plastikData
                const originalIndex = plastikData.findIndex(item => item.id === data.id);
                const row = document.createElement('tr');
                row.className = 'hover:bg-gray-50';
                
                row.innerHTML = `
                    <td class="border border-gray-300 px-2 py-2 font-medium text-xs">${data.id}</td>
                    <td class="border border-gray-300 px-2 py-2 text-xs">${highlightPlastikInBelangkoSearchTerm(data.nama_ukuran)}</td>
                    <td class="border border-gray-300 px-2 py-2 text-xs text-center">${data.panjang} cm</td>
                    <td class="border border-gray-300 px-2 py-2 text-xs text-center">${data.lebar} cm</td>
                    <td class="border border-gray-300 px-2 py-2 text-xs">
                        <div class="font-semibold text-green-600">Rp ${data.harga.toLocaleString('id-ID')}</div>
                    </td>
                    <td class="border border-gray-300 px-2 py-2 text-center">
                        <button onclick="selectPlastikForBelangko(${originalIndex})" class="bg-green-500 hover:bg-green-600 text-white px-2 py-1 rounded text-xs transition-colors">
                            Pilih
                        </button>
                        <button onclick="viewPlastikDetails(${originalIndex})" class="bg-blue-500 hover:bg-blue-600 text-white px-2 py-1 rounded text-xs ml-1 transition-colors">
                            Detail
                        </button>
                    </td>
                `;
                
                tableBody.appendChild(row);
            });
        }
        
        // Fungsi pencarian plastik di belangko
        function searchPlastikInBelangko() {
            const searchTerm = document.getElementById('searchPlastikInBelangko').value.toLowerCase().trim();
            
            if (!searchTerm) {
                // Jika pencarian kosong, tampilkan semua data
                filteredPlastikInBelangkoData = [...plastikData];
            } else {
                // Filter data berdasarkan nama ukuran
                filteredPlastikInBelangkoData = plastikData.filter(item => 
                    item.nama_ukuran.toLowerCase().includes(searchTerm)
                );
            }
            
            refreshPlastikInBelangkoTable();
        }
        
        // Fungsi untuk clear search plastik di belangko
        function clearPlastikInBelangkoSearch() {
            document.getElementById('searchPlastikInBelangko').value = '';
            filteredPlastikInBelangkoData = [...plastikData];
            refreshPlastikInBelangkoTable();
            document.getElementById('searchPlastikInBelangko').focus();
        }
        
        // Fungsi untuk highlight search term pada nama ukuran di belangko
        function highlightPlastikInBelangkoSearchTerm(text) {
            const searchTerm = document.getElementById('searchPlastikInBelangko').value.trim();
            if (!searchTerm) return text;
            
            const regex = new RegExp(`(${searchTerm})`, 'gi');
            return text.replace(regex, '<mark class="bg-yellow-200 px-1 rounded">$1</mark>');
        }
        
        // Fungsi untuk update counter pencarian plastik di belangko
        function updatePlastikInBelangkoSearchCounter() {
            const visibleCount = document.getElementById('visiblePlastikInBelangkoCount');
            const totalCount = document.getElementById('totalPlastikInBelangkoCount');
            
            if (visibleCount && totalCount) {
                visibleCount.textContent = filteredPlastikInBelangkoData.length;
                totalCount.textContent = plastikData.length;
            }
        }
        
        // Variable untuk menyimpan plastik yang dipilih
        let selectedPlastikForBelangko = null;
        
        // Fungsi untuk memilih plastik untuk belangko
        function selectPlastikForBelangko(index) {
            const selectedPlastik = plastikData[index];
            
            // Langsung simpan plastik yang dipilih tanpa konfirmasi
            selectedPlastikForBelangko = selectedPlastik;
            
            // Show selected plastic display
            showSelectedPlastikDisplay(selectedPlastik);
            
            // Update detail belangko dengan info plastik yang dipilih
            updateDetailBelangkoWithPlastik(selectedPlastik);
            
            // Update detail proses belangko
            const currentBelangko = belangkoData[currentBelangkoRecordIndex];
            updateDetailProsesBelangko(currentBelangko, selectedPlastik);
            
            // Switch back to belangko tab
            showBelangkoTab();
            
            // Show success message
            alert(`‚úÖ Ukuran plastik "${selectedPlastik.nama_ukuran}" telah dipilih!\n\n` +
                  `üìä Data telah masuk ke Detail Data Proses Belangko:\n` +
                  `‚Ä¢ Nama Ukuran: ${selectedPlastik.nama_ukuran}\n` +
                  `‚Ä¢ Harga Plastik: Rp ${selectedPlastik.harga.toLocaleString('id-ID')}\n\n` +
                  `Lihat detail lengkap di menu "Detail Data Proses Belangko" di panel kanan.`);
        }
        
        // Fungsi untuk menampilkan plastik yang dipilih
        function showSelectedPlastikDisplay(plastikData) {
            const displayDiv = document.getElementById('selectedPlastikDisplay');
            const infoDiv = document.getElementById('selectedPlastikInfo');
            
            const luas = (plastikData.panjang * plastikData.lebar).toFixed(2);
            
            const html = `
                <div class="grid grid-cols-2 gap-2 text-xs">
                    <div class="font-medium text-gray-700">Nama:</div>
                    <div class="text-orange-800 font-semibold">${plastikData.nama_ukuran}</div>
                    
                    <div class="font-medium text-gray-700">Panjang:</div>
                    <div class="text-gray-800">${plastikData.panjang} cm</div>
                    
                    <div class="font-medium text-gray-700">Lebar:</div>
                    <div class="text-gray-800">${plastikData.lebar} cm</div>
                    
                    <div class="font-medium text-gray-700">Luas:</div>
                    <div class="text-gray-800">${luas} cm¬≤</div>
                    
                    <div class="font-medium text-gray-700">Harga:</div>
                    <div class="text-green-600 font-bold text-sm">Rp ${plastikData.harga.toLocaleString('id-ID')}</div>
                </div>
            `;
            
            infoDiv.innerHTML = html;
            displayDiv.classList.remove('hidden');
            
            // Update customer pricing display
            updateCustomerPricingDisplay();
        }
        
        // Fungsi untuk menghapus pilihan plastik
        function clearSelectedPlastik() {
            if (confirm('Apakah Anda yakin ingin menghapus pilihan ukuran plastik?')) {
                selectedPlastikForBelangko = null;
                document.getElementById('selectedPlastikDisplay').classList.add('hidden');
                document.getElementById('customerPricingDisplay').classList.add('hidden');
                document.getElementById('priceTawarDisplay').classList.add('hidden');
                
                // Clear harga tawar input
                document.getElementById('harga_tawar').value = '';
                
                // Update detail belangko tanpa plastik
                const currentBelangko = belangkoData[currentBelangkoRecordIndex];
                if (currentBelangko) {
                    updateDetailBelangko(currentBelangko);
                }
                
                // Update detail proses belangko tanpa plastik
                updateDetailProsesBelangko(currentBelangko, null);
                
                alert('‚úÖ Pilihan ukuran plastik telah dihapus.');
            }
        }
        
        // Fungsi untuk update customer pricing display
        function updateCustomerPricingDisplay() {
            const customerPricingDiv = document.getElementById('customerPricingDisplay');
            const customerPricingInfo = document.getElementById('customerPricingInfo');
            const priceTawarDiv = document.getElementById('priceTawarDisplay');
            
            // Check if we have all required data
            const currentBelangko = belangkoData[currentBelangkoRecordIndex];
            const jumlahUndangan = parseInt(document.getElementById('jumlah_undangan').value) || 0;
            const hargaOCValue = parseInt(document.getElementById('harga_oc').value) || 0;
            
            if (!currentBelangko || !selectedPlastikForBelangko || jumlahUndangan <= 0) {
                customerPricingDiv.classList.add('hidden');
                priceTawarDiv.classList.add('hidden');
                return;
            }
            
            // Calculate modal price per pis
            const hargaPlastikPerPis = selectedPlastikForBelangko.harga / 100;
            const hargaModalPerPis = currentBelangko.harga + hargaPlastikPerPis + hargaOCValue;
            
            // Determine multiplier based on quantity
            const multiplier = jumlahUndangan >= 500 ? 2 : 3;
            const hargaJualPerPis = hargaModalPerPis * multiplier;
            
            const html = `
                <div class="bg-red-100 p-6 rounded-lg border-2 border-red-300">
                    <div class="text-center">
                        <div class="text-2xl font-bold text-red-700 mb-3">üí∞ HARGA JUAL PER PIS</div>
                        <div class="text-4xl font-bold text-red-600">Rp ${hargaJualPerPis.toLocaleString('id-ID')}</div>
                    </div>
                </div>
            `;
            
            customerPricingInfo.innerHTML = html;
            customerPricingDiv.classList.remove('hidden');
            
            // Show price negotiation section
            priceTawarDiv.classList.remove('hidden');
            
            // Store values for tawar calculation
            window.currentHargaModal = hargaModalPerPis;
            window.currentHargaJual = hargaJualPerPis;
            window.currentJumlahUndangan = jumlahUndangan;
        }
        
        // Fungsi helper untuk menghitung total harga modal
        function calculateTotalModalPrice() {
            const currentBelangko = belangkoData[currentBelangkoRecordIndex];
            const jumlahUndangan = parseInt(document.getElementById('jumlah_undangan').value) || 0;
            const hargaOCValue = parseInt(document.getElementById('harga_oc').value) || 0;
            
            if (!currentBelangko || !selectedPlastikForBelangko || jumlahUndangan <= 0) {
                return 0;
            }
            
            // Calculate components
            const totalHargaBelangko = currentBelangko.harga * jumlahUndangan;
            const jumlahPlastikDibutuhkan = Math.ceil(jumlahUndangan / 100);
            const totalHargaPlastik = jumlahPlastikDibutuhkan * selectedPlastikForBelangko.harga;
            const totalHargaOC = hargaOCValue * jumlahUndangan;
            
            // Check for master fee (only for OC Mesin Toko - value 50)
            const isOCMesinToko = hargaOCValue === 50;
            const masterFee = isOCMesinToko ? 35000 : 0;
            
            return totalHargaBelangko + totalHargaPlastik + totalHargaOC + masterFee;
        }
        
        // Fungsi untuk melihat detail plastik
        function viewPlastikDetails(index) {
            const plastik = plastikData[index];
            const luas = (plastik.panjang * plastik.lebar).toFixed(2);
            
            alert(`üìè Detail Ukuran Plastik\n\n` +
                  `ID: ${plastik.id}\n` +
                  `Nama: ${plastik.nama_ukuran}\n` +
                  `Panjang: ${plastik.panjang} cm\n` +
                  `Lebar: ${plastik.lebar} cm\n` +
                  `Luas: ${luas} cm¬≤\n` +
                  `Harga: Rp ${plastik.harga.toLocaleString('id-ID')}`);
        }
        
        // Fungsi untuk update detail belangko dengan info plastik
        function updateDetailBelangkoWithPlastik(plastikData) {
            const detailDiv = document.getElementById('detailBelangko');
            const currentBelangko = belangkoData[currentBelangkoRecordIndex];
            
            if (!currentBelangko) {
                detailDiv.innerHTML = '<div class="text-gray-600">Pilih data belangko terlebih dahulu</div>';
                return;
            }
            
            const luas = (plastikData.panjang * plastikData.lebar).toFixed(2);
            const totalHarga = currentBelangko.harga + plastikData.harga;
            
            const html = `
                <div class="space-y-1">
                    <div class="bg-blue-50 p-2 rounded mb-2">
                        <div class="font-medium text-blue-800 text-xs">üìä Data Belangko:</div>
                        <div class="flex justify-between text-xs">
                            <span>Kode:</span>
                            <span class="font-medium">${currentBelangko.kode_belangko}</span>
                        </div>
                        <div class="flex justify-between text-xs">
                            <span>Harga:</span>
                            <span class="font-medium">Rp ${currentBelangko.harga.toLocaleString('id-ID')}</span>
                        </div>
                    </div>
                    
                    <div class="bg-orange-50 p-2 rounded mb-2">
                        <div class="font-medium text-orange-800 text-xs">üìè Ukuran Plastik:</div>
                        <div class="flex justify-between text-xs">
                            <span>Nama:</span>
                            <span class="font-medium">${plastikData.nama_ukuran}</span>
                        </div>
                        <div class="flex justify-between text-xs">
                            <span>Ukuran:</span>
                            <span class="font-medium">${plastikData.panjang} √ó ${plastikData.lebar} cm</span>
                        </div>
                        <div class="flex justify-between text-xs">
                            <span>Luas:</span>
                            <span class="font-medium">${luas} cm¬≤</span>
                        </div>
                        <div class="flex justify-between text-xs">
                            <span>Harga:</span>
                            <span class="font-medium">Rp ${plastikData.harga.toLocaleString('id-ID')}</span>
                        </div>
                    </div>
                    
                    <hr class="my-2 border-gray-300">
                    
                    <div class="bg-green-50 p-2 rounded">
                        <div class="font-medium text-green-800 text-xs">üí∞ Total Estimasi:</div>
                        <div class="flex justify-between font-bold text-green-600">
                            <span>Belangko + Plastik:</span>
                            <span>Rp ${totalHarga.toLocaleString('id-ID')}</span>
                        </div>
                    </div>
                </div>
            `;
            
            detailDiv.innerHTML = html;
        }

        // ===== FUNGSI HARGA PRODUK =====
        
        // Fungsi untuk membuka form Harga Produk
        function openHargaProdukForm() {
            document.getElementById('hargaProdukModal').classList.remove('hidden');
            loadProdukRecord(currentProdukRecordIndex);
            
            // Reset filtered data dan search box
            filteredProdukData = [...produkData];
            document.getElementById('searchProduk').value = '';
            
            refreshProdukTable();
            
            // Add search event listener
            const searchInput = document.getElementById('searchProduk');
            searchInput.addEventListener('input', searchProduk);
            searchInput.addEventListener('keyup', function(e) {
                if (e.key === 'Escape') {
                    clearSearch();
                }
            });
        }

        // Fungsi untuk menutup form Harga Produk
        function closeHargaProdukForm() {
            document.getElementById('hargaProdukModal').classList.add('hidden');
        }

        // Fungsi untuk memuat data produk ke form
        function loadProdukRecord(index) {
            if (index >= 0 && index < produkData.length) {
                const data = produkData[index];
                document.getElementById('produk_no').value = data.no;
                document.getElementById('nama_bahan').value = data.nama_bahan;
                document.getElementById('harga_bahan').value = data.harga;
                document.getElementById('nama_pemesan').value = data.nama_pemesan;
                
                // Simpan data asli untuk undo
                originalProdukData = {...data};
                
                // Update info record
                document.getElementById('currentProdukRecord').textContent = index + 1;
                document.getElementById('totalProdukRecords').textContent = produkData.length;
            }
        }

        // Fungsi navigasi produk
        function firstProdukRecord() {
            currentProdukRecordIndex = 0;
            loadProdukRecord(currentProdukRecordIndex);
        }

        function previousProdukRecord() {
            if (currentProdukRecordIndex > 0) {
                currentProdukRecordIndex--;
                loadProdukRecord(currentProdukRecordIndex);
            }
        }

        function nextProdukRecord() {
            if (currentProdukRecordIndex < produkData.length - 1) {
                currentProdukRecordIndex++;
                loadProdukRecord(currentProdukRecordIndex);
            }
        }

        function lastProdukRecord() {
            currentProdukRecordIndex = produkData.length - 1;
            loadProdukRecord(currentProdukRecordIndex);
        }

        // Fungsi kontrol data produk
        function undoProdukRecord() {
            loadProdukRecord(currentProdukRecordIndex);
            alert('Data produk dikembalikan ke kondisi semula');
        }

        function saveProdukRecord() {
            const formData = {
                no: parseInt(document.getElementById('produk_no').value),
                nama_bahan: document.getElementById('nama_bahan').value,
                harga: parseInt(document.getElementById('harga_bahan').value),
                nama_pemesan: document.getElementById('nama_pemesan').value
            };
            
            // Validasi data
            if (!formData.nama_bahan || !formData.harga || !formData.nama_pemesan) {
                alert('Semua field harus diisi!');
                return;
            }
            
            // Update data array
            produkData[currentProdukRecordIndex] = formData;
            refreshProdukTable();
            alert('Data produk berhasil disimpan!');
        }

        function refreshProdukData() {
            loadProdukRecord(currentProdukRecordIndex);
            refreshProdukTable();
            alert('Data produk berhasil di-refresh');
        }

        function newProdukRecord() {
            const newNo = produkData.length > 0 ? Math.max(...produkData.map(item => item.no)) + 1 : 1;
            
            const newData = {
                no: newNo,
                nama_bahan: '',
                harga: 0,
                nama_pemesan: ''
            };
            
            produkData.push(newData);
            currentProdukRecordIndex = produkData.length - 1;
            
            // Update filtered data
            filteredProdukData = [...produkData];
            
            loadProdukRecord(currentProdukRecordIndex);
            refreshProdukTable();
            
            // Focus pada field pertama yang bisa diedit
            document.getElementById('nama_bahan').focus();
            
            alert('Record produk baru telah dibuat! Silakan isi data dan klik Simpan.');
        }

        function deleteProdukRecord() {
            if (!produkData || produkData.length === 0) {
                alert('Tidak ada data untuk dihapus!');
                return;
            }
            
            if (currentProdukRecordIndex < 0 || currentProdukRecordIndex >= produkData.length) {
                alert('Record tidak valid!');
                return;
            }
            
            const currentData = produkData[currentProdukRecordIndex];
            const confirmMessage = `Apakah Anda yakin ingin menghapus data:\n\n"${currentData.nama_bahan}"\nHarga: Rp ${currentData.harga.toLocaleString('id-ID')}\nPemesan: ${currentData.nama_pemesan}?`;
            
            if (confirm(confirmMessage)) {
                const deletedName = currentData.nama_bahan;
                
                produkData.splice(currentProdukRecordIndex, 1);
                
                // Update nomor urut
                produkData.forEach((item, idx) => {
                    item.no = idx + 1;
                });
                
                // Update filtered data
                filteredProdukData = [...produkData];
                
                // Sesuaikan currentProdukRecordIndex
                if (produkData.length > 0) {
                    if (currentProdukRecordIndex >= produkData.length) {
                        currentProdukRecordIndex = produkData.length - 1;
                    }
                    loadProdukRecord(currentProdukRecordIndex);
                } else {
                    currentProdukRecordIndex = 0;
                    document.getElementById('produk_no').value = '';
                    document.getElementById('nama_bahan').value = '';
                    document.getElementById('harga_bahan').value = '';
                    document.getElementById('nama_pemesan').value = '';
                    document.getElementById('currentProdukRecord').textContent = '0';
                    document.getElementById('totalProdukRecords').textContent = '0';
                }
                
                refreshProdukTable();
                alert(`Data "${deletedName}" berhasil dihapus!\n\nDatabase telah diperbarui.`);
            }
        }

        // Variable untuk menyimpan data yang difilter
        let filteredProdukData = [...produkData];
        let filteredUangData = [...uangData];

        // Fungsi untuk me-refresh tabel produk
        function refreshProdukTable() {
            const tableBody = document.getElementById('produkTableBody');
            const noResultsMessage = document.getElementById('noResultsMessage');
            tableBody.innerHTML = '';
            
            // Update counter
            updateSearchCounter();
            
            if (filteredProdukData.length === 0) {
                // Show no results message
                noResultsMessage.classList.remove('hidden');
                return;
            } else {
                // Hide no results message
                noResultsMessage.classList.add('hidden');
            }
            
            filteredProdukData.forEach((data, filteredIndex) => {
                // Find original index in produkData
                const originalIndex = produkData.findIndex(item => item.no === data.no);
                
                const row = document.createElement('tr');
                row.className = originalIndex === currentProdukRecordIndex ? 'bg-green-50' : 'hover:bg-gray-50';
                
                row.innerHTML = `
                    <td class="border border-gray-300 px-3 py-2 font-medium">${data.no}</td>
                    <td class="border border-gray-300 px-3 py-2">${highlightSearchTerm(data.nama_bahan)}</td>
                    <td class="border border-gray-300 px-3 py-2">Rp ${data.harga.toLocaleString('id-ID')}</td>
                    <td class="border border-gray-300 px-3 py-2 text-center">
                        <button onclick="selectProdukRecord(${originalIndex})" class="bg-blue-500 hover:bg-blue-600 text-white px-2 py-1 rounded text-xs transition-colors">
                            Pilih
                        </button>
                        <button onclick="deleteProdukRecordFromTable(${originalIndex})" class="bg-red-500 hover:bg-red-600 text-white px-2 py-1 rounded text-xs ml-1 transition-colors">
                            Hapus
                        </button>
                    </td>
                `;
                
                tableBody.appendChild(row);
            });
        }

        // Fungsi untuk highlight search term
        function highlightSearchTerm(text) {
            const searchTerm = document.getElementById('searchProduk').value.trim();
            if (!searchTerm) return text;
            
            const regex = new RegExp(`(${searchTerm})`, 'gi');
            return text.replace(regex, '<mark class="bg-yellow-200 px-1 rounded">$1</mark>');
        }

        // Fungsi untuk update counter pencarian
        function updateSearchCounter() {
            const visibleCount = document.getElementById('visibleCount');
            const totalCount = document.getElementById('totalCount');
            
            if (visibleCount && totalCount) {
                visibleCount.textContent = filteredProdukData.length;
                totalCount.textContent = produkData.length;
            }
        }

        // Fungsi pencarian produk
        function searchProduk() {
            const searchTerm = document.getElementById('searchProduk').value.toLowerCase().trim();
            
            if (!searchTerm) {
                // Jika pencarian kosong, tampilkan semua data
                filteredProdukData = [...produkData];
            } else {
                // Filter data berdasarkan nama bahan
                filteredProdukData = produkData.filter(item => 
                    item.nama_bahan.toLowerCase().includes(searchTerm)
                );
            }
            
            refreshProdukTable();
        }

        // Fungsi untuk clear search
        function clearSearch() {
            document.getElementById('searchProduk').value = '';
            filteredProdukData = [...produkData];
            refreshProdukTable();
            document.getElementById('searchProduk').focus();
        }

        // Fungsi untuk memilih record produk dari tabel
        function selectProdukRecord(index) {
            currentProdukRecordIndex = index;
            loadProdukRecord(currentProdukRecordIndex);
            refreshProdukTable();
        }

        // Fungsi untuk menghapus record produk dari tabel
        function deleteProdukRecordFromTable(index) {
            if (confirm('Apakah Anda yakin ingin menghapus data ini?')) {
                const deletedName = produkData[index].nama_bahan;
                produkData.splice(index, 1);
                
                // Update nomor urut
                produkData.forEach((item, idx) => {
                    item.no = idx + 1;
                });
                
                // Update filtered data
                filteredProdukData = [...produkData];
                
                // Adjust current record index
                if (currentProdukRecordIndex >= produkData.length) {
                    currentProdukRecordIndex = produkData.length - 1;
                }
                if (currentProdukRecordIndex < 0) currentProdukRecordIndex = 0;
                
                if (produkData.length > 0) {
                    loadProdukRecord(currentProdukRecordIndex);
                } else {
                    document.getElementById('produk_no').value = '';
                    document.getElementById('nama_bahan').value = '';
                    document.getElementById('harga_bahan').value = '';
                    document.getElementById('nama_pemesan').value = '';
                    document.getElementById('currentProdukRecord').textContent = '0';
                    document.getElementById('totalProdukRecords').textContent = '0';
                }
                
                // Re-apply current search if any
                searchProduk();
                alert(`Data "${deletedName}" berhasil dihapus!`);
            }
        }

        // Fungsi untuk menghitung harga tawar
        function hitungTawar(showAlert = false) {
            const hargaTawar = parseFloat(document.getElementById('harga_tawar').value) || 0;
            
            if (hargaTawar <= 0) {
                // Reset display when no valid input
                document.getElementById('tawarPerPis').textContent = '-';
                document.getElementById('jumlahUndanganTawar').textContent = '-';
                document.getElementById('totalHargaTawar').textContent = '-';
                document.getElementById('modalPerPis').textContent = '-';
                document.getElementById('keuntunganPerPis').textContent = '-';
                document.getElementById('totalKeuntungan').textContent = '-';
                document.getElementById('statusTawar').textContent = '-';
                document.getElementById('statusTawar').className = 'font-bold';
                return;
            }
            
            if (!window.currentHargaModal || !window.currentHargaJual || !window.currentJumlahUndangan) {
                if (showAlert) {
                    alert('Data harga belum lengkap! Pastikan semua data belangko sudah diisi.');
                }
                return;
            }
            
            const hargaModal = window.currentHargaModal;
            const hargaJual = window.currentHargaJual;
            const jumlahUndangan = window.currentJumlahUndangan;
            
            // Calculate total harga tawar
            const totalHargaTawar = hargaTawar * jumlahUndangan;
            
            // Calculate profit per pis
            const keuntunganPerPis = hargaTawar - hargaModal;
            const totalKeuntungan = keuntunganPerPis * jumlahUndangan;
            
            // Determine status
            let status = '';
            let statusColor = '';
            
            if (hargaTawar < hargaModal) {
                status = '‚ùå RUGI';
                statusColor = 'text-red-600';
            } else if (hargaTawar >= hargaModal && hargaTawar < hargaJual) {
                status = '‚ö†Ô∏è UNTUNG TIPIS';
                statusColor = 'text-yellow-600';
            } else if (hargaTawar >= hargaJual) {
                status = '‚úÖ UNTUNG BAGUS';
                statusColor = 'text-green-600';
            }
            
            // Update calculation display
            document.getElementById('tawarPerPis').textContent = `Rp ${hargaTawar.toLocaleString('id-ID')}`;
            document.getElementById('jumlahUndanganTawar').textContent = `${jumlahUndangan.toLocaleString('id-ID')} pis`;
            document.getElementById('totalHargaTawar').textContent = `Rp ${totalHargaTawar.toLocaleString('id-ID')}`;
            document.getElementById('modalPerPis').textContent = `Rp ${hargaModal.toLocaleString('id-ID')}`;
            document.getElementById('keuntunganPerPis').textContent = `Rp ${keuntunganPerPis.toLocaleString('id-ID')}`;
            document.getElementById('totalKeuntungan').textContent = `Rp ${totalKeuntungan.toLocaleString('id-ID')}`;
            
            const statusElement = document.getElementById('statusTawar');
            statusElement.textContent = status;
            statusElement.className = `font-bold ${statusColor}`;
            
            // Show detailed alert only if explicitly requested
            if (showAlert) {
                const profitPercentage = ((keuntunganPerPis / hargaModal) * 100).toFixed(1);
                
                alert(`üí¨ HASIL HITUNG HARGA TAWAR\n\n` +
                      `üßÆ Perhitungan Utama:\n` +
                      `‚Ä¢ Harga Tawar: Rp ${hargaTawar.toLocaleString('id-ID')} per pis\n` +
                      `‚Ä¢ Jumlah Undangan: ${jumlahUndangan.toLocaleString('id-ID')} pis\n` +
                      `‚Ä¢ TOTAL HARGA TAWAR: Rp ${totalHargaTawar.toLocaleString('id-ID')}\n\n` +
                      `üí∞ Analisis Modal:\n` +
                      `‚Ä¢ Harga Modal: Rp ${hargaModal.toLocaleString('id-ID')} per pis\n` +
                      `‚Ä¢ TOTAL HARGA MODAL: Rp ${totalHargaModal.toLocaleString('id-ID')}\n\n` +
                      `üíé LABA (TOTAL TAWAR - TOTAL MODAL):\n` +
                      `‚Ä¢ TOTAL LABA: Rp ${totalLaba.toLocaleString('id-ID')}\n` +
                      `‚Ä¢ Keuntungan per pis: Rp ${keuntunganPerPis.toLocaleString('id-ID')} (${profitPercentage}%)\n\n` +
                      `üìà Status: ${status.replace(/[‚ùå‚ö†Ô∏è‚úÖ]/g, '').trim()}`);
            }
        }

        // Close modal when clicking outside
        document.getElementById('hargaKertasModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeHargaKertasForm();
            }
        });

        document.getElementById('notaModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeNotaForm();
            }
        });

        // Close modal produk when clicking outside
        document.addEventListener('DOMContentLoaded', function() {
            const produkModal = document.getElementById('hargaProdukModal');
            if (produkModal) {
                produkModal.addEventListener('click', function(e) {
                    if (e.target === this) {
                        closeHargaProdukForm();
                    }
                });
            }
            
            // Close modal itung uang when clicking outside
            const uangModal = document.getElementById('itungUangModal');
            if (uangModal) {
                uangModal.addEventListener('click', function(e) {
                    if (e.target === this) {
                        closeItungUangForm();
                    }
                });
            }
            
            // Close modal beli when clicking outside
            const beliModal = document.getElementById('beliModal');
            if (beliModal) {
                beliModal.addEventListener('click', function(e) {
                    if (e.target === this) {
                        closeBeliForm();
                    }
                });
            }
            
            // Close modal belangko when clicking outside
            const belangkoModal = document.getElementById('belangkoModal');
            if (belangkoModal) {
                belangkoModal.addEventListener('click', function(e) {
                    if (e.target === this) {
                        closeBelangkoForm();
                    }
                });
            }
            
            // Close modal plastik when clicking outside
            const plastikModal = document.getElementById('plastikSizeModal');
            if (plastikModal) {
                plastikModal.addEventListener('click', function(e) {
                    if (e.target === this) {
                        closePlastikSizeInput();
                    }
                });
            }
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'96f28069909f9caa',t:'MTc1NTE5NTk5OC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
